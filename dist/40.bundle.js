(function(){(this||window).webpackJsonp.registerAbsMids({"esri/views/3d/layers/SceneLayerWorker":1242,"esri/views/3d/layers/PointCloudWorker":1246,"esri/views/vectorTiles/WorkerTileHandler":1256,"esri/views/2d/layers/features/Pipeline":1257,"esri/layers/graphics/sources/support/CSVSourceWorker":1258,"esri/views/webgl/Util":1269,"esri/views/2d/tiling/enums":1313,"esri/views/3d/layers/i3s/I3SBinaryReader":1342,"esri/views/3d/support/orientedBoundingBox":1344,"esri/views/2d/support/Evented":1346,"esri/views/2d/tiling/TileStrategy":1432,"esri/views/3d/layers/i3s/LEPCC":1433,"esri/views/2d/engine/webgl/Geometry":1448,"esri/views/2d/engine/webgl/GeometryUtils":1449,"esri/views/3d/support/dito":1451,"esri/renderers/PointCloudRenderer":1473,"esri/views/2d/engine/webgl/Rect":1483,"esri/renderers/support/pointCloud/PointSizeAlgorithm":1501,"esri/views/3d/layers/i3s/I3SGeometryUtil":1503,"esri/views/3d/layers/i3s/I3SProjectionUtil":1504,"esri/views/2d/engine/webgl/TextShaping":1516,"esri/views/2d/engine/webgl/TileClipper":1517,"esri/renderers/PointCloudClassBreaksRenderer":1526,"esri/renderers/support/pointCloud/PointSizeFixedSizeAlgorithm":1527,"esri/renderers/support/pointCloud/PointSizeSplatAlgorithm":1528,"esri/renderers/PointCloudStretchRenderer":1529,"esri/renderers/PointCloudUniqueValueRenderer":1530,"esri/views/vectorTiles/style/StyleLayer":1531,"esri/views/vectorTiles/Bucket":1536,"esri/views/vectorTiles/MemoryBuffer":1605,"esri/views/2d/engine/webgl/LineTess":1606,"esri/views/3d/layers/i3s/PointCloudRendererUtil":1607,"esri/renderers/support/pointCloud/ColorModulation":1617,"esri/renderers/support/pointCloud/pointSizeAlgorithmJSONUtils":1618,"esri/renderers/support/pointCloud/pointSizeAlgorithmTypeUtils":1619,"esri/renderers/support/pointCloud/ColorClassBreakInfo":1620,"esri/renderers/support/pointCloud/StopInfo":1621,"esri/renderers/support/pointCloud/ColorUniqueValueInfo":1622,"esri/views/vectorTiles/style/StyleRepository":1624,"esri/views/vectorTiles/style/Filter":1625,"esri/views/vectorTiles/style/StyleDefinition":1626,"esri/views/vectorTiles/style/StyleProperty":1627,"esri/views/2d/layers/features/controllers":1634,"esri/views/vectorTiles/FillBucket":1731,"esri/core/executeAsync":1732,"esri/views/vectorTiles/BackgroundBucket":1733,"esri/views/vectorTiles/CircleBucket":1734,"esri/views/vectorTiles/LineBucket":1735,"esri/views/vectorTiles/Placement":1736,"esri/views/vectorTiles/SymbolBucket":1737,"esri/views/vectorTiles/WorkerTile":2067,"esri/views/vectorTiles/IndexMemoryBuffer":2068,"esri/views/vectorTiles/Conflict":2069,"esri/views/vectorTiles/TileParser":2070,"esri/views/vectorTiles/Feature":2071,"esri/views/vectorTiles/SourceLayerData":2072,"esri/views/vectorTiles/VertexMemoryBuffer":2073,"esri/views/2d/layers/features/processors":2074,"esri/views/2d/layers/features/support/TileStore":2075,"dstore/Csv":2078})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{1242:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(8),r(21),r(1503),r(1504),r(47),r(1475),r(1344),r(106),r(1414),r(1267)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c,f){var d=function(){function e(){}return e.prototype.process=function(e){var t=[e.geometryBuffer];return r.resolve({result:this.transform(e,t),transferList:t})},e.prototype.transform=function(e,t){var r=i.fromJSON(e.indexSR),d=i.fromJSON(e.vertexSR),p=i.fromJSON(e.renderSR),v=!1,y=0,m=[],x=e.obb?null:l.create([0,0,0],[-1,-1,-1],[0,0,0,1]);a.vec3d.set(e.center,h),h[2]+=e.elevationOffset;var g=a.mat4d.create();u.computeLinearTransformation(r,h,g,p);for(var b=0,_=e.geometryData;b<_.length;b++)for(var I=_[b],w=I.geometries,C=I.componentOffsets,D=0,T=w;D<T.length;D++){var P=T[D],S=e.layouts[y];++y;var M=[{name:f.VertexAttrConstants.COLOR,byteValue:255}],B=[f.VertexAttrConstants.NORMAL,f.VertexAttrConstants.NORMALCOMPRESSED,f.VertexAttrConstants.SYMBOLCOLOR,f.VertexAttrConstants.COMPONENTINDEX],V=n.interleaveGeometryBuffer(P,e.geometryBuffer,S,M,B),A=new c(new Float32Array(V),S),E=A.getAttribute(f.VertexAttrConstants.POSITION),z=o.reprojectPoints(E,e.center,e.elevationOffset,r,d,p);if(x&&this._updateObb(x,E,g),e.needNormals){var O={normals:A.getAttribute(f.VertexAttrConstants.NORMALCOMPRESSED),positions:E,normalInd:A.getIndices(f.VertexAttrConstants.NORMALCOMPRESSED),positionInd:A.getIndices(f.VertexAttrConstants.POSITION)};n.processAndInterleaveNormals(e.normalReferenceFrame,P,e.geometryBuffer,z.globalTrafo,O)}var L=A.getAttribute(f.VertexAttrConstants.COMPONENTINDEX);L&&this._createComponentNumbers(L,C);var N=A.getAttribute(f.VertexAttrConstants.COLOR);N&&!v&&(v=this._hasColors(N));var j=S[0].stride,k=1-.8*j/(j+4),F=s.deduplicate(V,j/4,k);if(null!=F){var R=F.uniqueCount<65536?new Uint16Array(F.indices):F.indices,U=n.extractPositionData(F.buffer,S,R);m.push({layout:S,interleavedVertexData:F.buffer,indices:R,corMatrices:z,hasColors:v,positionData:U}),t&&(t.push(F.buffer),t.push(R.buffer),t.push(U.data.buffer),t.push(U.indices.buffer))}else{U=n.extractPositionData(V,S);m.push({layout:S,interleavedVertexData:V,corMatrices:z,hasColors:v,positionData:U}),t&&(t.push(V),t.push(U.data.buffer),t.push(U.indices.buffer))}}return x&&(a.mat4d.multiplyVec3(g,x.center,x.center),u.vectorToVector(x.center,p,x.center,d),x.center[2]-=e.elevationOffset),{geometryBuffer:e.geometryBuffer,transformedGeometries:m,obb:x}},e.prototype._hasColors=function(e){for(var t=e.data,r=e.size,i=e.offsetIdx,n=e.strideIdx,o=i;o<t.length;o+=n)for(var a=0;a<r;a++)if(255!==t[o+a])return!0;return!1},e.prototype._createComponentNumbers=function(e,t){for(var r=e.data,i=e.offsetIdx,n=e.strideIdx,o=r.length/n,a=0,s=i,l=0;l<o;l++)l>=t[a+1]&&a++,r[s]=a,s+=n},e.prototype._updateObb=function(e,t,r){if(e.halfSize[0]>0){a.vec3.subtract(e.center,e.halfSize,h),a.vec3.add(e.center,e.halfSize,p);for(var i=t.offsetIdx;i<t.data.length;i+=t.strideIdx)h[0]=Math.min(h[0],t.data[i]),h[1]=Math.min(h[1],t.data[i+1]),h[2]=Math.min(h[2],t.data[i+2]),p[0]=Math.max(p[0],t.data[i]),p[1]=Math.max(p[1],t.data[i+1]),p[2]=Math.max(p[2],t.data[i+2]);a.vec3.subtract(p,h,e.halfSize),a.vec3d.scale(e.halfSize,.5),a.vec3d.add(h,p,e.center),a.vec3d.scale(e.center,.5)}else{l.compute(t,e);var n=2*Math.sqrt(1+r[0]+r[5]+r[10]);v[0]=(r[9]-r[6])/n,v[1]=(r[2]-r[8])/n,v[2]=(r[4]-r[1])/n,v[3]=.25*n,a.quat4.conjugate(v),a.quat4.multiply(v,e.quaternion,e.quaternion)}},e}(),h=a.vec3d.create(),p=a.vec3d.create(),v=a.quat4.create();return d}.apply(null,i))||(e.exports=n)},1246:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(8),r(21),r(1342),r(1433),r(1607),r(47),r(106)],void 0===(n=function(e,t,r,i,n,o,a,s,l){var u=function(){function e(){}return e.prototype.process=function(e){var t=this.transform(e);return r.resolve({result:t,transferList:[t.rgb]})},e.prototype.transform=function(e){var t=this.readGeometry(e.schema,e.geometryBuffer),r=a.evaluateRenderer(e.rendererInfo,e.primaryAttribute,e.modulationAttribute,t,t.length/3);this._applyElevationOffsetInPlace(t,e.elevationOffset);var n=this._transformCoordinates(t,e.obb,i.fromJSON(e.inSR),i.fromJSON(e.outSR));return{obb:e.obb,points:n,rgb:r.buffer}},e.prototype.readGeometry=function(e,t){if(null==e.encoding||""===e.encoding){for(var r=n.createGeometryDataIndex(t,e,!1),i=n.createTypedView(t,r.vertexAttributes.position),a=r.header.fields,s=[a.offsetX,a.offsetY,a.offsetZ],l=[a.scaleX,a.scaleY,a.scaleZ],u=i.length/3,c=new Float64Array(3*u),f=0;f<u;f++)c[3*f]=i[3*f]*l[0]+s[0],c[3*f+1]=i[3*f+1]*l[1]+s[1],c[3*f+2]=i[3*f+2]*l[2]+s[2];return c}if("lepcc-xyz"===e.encoding)return o.decodeXYZ(t).result},e.prototype._transformCoordinates=function(e,t,r,i){var n=e.length/3;if(!l.bufferToBuffer(e,r,0,e,i,0,n))throw Error("Can't reproject");var o=s.vec3.createFrom(t.center[0],t.center[1],t.center[2]),a=s.vec3.create(),u=s.vec3.create();s.quat4.conjugate(t.quaternion,c);for(var f=new Float32Array(3*n),d=0;d<n;d++)a[0]=e[3*d]-o[0],a[1]=e[3*d+1]-o[1],a[2]=e[3*d+2]-o[2],s.quat4.multiplyVec3(c,a,u),t.halfSize[0]=Math.max(t.halfSize[0],Math.abs(u[0])),t.halfSize[1]=Math.max(t.halfSize[1],Math.abs(u[1])),t.halfSize[2]=Math.max(t.halfSize[2],Math.abs(u[2])),f[3*d]=a[0],f[3*d+1]=a[1],f[3*d+2]=a[2];return f},e.prototype._applyElevationOffsetInPlace=function(e,t){var r=e.length/3;if(0!==t)for(var i=0;i<r;i++)e[3*i+2]+=t},e}(),c=s.quat4.create();return u}.apply(null,i))||(e.exports=n)},1256:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(25),r(8),r(1313),r(2067),r(1624)],void 0===(n=function(e,t,r,i,n,o,a){return function(){function e(){this._tiles=new Map,this._spriteInfo={},this._glyphInfo={}}return e.prototype.reset=function(){var e=new r;this._spriteInfo={},this._glyphInfo={};var t=this._tiles;return t.forEach(function(e){return e.setObsolete()}),t.clear(),e.resolve(),e.promise},e.prototype.getLayers=function(){return this._layers},e.prototype.setLayers=function(e){var t=new a(e);return this._layers=t.layers,i.resolve({data:""})},e.prototype.getTile=function(e,t){var r=this,a=e.key,s=o.pool.acquire();s.initialize(e.key,e.refKey,this,e.rotation);var l=e.cacheTile;return t.invoke("fetchTileData",e.refKey).then(function(e){return s.setDataAndParse(e,t).then(function(e){return l&&s.status!==n.TileStatus.INVALID&&r._tiles.set(a,s),e}).catch(function(e){return s.setObsolete(),o.pool.release(s),r._tiles.delete(s.tileKey),i.reject(e)})}).catch(function(e){return s.setObsolete(),r._tiles.has(s.tileKey)&&r._tiles.delete(s.tileKey),i.reject(e)}).always(function(e){return l||o.pool.release(s),e})},e.prototype.update=function(e){var t=this._tiles.get(e.key);return t?t.updateSymbols(e.rotation):i.reject()},e.prototype.destructTileData=function(e){return this._tiles.has(e)&&(o.pool.release(this._tiles.get(e)),this._tiles.delete(e)),i.resolve()},e.prototype.fetchSprites=function(e,t){var r=[],n=this._spriteInfo;return e.forEach(function(e){void 0===n[e]&&r.push(e)}),0===r.length?i.resolve():t.invoke("getSprites",r).then(function(e){for(var t in e){var r=e[t];n[t]=r}})},e.prototype.getSpriteItems=function(){return this._spriteInfo},e.prototype.fetchGlyphs=function(e,t,r,n){var o=[],a=this._glyphInfo[t];return a?r.forEach(function(e){a[e]||o.push(e)}):(a=this._glyphInfo[t]=[],r.forEach(function(e){return o.push(e)})),0===o.length?i.resolve():n.invoke("getGlyphs",{tileID:e,font:t,codePoints:o}).then(function(e){for(var t in e)a[t]=e[t]})},e.prototype.getGlyphItems=function(e){return this._glyphInfo[e]},e}()}.apply(null,i))||(e.exports=n)},1257:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(4),r(8),r(0),r(455),r(462),r(1634),r(2074),r(2075)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c,f){Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controller=null,t.processor=null,t.remoteClient=null,t.serviceAndViewInfo=null,t.tileStore=null,t.viewState=null,t}return r(t,e),t.prototype.initialize=function(){var e=this;this.watch("updating",function(t){e.remoteClient.invoke("setUpdating",t)})},t.prototype.destroy=function(){this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){var e=this.controller,t=this.processor;return!e||!t||e.updating||t.updating||!1},enumerable:!0,configurable:!0}),t.prototype.startup=function(e){var t=s.fromJSON(e.tileInfo);this.serviceAndViewInfo=e,this.tileStore=new f.default(t)},t.prototype.configure=function(e){var t=this,r=this.controller,i=this.processor,n=e.controller,a=e.processor,s=[null,null];return n&&(s[0]=u.createController(n.type,{remoteClient:this.remoteClient,tileStore:this.tileStore,serviceAndViewInfo:this.serviceAndViewInfo})),a&&(s[1]=c.createProcessor(a.type,{remoteClient:this.remoteClient,tileStore:this.tileStore,serviceAndViewInfo:this.serviceAndViewInfo})),o.all(s).then(function(e){var o=e[0],s=e[1];o&&(r&&r===t.controller&&r.destroy(),t.controller=o,o.configuration=n,o.setViewState(t.viewState),s||(o.processor=t.processor)),s&&(i&&i===t.processor&&i.destroy(),t.processor=s,s.configuration=a,r.processor=s)})},t.prototype.setViewState=function(e){var t=l.fromJSON(e);this._set("viewState",t),this.tileStore.setViewState(t),this.controller&&this.controller.setViewState(t)},i([a.property()],t.prototype,"controller",void 0),i([a.property()],t.prototype,"processor",void 0),i([a.property({dependsOn:["controller.updating","processor.updating"]})],t.prototype,"updating",null),i([a.property()],t.prototype,"viewState",void 0),i([a.subclass()],t)}(a.declared(n));t.default=d}.apply(null,i))||(e.exports=n)},1258:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1293),r(1450),r(10),r(118),r(2078),r(29),r(27),r(9),r(8),r(22),r(1636),r(55),r(26),r(483),r(1740),r(54)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c,f,d,h,p,v,y,m){Object.defineProperty(t,"__esModule",{value:!0});var x=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"],g=["lat","latitude","y","ycenter","latitude83","latdecdeg","POINT-Y"],b=["lon","lng","long","longitude","x","xcenter","longitude83","longdecdeg","POINT-X"],_=[","," ",";","|","\t"],I=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,w=[0,0],C=function(){return function(e,t){this.x=e,this.y=t}}(),D=function(){var e=o._parseInfo(),t=new RegExp("^"+e.regexp+"$"),r=new RegExp("["+e.group+"\\s\\xa0]","g"),i=e.factor;return function(n){var o=t.exec(n);if(e.factor=i,!o)return NaN;var a=o[1];if(!o[1]){if(!o[2])return NaN;a=o[2],e.factor*=-1}return+(a=a.replace(r,"").replace(e.decimal,"."))*e.factor}}(),T=function(){function e(){this._store=null}return e.prototype.load=function(e){var t=this;return c.all([this._fetch(e.url),this._checkProjection(e)]).then(function(r){var i=r[0],n=t._parse(i,e.parsing);return t._store=t._createStore(i,n),t._store.executeQueryForExtent().then(function(e){return n.layerDefinition.extent=e.extent,n})})},e.prototype.queryFeatures=function(e){return this._store.executeQuery(m.fromJSON(e))},e.prototype.queryFeatureCount=function(e){return this._store.executeQueryForCount(m.fromJSON(e))},e.prototype.queryObjectIds=function(e){return this._store.executeQueryForIds(m.fromJSON(e))},e.prototype.queryExtent=function(e){return this._store.executeQueryForExtent(m.fromJSON(e))},e.prototype._fetch=function(e){if(!e)return c.reject(new u("csv-source:invalid-source","url not defined"));var t=f.urlToObject(e);return l(t.path,{query:t.query,responseType:"text"}).then(function(e){return e.data})},e.prototype._parse=function(e,t){var r={columnDelimiter:t.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}},i=this._readFirstLine(e);if(!i)throw new u("csv","CSV is empty");if(!t.columnDelimiter){var n=this._inferDelimiter(i);if(!n)throw new u("csv","Unable to detect the delimiter from CSV");r.columnDelimiter=n}var o=i.split(r.columnDelimiter),a=r.layerDefinition={name:"csv",geometryType:"esriGeometryPoint",objectIdField:null,fields:[],extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:102100}}};if(!t.latitudeField||!t.longitudeField){var s=this._inferLocationInfo(o);if(!t.longitudeField&&!s.longitudeFieldName||!t.latitudeField&&!s.latitudeFieldName)throw new u("csv","Unable to identify latitudeField and/or longitudeField from CSV");r.locationInfo={longitudeFieldName:t.longitudeField||s.longitudeFieldName,latitudeFieldName:t.latitudeField||s.latitudeFieldName}}return t.fields&&t.fields.length?a.fields=t.fields:a.fields=this._inferFields(e,r.columnDelimiter,o,r.locationInfo),a.fields.some(function(e){return"esriFieldTypeOID"===e.type&&(a.objectIdField=e.name,!0)})||(a.objectIdField="__OBJECTID",a.fields.unshift({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",domain:null})),r},e.prototype._inferLocationInfo=function(e){var t=null,r=null;return e.forEach(function(e){var i=e.toLowerCase();-1===g.indexOf(i)||r||(r=e),-1===b.indexOf(i)||t||(t=e)}),{longitudeFieldName:t,latitudeFieldName:r}},e.prototype._inferFields=function(e,t,r,i){for(var n=[],o=this._sampleLines(e).map(function(e){return e.split(t).map(function(e){return e.trim()})}),a=this,s=0;s<r.length;s++)!function(e){var t=r[e];if(t===i.longitudeFieldName||t===i.latitudeFieldName)n.push({name:t,alias:t,type:"esriFieldTypeDouble",domain:null});else{var s=o.map(function(t){return t[e]}),l=a._inferFieldType(s),u={name:t.replace(/[\s\'’‘\.\-\/\(\)]+/g,"_"),type:null,alias:t,domain:null,editable:!0,nullable:!0};switch(l){case"integer":u.type="esriFieldTypeInteger";break;case"double":u.type="esriFieldTypeDouble";break;case"date":u.type="esriFieldTypeDate",u.length=36;break;default:u.type="esriFieldTypeString",u.length=255}n.push(u)}}(s);return n},e.prototype._inferFieldType=function(e){var t=this,r=/[^+-.,0-9]/;return e.map(function(e){var i=!1;if(""===e||r.test(e))i=!0;else{var n=D(e);if(!isNaN(n))return/[.,]/.test(e)?"double":n>214783647||n<-214783648?"double":"integer";if(-1===e.indexOf("E"))i=!0;else{if(n=Number(e),!isNaN(n))return"double";if(-1===e.indexOf(","))i=!0;else{if(e=e.replace(",","."),n=Number(e),!isNaN(n))return"double";i=!0}}}if(i){if(/^[-]?\d*[.,]?\d*$/.test(e))return"string";var o=new Date(e);return t._isValidDate(o,e)?"date":"string"}return"string"}).reduce(function(e,t){return e===t?t:"string"===e||"string"===t?"string":"double"===e||"double"===t?"double":void 0})},e.prototype._isValidDate=function(e,t){if(!e||"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;var r=!0;if(n("chrome")&&/\d+\W*$/.test(t)){var i=t.match(/[a-zA-Z]{2,}/);if(i){for(var o=!1,a=0;!o&&a<=i.length;)o=!I.test(i[a]),a++;r=!o}}return r},e.prototype._readFirstLine=function(e){return e.substring(0,e.indexOf("\n")).trim()},e.prototype._sampleLines=function(e,t){void 0===t&&(t=10);for(var r=!1,i=[],n=e.indexOf("\n")+1;!r&&i.length<t;){var o=e.indexOf("\n",n);-1===o&&(r=!0);var a;(a=-1===o&&n<e.length-1?e.substring(n).trim():e.substring(n,o).trim())&&i.push(a),n=o+1}return i},e.prototype._inferDelimiter=function(e){var t=0,r="";return _.forEach(function(i){var n=e.split(i).length;n>t&&(t=n,r=i)}),""===r?null:r},e.prototype._createStore=function(e,t){for(var r,n=t.locationInfo,o=n.latitudeFieldName,l=n.longitudeFieldName,u=t.layerDefinition,c=u.objectIdField,f=u.fields,m=u.extent,g=[],b=[],_=new i.Set,I=new i.Set,T=[],P=0,S=f;P<S.length;P++){var M=S[P],B=M.name,V=M.type;"esriFieldTypeDate"===V?_.add(B):x.indexOf(V)>-1&&I.add(B),B!==c&&T.push(B)}var A=new a;A.delimiter=t.columnDelimiter,A.fieldNames=T,A.newline="\n";var E=A.parse(e),z=0;E.shift();for(var O=0,L=E;O<L.length;O++){var N=L[O],j=this._parseCoordinateValue(N[o]),k=this._parseCoordinateValue(N[l]);if(null!=k&&null!=j&&!isNaN(j)&&!isNaN(k)){for(var F in N)if(F!==o&&F!==l)if(_.has(F)){var R=new Date(N[F]);N[F]=this._isValidDate(R,N[F])?R.getTime():null}else if(I.has(F)){var U=D(N[F]);isNaN(U)?N[F]=null:N[F]=U}N[c]=z,z++,g.push(new C(k,j)),b.push(N)}}if(!h.equals({wkid:4326},m.spatialReference))if(h.isWebMercator(m.spatialReference))for(var Y=0,q=g;Y<q.length;Y++){var G=q[Y];r=p.lngLatToXY(G.x,G.y,w),G.x=r[0],G.y=r[1]}else g=d.projectMany(g,s.SpatialReference.WGS84,m.spatialReference,null,!0);for(var J=new y.default({fields:t.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,objectIdField:c,spatialReference:m.spatialReference||{wkid:4326},cacheSpatialQueries:!0}),X=[],Z=0;Z<g.length;Z++){var W=g[Z],H=W.x,K=W.y,Q=b[Z];Q[c]=Z+1,X.push(new v.OptimizedFeature(new v.OptimizedGeometry([],[H,K]),Q))}return J.load(X),J},e.prototype._parseCoordinateValue=function(e){if(null==e||""===e)return null;var t=D(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t},e.prototype._checkProjection=function(e){var t=e.parsing.spatialReference;return!t||p.canProject(s.SpatialReference.WGS84,t)?c.resolve():d.isSupported()?d.load():c.reject(new u("csv-layer","Projection not supported"))},e}();t.default=T}.apply(null,i))||(e.exports=n)},1269:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(9)],void 0===(n=function(e,t,r,i){return function(){function e(){}return e.vertexCount=function(t,r){return t.vertexBuffers[r].size/e.getStride(t.layout[r])},e.getStride=function(e){return e[0].stride},e.getBytesPerElement=function(e){switch(e){case 5126:case 5124:case 5125:return 4;case 5122:case 5123:return 2;case 5120:case 5121:return 1;default:throw new Error("Unknown data type")}},e.addDescriptor=function(t,r,i,n,o,a){var s=e.getBytesPerElement(n);if(t.length>0){var l=t[0].stride,u=l+s*i;t.forEach(function(e){return e.stride=u}),t.push({name:r,count:i,type:n,offset:l,stride:u,normalized:o,divisor:a})}else t.push({name:r,count:i,type:n,offset:0,stride:s*i,normalized:o,divisor:a})},e.assertCompatibleVertexAttributeLocations=function(e,t){var r=e.locations===t.locations;return r||console.error("VertexAttributeLocations are incompatible"),r},e.hasAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return!0;return!1},e.findAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return e[r];return null},e.copyFramebufferToTexture=function(e,t,r,i,n){void 0===n&&(n=0);var o=e.getBoundFramebufferObject(),a=e.getBoundTexture(0);e.bindFramebuffer(t),e.bindTexture(r,0),e.gl.copyTexImage2D(e.gl.TEXTURE_2D,n,r.descriptor.pixelFormat,i[0],i[1],i[2],i[3],0),e.gl.flush(),e.bindFramebuffer(o),e.bindTexture(a,0)},e.assert=function(e,t){if(!e)throw new i(t)},e.setBaseInstanceOffset=function(e,t){var i={};for(var n in e)i[n]=e[n].map(function(e){return e.divisor?r({},e,{baseInstance:t}):e});return i},e.bindVertexBufferLayout=function(e,t,r,i,n){var o=e.gl,a=e.capabilities.instancing;e.bindBuffer(r),i.forEach(function(e){var r=t[e.name],i=(n||(0+e.baseInstance?e.baseInstance:0))*e.stride;if(void 0===r&&console.error("There is no location for vertex attribute '"+e.name+"' defined."),e.baseInstance&&!e.divisor&&console.error("Vertex attribute '"+e.name+"' uses baseInstanceOffset without divisor."),e.count<=4)o.vertexAttribPointer(r,e.count,e.type,e.normalized,e.stride,e.offset+i),o.enableVertexAttribArray(r),e.divisor&&e.divisor>0&&a&&a.vertexAttribDivisor(r,e.divisor);else if(9===e.count)for(var s=0;s<3;s++)o.vertexAttribPointer(r+s,3,e.type,e.normalized,e.stride,e.offset+12*s+i),o.enableVertexAttribArray(r+s),e.divisor&&e.divisor>0&&a&&a.vertexAttribDivisor(r+s,e.divisor);else if(16===e.count)for(s=0;s<4;s++)o.vertexAttribPointer(r+s,4,e.type,e.normalized,e.stride,e.offset+16*s+i),o.enableVertexAttribArray(r+s),e.divisor&&e.divisor>0&&a&&a.vertexAttribDivisor(r+s,e.divisor);else console.error("Unsupported vertex attribute element count: "+e.count)})},e.unbindVertexBufferLayout=function(e,t,r,i){var n=e.gl;e.bindBuffer(r),i.forEach(function(e){var r=t[e.name];if(e.count<=4)n.disableVertexAttribArray(r);else if(9===e.count)for(var i=0;i<3;i++)n.disableVertexAttribArray(r+i);else if(16===e.count)for(i=0;i<4;i++)n.disableVertexAttribArray(r+i);else console.error("Unsupported vertex attribute element count: "+e.count)}),e.unbindBuffer(34962)},e}()}.apply(null,i))||(e.exports=n)},1313:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,i))||(e.exports=n)},1342:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(9),r(5),r(7),r(1433)],void 0===(n=function(e,t,r,i,n,o){function a(e,t,i){for(var n="",o=0;o<i;){var a=e[t+o];if(a<128)n+=String.fromCharCode(a),o++;else if(a>=192&&a<224){if(o+1>=i)throw new r("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var s=(31&a)<<6|63&e[t+o+1];n+=String.fromCharCode(s),o+=2}else if(a>=224&&a<240){if(o+2>=i)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");s=(15&a)<<12|(63&e[t+o+1])<<6|63&e[t+o+2];n+=String.fromCharCode(s),o+=3}else{if(!(a>=240&&a<248))throw new r("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");if(o+3>=i)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");if((s=(7&a)<<18|(63&e[t+o+1])<<12|(63&e[t+o+2])<<6|63&e[t+o+3])>=65536){var l=55296+(s-65536>>10),u=56320+(1023&s);n+=String.fromCharCode(l,u)}else n+=String.fromCharCode(s);o+=4}}return n}function s(e,r){for(var i={byteOffset:0,byteCount:0,fields:Object.create(null)},n=0,o=0;o<r.length;o++){var a=r[o],s=a.valueType||a.type,l=t.valueType2ArrayBufferReader[s];i.fields[a.property]=l(e,n),n+=t.valueType2TypedArrayClassMap[s].BYTES_PER_ELEMENT}return i.byteCount=n,i}function l(e,t,i){var n,o,s=[],l=0;for(o=0;o<e;o+=1){if((n=t[o])>0){if(s.push(a(i,l,n-1)),0!==i[l+n-1])throw new r("string-array-error","Invalid string array: missing null termination.")}else s.push(null);l+=n}return s}function u(e,r){return new(0,t.valueType2TypedArrayClassMap[r.valueType])(e,r.byteOffset,r.count*r.valuesPerElement)}function c(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}function f(e,t,n){for(var o=null!=t.header?s(e,t.header):{byteOffset:0,byteCount:0,fields:{count:n}},a={header:o,byteOffset:o.byteCount,byteCount:0,entries:Object.create(null)},l=o.byteCount,u=0;u<t.ordering.length;u++){var c=t.ordering[u],f=i.clone(t[c]);if(f.count=o.fields.count,"String"===f.valueType){if(f.byteOffset=l,f.byteCount=o.fields[c+"ByteCount"],"UTF-8"!==f.encoding)throw new r("unsupported-encoding","Unsupported String encoding.",{encoding:f.encoding})}else{if(!h(f.valueType))throw new r("unsupported-value-type","Unsupported binary valueType",{valueType:f.valueType});var d=p(f.valueType);l+=l%d!=0?d-l%d:0,f.byteOffset=l,f.byteCount=d*f.valuesPerElement*f.count}l+=f.byteCount,a.entries[c]=f}return a.byteCount=l-a.byteOffset,a}function d(e,t,i){if(t!==e&&v.error("Invalid "+i+" buffer size\n expected: "+e+", actual: "+t+")"),t<e)throw new r("buffer-too-small","Binary buffer is too small",{expectedSize:e,actualSize:t})}function h(e){return t.valueType2TypedArrayClassMap.hasOwnProperty(e)}function p(e){return h(e)&&t.valueType2TypedArrayClassMap[e].BYTES_PER_ELEMENT}Object.defineProperty(t,"__esModule",{value:!0});var v=n.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");t.readHeader=s,t.readStringArray=l,t.createTypedView=u,t.createRawView=c,t.createAttributeDataIndex=f,t.createGeometryDataIndex=function(e,t,r){var n=s(e,t&&t.header),o=n.byteCount,a={header:n,byteOffset:n.byteCount,byteCount:0,vertexAttributes:i.clone(t.vertexAttributes)},l=a.vertexAttributes;r||null==l.region||delete l.region;for(var u=n.fields,c=null!=u.vertexCount?u.vertexCount:u.count,f=0;f<t.ordering.length;f++){var h=t.ordering[f];null!=l[h]&&(l[h].byteOffset=o,l[h].count=c,o+=p(l[h].valueType)*l[h].valuesPerElement*c)}var v=u.faceCount;if(t.faces&&v){a.faces=i.clone(t.faces);var y=a.faces;for(f=0;f<t.ordering.length;f++){var m=t.ordering[f];null!=y[m]&&(y[m].byteOffset=o,y[m].count=v,o+=p(y[m].valueType)*y[m].valuesPerElement*v)}}var x=u.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&x){a.featureAttributes=i.clone(t.featureAttributes);var g=a.featureAttributes;for(f=0;f<t.featureAttributeOrder.length;f++){var b=t.featureAttributeOrder[f];g[b].byteOffset=o,g[b].count=x;var _=p(g[b].valueType);"UInt64"===g[b].valueType&&(_=8),o+=_*g[b].valuesPerElement*x}}return d(o,e.byteLength,"geometry"),a.byteCount=o-a.byteOffset,a},t.readBinaryAttribute=function(e,t,i){if("lepcc-rgb"===e.encoding)return o.decodeRGB(t);if("lepcc-intensity"===e.encoding)return o.decodeIntensity(t);if(null!=e.encoding&&""!==e.encoding)throw new r("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");e["attributeByteCounts "]&&!e.attributeByteCounts&&(v.warn("Warning: Trailing space in 'attributeByteCounts '."),e.attributeByteCounts=e["attributeByteCounts "]),"ObjectIds"===e.ordering[0]&&e.hasOwnProperty("objectIds")&&(v.warn("Warning: Case error in objectIds"),e.ordering[0]="objectIds");var n=f(t,e,i);d(n.byteOffset+n.byteCount,t.byteLength,"attribute");var a=n.entries.attributeValues||n.entries.objectIds;if(a){if("String"===a.valueType){var s=n.entries.attributeByteCounts,h=u(t,s),p=c(t,a);return l(s.count,h,p)}return u(t,a)}throw new r("bad-attribute-storage-info","Bad attributeStorageInfo specification.")},t.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},t.valueType2ArrayBufferReader={Float32:function(e,t){return new DataView(e,0).getFloat32(t,!0)},Float64:function(e,t){return new DataView(e,0).getFloat64(t,!0)},UInt8:function(e,t){return new DataView(e,0).getUint8(t)},Int8:function(e,t){return new DataView(e,0).getInt8(t)},UInt16:function(e,t){return new DataView(e,0).getUint16(t,!0)},Int16:function(e,t){return new DataView(e,0).getInt16(t,!0)},UInt32:function(e,t){return new DataView(e,0).getUint32(t,!0)},Int32:function(e,t){return new DataView(e,0).getInt32(t,!0)}},t.isValueType=h,t.getBytesPerValue=p}.apply(null,i))||(e.exports=n)},1344:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(454),r(47),r(1451),r(1289)],void 0===(n=function(e,t,r,i,n,o){function a(e,t,r){return{center:i.vec3d.createFrom(e[0],e[1],e[2]),halfSize:c.createFrom(t[0],t[1],t[2]),quaternion:u.createFrom(r[0],r[1],r[2],r[3])}}function s(e,t){var r=o.plane.distance(t,e.center),i=l(e,t);return r>i?1:r<-i?-1:0}function l(e,t){u.conjugate(e.quaternion,d),u.multiplyVec3(d,t,h);var r=e.halfSize;return Math.abs(h[0]*r[0])+Math.abs(h[1]*r[1])+Math.abs(h[2]*r[2])}Object.defineProperty(t,"__esModule",{value:!0});var u=i.quat4,c=i.vec3,f=i.mat3d,d=u.create(),h=c.create(),p=c.create(),v=f.create(),y=function(){return function(e){var t=56*e;this.buffer=new ArrayBuffer(t),this.obbs=new Array(e);for(var r=0;r<e;r++)this.obbs[r]={center:new Float64Array(this.buffer,56*r+0,3),halfSize:new Float32Array(this.buffer,56*r+24,3),quaternion:new Float32Array(this.buffer,56*r+36,4)}}}();t.ObbArray=y,t.create=a,t.clone=function(e){return a(e.center,e.halfSize,e.quaternion)},t.set=function(e,t){i.vec3d.set(e.center,t.center),i.vec3.set(e.halfSize,t.halfSize),i.quat4.set(e.quaternion,t.quaternion)},t.compute=function(e,t){return t||(t=a([0,0,0],[-1,-1,-1],[0,0,0,1])),n.computeOBB(e,t),t},t.intersectPlane=s,t.toAaBoundingBox=function(e,t){t||(t=r.create());var i=u.toMat3(e.quaternion,v),n=e.halfSize[0]*Math.abs(i[0])+e.halfSize[1]*Math.abs(i[3])+e.halfSize[2]*Math.abs(i[6]),o=e.halfSize[0]*Math.abs(i[1])+e.halfSize[1]*Math.abs(i[4])+e.halfSize[2]*Math.abs(i[7]),a=e.halfSize[0]*Math.abs(i[2])+e.halfSize[1]*Math.abs(i[5])+e.halfSize[2]*Math.abs(i[8]);return t[0]=e.center[0]-n,t[1]=e.center[1]-o,t[2]=e.center[2]-a,t[3]=e.center[0]+n,t[4]=e.center[1]+o,t[5]=e.center[2]+a,t},t.minimumDistancePlane=function(e,t){return o.plane.distance(t,e.center)-l(e,t)},t.maximumDistancePlane=function(e,t){return o.plane.distance(t,e.center)+l(e,t)},t.isVisible=function(e,t){return s(e,t[0])<=0&&s(e,t[1])<=0&&s(e,t[2])<=0&&s(e,t[3])<=0&&s(e,t[4])<=0&&s(e,t[5])<=0},t.intersectLine=function(e,t,r,n){void 0===n&&(n=0),u.conjugate(e.quaternion,d),i.vec3.subtract(t,e.center,h);for(var o=u.multiplyVec3(d,h,h),a=u.multiplyVec3(d,r,p),s=-1/0,l=1/0,c=0;c<3;c++)if(Math.abs(a[c])>1e-6){var f=(n+e.halfSize[c]-o[c])/a[c],v=(-n-e.halfSize[c]-o[c])/a[c];s=Math.max(s,Math.min(f,v)),l=Math.min(l,Math.max(f,v))}else if(o[c]>e.halfSize[c]+n||o[c]<-e.halfSize[c]-n)return!1;return s<=l}}.apply(null,i))||(e.exports=n)},1346:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._listeners={}}return e.prototype.on=function(e,t){var r=this;null==this._listeners[e]&&(this._listeners[e]=new Map);var i={};return this._listeners[e].set(i,t),{remove:function(){return r._listeners[e].delete(i)}}},e.prototype.once=function(e,t){var r=this.on(e,function(e){r.remove(),t(e)});return r},e.prototype.emit=function(e,t){this.hasEventListener(e)&&this._listeners[e].forEach(function(e){return e(t)})},e.prototype.hasEventListener=function(e){return null!=this._listeners[e]&&this._listeners[e].size>0},e}();t.default=r}.apply(null,i))||(e.exports=n)},1432:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1313),r(168)],void 0===(n=function(e,t,r,i,n){function o(e,t){e.delete(t)}var a=new n(0,0,0,0),s=new Map,l=[],u=[];return function(){function e(e){this._previousResolution=Number.POSITIVE_INFINITY,this.cachePolicy="keep",this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=e.acquireTile,this.releaseTile=e.releaseTile,this.tileInfoView=e.tileInfoView,e.cachePolicy&&(this.cachePolicy=e.cachePolicy),null!=e.buffer&&(this.buffer=e.buffer)}return e.prototype.destroy=function(){this.tileIndex.clear()},e.prototype.update=function(e){var t=this,r=this.tileIndex,n=this.tileInfoView.getTileCoverage(e.state,this.buffer);if(n){var c=n.spans,f=n.lodInfo,d=f.level,h=e.state.resolution,p=!e.stationary&&h>this._previousResolution;this._previousResolution=h,r.forEach(function(e){return e.visible=!0}),this.tiles.length=0,s.clear();var v=0,y=0;if(c.length>0)for(var m=0,x=c;m<x.length;m++)for(var g=x[m],b=g.row,_=g.colFrom,I=g.colTo,w=_;w<=I;w++){v++;var C=a.set(d,b,f.normalizeCol(w),f.getWorldForColumn(w)).id;if(r.has(C)){if((D=r.get(C)).status!==i.TileStatus.INITIALIZED&&y++,D.attached){s.set(C,D);continue}D.attached||p||this._addParentTile(C,s)}else{var D=this.acquireTile(a);this.tileIndex.set(C,D),p||this._addParentTile(C,s)}}var T=y===v;u.length=0,l.length=0,r.forEach(function(e,r){if(a.set(r),!s.has(r)){var o=t.tileInfoView.intersects(n,a);!o||!p&&T?"purge"===t.cachePolicy&&e.status!==i.TileStatus.MODIFIED&&e.status!==i.TileStatus.READY?l.push(r):(a.level>d||!o)&&l.push(r):e.attached?u.push(r):a.level>d&&l.push(r)}});for(var P=0,S=u;P<S.length;P++){C=S[P];(D=r.get(C))&&D.attached&&s.set(C,D)}for(var M=0,B=l;M<B.length;M++){C=B[M],D=r.get(C);this.releaseTile(D),o(r,C)}s.forEach(function(e){return t.tiles.push(e)}),r.forEach(function(e){s.has(e.key.id)||(e.visible=!1)}),u.length=0,l.length=0,s.clear()}},e.prototype.clear=function(){var e=this,t=this.tileIndex;t.forEach(function(t){e.releaseTile(t)}),t.clear()},e.prototype._addParentTile=function(e,t){for(var r=e,i=null;r=this.tileInfoView.getTileParentId(r);)if(this.tileIndex.has(r)&&(i=this.tileIndex.get(r))&&i.attached){t.has(i.key.id)||t.set(i.key.id,i);break}},e}()}.apply(null,i))||(e.exports=n)},1433:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(9)],void 0===(n=function(e,t,r){function i(e,t,r){return{identifier:String.fromCharCode.apply(null,new Uint8Array(e,r+c.identifierOffset,c.identifierLength)),version:t.getUint16(r+c.versionOffset,u),checksum:t.getUint32(r+c.checksumOffset,u)}}function n(e,t){return{sizeLo:e.getUint32(t+f.sizeLo,u),sizeHi:e.getUint32(t+f.sizeHi,u),minX:e.getFloat64(t+f.minX,u),minY:e.getFloat64(t+f.minY,u),minZ:e.getFloat64(t+f.minZ,u),maxX:e.getFloat64(t+f.maxX,u),maxY:e.getFloat64(t+f.maxY,u),maxZ:e.getFloat64(t+f.maxZ,u),errorX:e.getFloat64(t+f.errorX,u),errorY:e.getFloat64(t+f.errorY,u),errorZ:e.getFloat64(t+f.errorZ,u),count:e.getUint32(t+f.count,u),reserved:e.getUint32(t+f.reserved,u)}}function o(e,t,r){var i=[];t=a(e,t,i);for(var n=[],o=0;o<i.length;o++){n.length=0,t=a(e,t,n);for(var s=0;s<n.length;s++)r.push(n[s]+i[o])}return t}function a(e,t,i){var n=new DataView(e,t),o=n.getUint8(0),a=31&o,s=!!(32&o),l=(192&o)>>6,c=0;if(0===l)c=n.getUint32(1,u),t+=5;else if(1===l)c=n.getUint16(1,u),t+=3;else{if(2!==l)throw new r("lepcc-decode-error","Bad count type");c=n.getUint8(1),t+=2}if(s)throw new r("lepcc-decode-error","LUT not implemented");for(var f=Math.ceil(c*a/8),d=new Uint8Array(e,t,f),h=0,p=0,v=0,y=-1>>>32-a,m=0;m<c;m++){for(;p<a;)h|=d[v]<<p,p+=8,v+=1;i[m]=h&y,h>>>=a,(p-=a)+a>32&&(h|=d[v-1]>>8-p)}return t+v}function s(e,t){return{sizeLo:e.getUint32(t+d.sizeLo,u),sizeHi:e.getUint32(t+d.sizeHi,u),count:e.getUint32(t+d.count,u),colorMapCount:e.getUint16(t+d.colorMapCount,u),lookupMethod:e.getUint8(t+d.lookupMethod),compressionMethod:e.getUint8(t+d.compressionMethod)}}function l(e,t){return{sizeLo:e.getUint32(t+h.sizeLo,u),sizeHi:e.getUint32(t+h.sizeHi,u),count:e.getUint32(t+h.count,u),scaleFactor:e.getUint16(t+h.scaleFactor,u),bitsPerPoint:e.getUint8(t+h.bitsPerPoint),reserved:e.getUint8(t+h.reserved)}}Object.defineProperty(t,"__esModule",{value:!0});var u=!0,c={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16},f={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};t.decodeXYZ=function(e){var t=new DataView(e,0),a=0,s=i(e,t,a),l=s.identifier,u=s.version;if(a+=c.byteCount,"LEPCC     "!==l)throw new r("lepcc-decode-error","Bad identifier");if(u>1)throw new r("lepcc-decode-error","Unknown version");var d=n(t,a);if(a+=f.byteCount,d.sizeHi*Math.pow(2,32)+d.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var h=new Float64Array(3*d.count),p=[],v=[],y=[],m=[];if((a=o(e,a=o(e,a=o(e,a=o(e,a,p),v),y),m))!==e.byteLength)throw new r("lepcc-decode-error","Bad length");for(var x=0,g=0,b=0;b<p.length;b++){g+=p[b];for(var _=0,I=0;I<v[b];I++){_+=y[x];var w=m[x];h[3*x]=Math.min(d.maxX,d.minX+2*d.errorX*_),h[3*x+1]=Math.min(d.maxY,d.minY+2*d.errorY*g),h[3*x+2]=Math.min(d.maxZ,d.minZ+2*d.errorZ*w),x++}}return{errorX:d.errorX,errorY:d.errorY,errorZ:d.errorZ,result:h}};var d={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};t.decodeRGB=function(e){var t=new DataView(e,0),n=0,o=i(e,t,n),a=o.identifier,l=o.version;if(n+=c.byteCount,"ClusterRGB"!==a)throw new r("lepcc-decode-error","Bad identifier");if(l>1)throw new r("lepcc-decode-error","Unknown version");var u=s(t,n);if(n+=d.byteCount,u.sizeHi*Math.pow(2,32)+u.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");if(2!==u.lookupMethod&&1!==u.lookupMethod||0!==u.compressionMethod){if(0===u.lookupMethod&&0===u.compressionMethod){if(3*u.count+n!==e.byteLength||0!==u.colorMapCount)throw new r("lepcc-decode-error","Bad count");return new Uint8Array(e,n).slice()}if(u.lookupMethod<=2&&1===u.compressionMethod){if(n+3!==e.byteLength||1!==u.colorMapCount)throw new r("lepcc-decode-error","Bad count");for(var f=t.getUint8(n),h=t.getUint8(n+1),p=t.getUint8(n+2),v=new Uint8Array(3*u.count),y=0;y<u.count;y++)v[3*y]=f,v[3*y+1]=h,v[3*y+2]=p;return v}throw new r("lepcc-decode-error","Bad method "+u.lookupMethod+","+u.compressionMethod)}if(3*u.colorMapCount+u.count+n!==e.byteLength||u.colorMapCount>256)throw new r("lepcc-decode-error","Bad count");var m=new Uint8Array(e,n,3*u.colorMapCount),x=new Uint8Array(e,n+3*u.colorMapCount,u.count);for(v=new Uint8Array(3*u.count),y=0;y<u.count;y++){var g=x[y];v[3*y]=m[3*g],v[3*y+1]=m[3*g+1],v[3*y+2]=m[3*g+2]}return v};var h={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};t.decodeIntensity=function(e){var t=new DataView(e,0),n=0,o=i(e,t,n),s=o.identifier,u=o.version;if(n+=c.byteCount,"Intensity "!==s)throw new r("lepcc-decode-error","Bad identifier");if(u>1)throw new r("lepcc-decode-error","Unknown version");var f=l(t,n);if(n+=h.byteCount,f.sizeHi*Math.pow(2,32)+f.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var d=new Uint16Array(f.count);if(8===f.bitsPerPoint){if(f.count+n!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(var p=new Uint8Array(e,n,f.count),v=0;v<f.count;v++)d[v]=p[v]*f.scaleFactor}else if(16===f.bitsPerPoint){if(2*f.count+n!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(p=new Uint16Array(e,n,f.count),v=0;v<f.count;v++)d[v]=p[v]*f.scaleFactor}else{if(a(e,n,p=[])!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(v=0;v<f.count;v++)d[v]=p[v]*f.scaleFactor}return d}}.apply(null,i))||(e.exports=n)},1448:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,r=Math.sqrt(e*e+t*t);this.x/=r,this.y/=r},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var r=this.x,i=this.y;this.x=r*e-i*t,this.y=r*t+i*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var r=t.x-e.x,i=t.y-e.y;return Math.sqrt(r*r+i*i)},e.add=function(t,r){return new e(t.x+r.x,t.y+r.y)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y)},e}();t.Point=r}.apply(null,i))||(e.exports=n)},1449:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e,t){return(e%=t)>=0?e:e+t}Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var i=1/Math.LN2;t.positiveMod=r,t.radToByte=function(e){return r(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return r(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*i},t.sqr=function(e){return e*e},t.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return e>=t&&e<=r||e>=r&&e<=t}}.apply(null,i))||(e.exports=n)},1451:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(47)],void 0===(n=function(e,t,r){function i(e,t,i,n,o,s,l,u,c,f,d){return function(e,t,i){for(var n=r.vec3d.dist2(e.maxVert[0],e.minVert[0]),o=0,a=1;a<7;++a){var s=r.vec3d.dist2(e.maxVert[a],e.minVert[a]);s>n&&(n=s,o=a)}r.vec3d.set(e.minVert[o],t),r.vec3d.set(e.maxVert[o],i)}(e,n,o),r.vec3d.dist2(n,o)<h?1:(r.vec3d.subtract(n,o,l),r.vec3d.normalize(l),function(e,t,i,n){for(var o=e.data,a=e.offsetIdx,s=e.strideIdx,l=Number.NEGATIVE_INFINITY,u=0,c=a;c<o.length;c+=s){r.vec3d.set3(o[c]-t[0],o[c+1]-t[1],o[c+2]-t[2],C);var f=i[0]*C[0]+i[1]*C[1]+i[2]*C[2],d=r.vec3d.length2(i),h=r.vec3d.length2(C)-f*f/d;h>l&&(l=h,u=c)}return r.vec3d.set3(o[u],o[u+1],o[u+2],n),l}(t,n,l,s)<h?2:(r.vec3d.subtract(o,s,u),r.vec3d.normalize(u),r.vec3d.subtract(s,n,c),r.vec3d.normalize(c),r.vec3d.cross(u,l,i),r.vec3d.normalize(i),a(t,i,l,u,c,f),0))}function n(e,t,i,n,s,l,u,c,f,d){o(e,t,i,n,s,y,m),void 0!==y[0]&&(r.vec3d.subtract(y,i,x),r.vec3d.normalize(x),r.vec3d.subtract(y,n,g),r.vec3d.normalize(g),r.vec3d.subtract(y,s,b),r.vec3d.normalize(b),r.vec3d.cross(g,l,_),r.vec3d.normalize(_),r.vec3d.cross(b,u,I),r.vec3d.normalize(I),r.vec3d.cross(x,c,w),r.vec3d.normalize(w),a(e,_,l,g,x,f),a(e,I,u,b,g,f),a(e,w,c,x,b,f)),void 0!==m[0]&&(r.vec3d.subtract(m,i,x),r.vec3d.normalize(x),r.vec3d.subtract(m,n,g),r.vec3d.normalize(g),r.vec3d.subtract(m,s,b),r.vec3d.normalize(b),r.vec3d.cross(g,l,_),r.vec3d.normalize(_),r.vec3d.cross(b,u,I),r.vec3d.normalize(I),r.vec3d.cross(x,c,w),r.vec3d.normalize(w),a(e,_,l,g,x,f),a(e,I,u,b,g,f),a(e,w,c,x,b,f))}function o(e,t,i,n,o,a,s){!function(e,t,i,n,o){var a=e.data,s=e.offsetIdx,l=e.strideIdx;r.vec3d.set3(a[s],a[s+1],a[s+2],n),r.vec3d.set(n,o),i[0]=r.vec3d.dot(A,t),i[1]=i[0];for(var u=s+l;u<a.length;u+=l){r.vec3d.set3(a[u],a[u+1],a[u+2],A);var c=r.vec3d.dot(A,t);c<i[0]&&(i[0]=c,r.vec3d.set(A,n)),c>i[1]&&(i[1]=c,r.vec3d.set(A,o))}}(e,t,D,s,a);var l=r.vec3.dot(i,t);D[1]-h<=l&&(a[0]=void 0),D[0]+h>=l&&(s[0]=void 0)}function a(e,t,i,n,o,a){if(!(r.vec3d.length2(t)<h)){r.vec3d.cross(i,t,T),r.vec3d.cross(n,t,P),r.vec3d.cross(o,t,S),s(e,t,D),B[1]=D[0],M[1]=D[1],V[1]=M[1]-B[1];for(var l=[i,n,o],u=[T,P,S],c=0;c<3;++c){s(e,l[c],D),B[0]=D[0],M[0]=D[1],s(e,u[c],D),B[2]=D[0],M[2]=D[1],V[0]=M[0]-B[0],V[2]=M[2]-B[2];var f=d(V);f<a.quality&&(r.vec3d.set(l[c],a.b0),r.vec3d.set(t,a.b1),r.vec3d.set(u[c],a.b2),a.quality=f)}}}function s(e,t,r){var i=e.data,n=e.offsetIdx,o=e.strideIdx;r[0]=Number.POSITIVE_INFINITY,r[1]=Number.NEGATIVE_INFINITY;for(var a=n;a<i.length;a+=o){var s=i[a]*t[0]+i[a+1]*t[1]+i[a+2]*t[2];r[0]=Math.min(r[0],s),r[1]=Math.max(r[1],s)}}function l(e,t,i){r.vec3d.set(e,i.center),r.vec3d.scale(t,.5,i.halfSize),r.quat4.identity(i.quaternion)}function u(e,t,i){r.vec3d.set(t,E),Math.abs(t[0])>Math.abs(t[1])&&Math.abs(t[0])>Math.abs(t[2])?E[0]=0:Math.abs(t[1])>Math.abs(t[2])?E[1]=0:E[2]=0,r.vec3d.length2(E)<h&&(E[0]=E[1]=E[2]=1),r.vec3d.cross(t,E,z),r.vec3d.normalize(z),r.vec3d.cross(t,z,O),r.vec3d.normalize(O),c(e,t,z,O,L,N),r.vec3d.subtract(N,L,j),f(t,z,O,L,N,j,i)}function c(e,t,r,i,n,o){s(e,t,D),n[0]=D[0],o[0]=D[1],s(e,r,D),n[1]=D[0],o[1]=D[1],s(e,i,D),n[2]=D[0],o[2]=D[1]}function f(e,t,i,n,o,a,s){F[0]=e[0],F[3]=e[1],F[6]=e[2],F[1]=t[0],F[4]=t[1],F[7]=t[2],F[2]=i[0],F[5]=i[1],F[8]=i[2],r.quat4.fromRotationMatrix(F,s.quaternion),r.vec3d.add(n,o,R),r.vec3d.scale(R,.5),r.vec3d.scale(e,R[0],s.center),r.vec3d.scale(t,R[1],k),r.vec3d.add(s.center,k),r.vec3d.scale(i,R[2],k),r.vec3d.add(s.center,k),r.vec3d.scale(a,.5,s.halfSize)}function d(e){return e[0]*e[1]+e[0]*e[2]+e[1]*e[2]}Object.defineProperty(t,"__esModule",{value:!0});var h=1e-6,p=r.vec3d.create(),v=r.vec3d.create();t.computeOBB=function(e,t){var o=e.data,a=e.strideIdx,s=o.length/a;if(!(s<=0)){var h=new U(e);r.vec3d.add(h.minProj,h.maxProj,p),r.vec3d.scale(p,.5),r.vec3d.subtract(h.maxProj,h.minProj,v);var y=d(v),m=new Y;m.quality=y,s<14&&(e={data:new Float64Array(h.buffer,112,42),size:3,offsetIdx:0,strideIdx:3});var x=r.vec3d.create(),g=r.vec3d.create(),b=r.vec3d.create(),_=r.vec3d.create(),I=r.vec3d.create(),w=r.vec3d.create(),C=r.vec3d.create();switch(i(h,e,C,x,g,b,_,I,w,m)){case 1:return void l(p,v,t);case 2:return void u(e,_,t)}n(e,C,x,g,b,_,I,w,m),c(e,m.b0,m.b1,m.b2,L,N);var D=r.vec3d.create();r.vec3d.subtract(N,L,D),m.quality=d(D),m.quality<y?f(m.b0,m.b1,m.b2,L,N,D,t):l(p,v,t)}};var y=r.vec3d.create(),m=r.vec3d.create(),x=r.vec3d.create(),g=r.vec3d.create(),b=r.vec3d.create(),_=r.vec3d.create(),I=r.vec3d.create(),w=r.vec3d.create(),C=r.vec3d.create(),D=r.vec2d.create(),T=r.vec3d.create(),P=r.vec3d.create(),S=r.vec3d.create(),M=r.vec3d.create(),B=r.vec3d.create(),V=r.vec3d.create(),A=r.vec3d.create(),E=r.vec3d.create(),z=r.vec3d.create(),O=r.vec3d.create(),L=r.vec3d.create(),N=r.vec3d.create(),j=r.vec3d.create(),k=r.vec3d.create(),F=r.mat3d.create(),R=r.vec3d.create(),U=function(){return function(e){this.minVert=[],this.maxVert=[],this.buffer=new ArrayBuffer(448);var t=0;for(this.minProj=new Float64Array(this.buffer,t,7),t+=56,this.maxProj=new Float64Array(this.buffer,t,7),t+=56;this.minVert.length<7;)this.minVert.push(new Float64Array(this.buffer,t,3)),t+=24;for(;this.maxVert.length<7;)this.maxVert.push(new Float64Array(this.buffer,t,3)),t+=24;for(var i=0;i<7;++i)this.minProj[i]=Number.POSITIVE_INFINITY,this.maxProj[i]=Number.NEGATIVE_INFINITY;var n=[],o=[],a=e.data,s=e.offsetIdx,l=e.strideIdx;for(i=s;i<a.length;i+=l){var u=a[i];u<this.minProj[0]&&(this.minProj[0]=u,n[0]=i),u>this.maxProj[0]&&(this.maxProj[0]=u,o[0]=i),(u=a[i+1])<this.minProj[1]&&(this.minProj[1]=u,n[1]=i),u>this.maxProj[1]&&(this.maxProj[1]=u,o[1]=i),(u=a[i+2])<this.minProj[2]&&(this.minProj[2]=u,n[2]=i),u>this.maxProj[2]&&(this.maxProj[2]=u,o[2]=i),(u=a[i]+a[i+1]+a[i+2])<this.minProj[3]&&(this.minProj[3]=u,n[3]=i),u>this.maxProj[3]&&(this.maxProj[3]=u,o[3]=i),(u=a[i]+a[i+1]-a[i+2])<this.minProj[4]&&(this.minProj[4]=u,n[4]=i),u>this.maxProj[4]&&(this.maxProj[4]=u,o[4]=i),(u=a[i]-a[i+1]+a[i+2])<this.minProj[5]&&(this.minProj[5]=u,n[5]=i),u>this.maxProj[5]&&(this.maxProj[5]=u,o[5]=i),(u=a[i]-a[i+1]-a[i+2])<this.minProj[6]&&(this.minProj[6]=u,n[6]=i),u>this.maxProj[6]&&(this.maxProj[6]=u,o[6]=i)}for(i=0;i<7;++i){var c=n[i];r.vec3d.set3(a[c],a[c+1],a[c+2],this.minVert[i]),c=o[i],r.vec3d.set3(a[c],a[c+1],a[c+2],this.maxVert[i])}}}(),Y=function(){return function(){this.b0=r.vec3d.createFrom(1,0,0),this.b1=r.vec3d.createFrom(0,1,0),this.b2=r.vec3d.createFrom(0,0,1),this.quality=0}}()}.apply(null,i))||(e.exports=n)},1473:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(6),r(19),r(5),r(0),r(1617),r(1618),r(1619)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c){var f=o({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"}),d=function(e){function t(t){var r=e.call(this)||this;return r.type=void 0,r.pointSizeAlgorithm=null,r.colorModulation=null,r.pointsPerInch=10,r}return r(t,e),t.prototype.clone=function(){return console.warn(".clone() is not implemented for "+this.declaredClass),null},t.prototype.cloneProperties=function(){return{pointSizeAlgorithm:a.clone(this.pointSizeAlgorithm),colorModulation:a.clone(this.colorModulation),pointsPerInch:a.clone(this.pointsPerInch)}},i([s.property({type:String,readOnly:!0,nonNullable:!0,json:{read:!1,write:f.write}})],t.prototype,"type",void 0),i([s.property({types:c.pointSizeAlgorithmTypes,json:{read:u.read,write:!0}})],t.prototype,"pointSizeAlgorithm",void 0),i([s.property({type:l.default,json:{write:!0}})],t.prototype,"colorModulation",void 0),i([s.property({json:{write:!0},nonNullable:!0,type:Number})],t.prototype,"pointsPerInch",void 0),i([s.subclass("esri.renderers.PointCloudRenderer")],t)}(s.declared(n));return(d||(d={})).fieldTransformTypeKebabDict=o({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"}),d}.apply(null,i))||(e.exports=n)},1483:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e,t,r,i){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===i&&(i=0),this.x=e,this.y=t,this.width=r,this.height=i}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,i))||(e.exports=n)},1501:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(6),r(19),r(0)],void 0===(n=function(e,t,r,i,n,o,a){Object.defineProperty(t,"__esModule",{value:!0}),t.typeKebabDictionary=o({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});var s=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return r(n,e),i([a.property({type:String,readOnly:!0,nonNullable:!0,json:{read:!1,write:t.typeKebabDictionary.write}})],n.prototype,"type",void 0),i([a.subclass("esri.renderers.support.pointCloud.PointSizeAlgorithm")],n)}(a.declared(n));t.PointSizeAlgorithm=s,t.default=s}.apply(null,i))||(e.exports=n)},1503:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1342),r(1475),r(1268),r(1267)],void 0===(n=function(e,t,r,i,n,o){function a(e,t,r,i,n,o,a){switch(r){case 1:for(var s=0;s<a;s++)i[n]=e[t],t+=1,n+=o;break;case 2:for(s=0;s<a;s++)i[n]=e[t],i[n+1]=e[t+1],t+=2,n+=o;break;case 3:for(s=0;s<a;s++)i[n]=e[t],i[n+1]=e[t+1],i[n+2]=e[t+2],t+=3,n+=o;break;case 4:for(s=0;s<a;s++)i[n]=e[t],i[n+1]=e[t+1],i[n+2]=e[t+2],i[n+3]=e[t+3],t+=4,n+=o;break;default:throw d("Unhandled stride size "+r)}}function s(e,t,r,i,n,o){switch(t){case 1:for(var a=0;a<o;a++)r[i]=e,i+=n;break;case 2:for(a=0;a<o;a++)r[i]=e,r[i+1]=e,i+=n;break;case 3:for(a=0;a<o;a++)r[i]=e,r[i+1]=e,r[i+2]=e,i+=n;break;case 4:for(a=0;a<o;a++)r[i]=e,r[i+1]=e,r[i+2]=e,r[i+3]=e,i+=n;break;default:throw d("Unhandled stride size "+t)}}function l(e){switch(e){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array}throw new Error("Unhandled data type: "+e)}function u(e){switch(e){case 5120:return"Int8";case 5126:return"Float32";case 5124:return"Int32";case 5122:return"Int16";case 5121:return"UInt8";case 5125:return"UInt32";case 5123:return"UInt16"}throw new Error("Unhandled data type: "+e)}function c(e){return e%Uint32Array.BYTES_PER_ELEMENT==0}function f(e){return e>0&&e%Uint32Array.BYTES_PER_ELEMENT==0}function d(e){return new Error("I3SGeometryUtil processing failed: "+e)}function h(e){var t=e.normals,r=e.positions,i=e.normalInd,a=e.positionInd;o.assert(e.normalInd.length===e.positionInd.length);for(var s=n.vec3.create(),l=n.vec3.create(),u=n.vec2.create(),c=r.data,f=r.offsetIdx,d=r.strideIdx,h=t.data,p=t.offsetIdx,v=t.strideIdx,y=0;y<a.length;y+=3){var m=a[y],x=f+d*m,g=c[x],b=c[x+1],_=c[x+2];x=f+d*(m=a[y+1]),s[0]=c[x]-g,s[1]=c[x+1]-b,s[2]=c[x+2]-_,x=f+d*(m=a[y+2]),l[0]=c[x]-g,l[1]=c[x+1]-b,l[2]=c[x+2]-_,n.vec3.cross(s,l,s),o.encodeNormal(s,u);for(var I=0;I<3;I++){var w=p+v*i[y+I];h[w]=o.encodeInt16(u[0]),h[w+1]=o.encodeInt16(u[1])}}}function p(e,t,r){var i=e.length/3,n=t.data,a=t.offsetIdx,s=t.strideIdx;if(null!=r)for(var l=r,u=l[0],c=l[1],f=l[2],d=l[4],h=l[5],p=l[6],v=l[8],y=l[9],g=l[10],b=0;b<i;b++){var _=e[3*b],I=e[3*b+1],w=e[3*b+2];m[0]=u*_+c*I+f*w,m[1]=d*_+h*I+p*w,m[2]=v*_+y*I+g*w,o.encodeNormal(m,x),n[a+b*s]=o.encodeInt16(x[0]),n[a+b*s+1]=o.encodeInt16(x[1])}else for(b=0;b<i;b++)m[0]=e[3*b],m[1]=e[3*b+1],m[2]=e[3*b+2],o.encodeNormal(m,x),n[a+b*s]=o.encodeInt16(x[0]),n[a+b*s+1]=o.encodeInt16(x[1])}Object.defineProperty(t,"__esModule",{value:!0});var v=new Uint8Array(64);t.interleaveGeometryBuffer=function(e,t,r,i,n){void 0===i&&(i=[]),void 0===n&&(n=[]);var o=e.params.vertexAttributes,h=o.position.count;if(!f(r[0].stride))throw d("Layout stride must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");for(var p=r[0].stride/Uint32Array.BYTES_PER_ELEMENT,y=new Uint32Array(p*h),m=0,x=r=r.slice(0).sort(function(e,t){return e.offset-t.offset});m<x.length;m++)!function(e){if(-1!==n.indexOf(e.name))return"continue";var r=o[e.name],p=l(e.type),m=void 0,x=!1;if(null==r){var g=i.filter(function(t){return t.name===e.name})[0];if(!g)throw d("Geometry definition is missing attribute");r={valueType:u(e.type),byteOffset:0,count:h,valuesPerElement:e.count};for(var b=0;b<v.length;b++)v[b]=g.byteValue;m=v.buffer,x=!0}else m=t;if(u(e.type)!==r.valueType)throw d("Geometry definition type must match attribute type");if(!c(r.byteOffset)||!c(e.offset))throw d(e.name+" offset must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");if(!f(r.valuesPerElement*p.BYTES_PER_ELEMENT)||!f(e.count*p.BYTES_PER_ELEMENT))throw d(e.name+" data must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");var _=new Uint32Array(m),I=r.byteOffset/Uint32Array.BYTES_PER_ELEMENT,w=r.valuesPerElement*p.BYTES_PER_ELEMENT/Uint32Array.BYTES_PER_ELEMENT,C=e.offset/Uint32Array.BYTES_PER_ELEMENT,D=e.stride/Uint32Array.BYTES_PER_ELEMENT;x?s(_[0],w,y,C,D,h):a(_,I,w,y,C,D,h)}(x[m]);return y.buffer},t.processAndInterleaveNormals=function(e,t,i,n,o){if("none"===e)h(o);else{var a=r.createTypedView(i,t.params.vertexAttributes.normal),s="earth-centered"===e?n:null;p(a,o.normals,s)}};var y=65536;t.extractPositionData=function(e,t,r){var n=t[0];if(null==n||"position"!==n.name||5126!==n.type)return null;for(var o=new Float32Array(e),a=n.stride/4,s=3*o.length/a,l=new Float32Array(s),u=0;u<s/3;u++)l[3*u]=o[u*a+n.offset],l[3*u+1]=o[u*a+n.offset+1],l[3*u+2]=o[u*a+n.offset+2];var c,f=i.deduplicate(l.buffer,3),d=f.uniqueCount<y;if(r)for(c=new(d?Uint16Array:Uint32Array)(r.length),u=0;u<r.length;u++)c[u]=f.indices[r[u]];else c=d?new Uint16Array(f.indices):f.indices;return{data:new Float32Array(f.buffer),indices:c}};var m=n.vec3.create(),x=n.vec2.create()}.apply(null,i))||(e.exports=n)},1504:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(47),r(106)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0}),t.ReprojectionTypes={PER_VERTEX:"perVertex",NO_REPROJECTION:"noReprojection"};var n=1e3,o=new Float64Array(3*n),a=r.vec3d.create();t.reprojectPoints=function(e,t,s,l,u,c){var f=e.data,d=e.offsetIdx,h=e.strideIdx;r.vec3d.set(t,a),a[2]+=s;var p=r.mat4d.create();i.computeLinearTransformation(l,a,p,c);var v=r.mat4d.create();r.mat4d.inverse(p,v);var y=r.mat4d.create();r.mat4d.identity(y);var m=[0,0,0],x=f.length/h;i.vectorToVector(a,l,m,u);for(var g=0;g<x;g+=n){for(var b=Math.min(n,x-g),_=0;_<b;_++){var I=d+h*(g+_);o[3*_]=f[I]+m[0],o[3*_+1]=f[I+1]+m[1],o[3*_+2]=f[I+2]+m[2]}for(i.bufferToBuffer(o,u,0,o,c,0,b),_=0;_<b;_++){var w=o[3*_],C=o[3*_+1],D=o[3*_+2],T=d+h*(g+_);f[T]=v[0]*w+v[4]*C+v[8]*D+v[12],f[T+1]=v[1]*w+v[5]*C+v[9]*D+v[13],f[T+2]=v[2]*w+v[6]*C+v[10]*D+v[14]}}return{localTrafo:y,globalTrafo:p}}}.apply(null,i))||(e.exports=n)},1516:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1483)],void 0===(n=function(e,t,r){return function(){function e(e,t,r,i,n,o,a,s){this._glyphItems=e,this._maxWidth=t,this._lineHeight=r,this._letterSpacing=i,this._offset=n,this._hAnchor=o,this._vAnchor=a,this._justify=s}return e.prototype.getShaping=function(e,t){for(var r=this._letterSpacing,i=this._lineHeight,n=this._justify,o=this._maxWidth,a=[],s=0,l=0,u=0,c=0,f=-1,d=0,h=-1,p=e.length,v=0;v<p;v++){var y=e.charCodeAt(v);if(10!==y){for(var m=void 0,x=0,g=this._glyphItems;x<g.length&&!(m=g[x][y]);x++);if(m){if(a.push({codePoint:y,x:s,y:l,glyphMosaicItem:m}),s+=m.metrics.advance+r,o>0&&s>o&&h>=0){var b=h+1,_=a[b].x;d=Math.max(_,d);for(var I=b;I<a.length;I++)t?a[I].y-=i:a[I].y+=i,a[I].x-=_;n&&this._applyJustification(a,c,h),t?l-=i:l+=i,s-=_,++u,c=b,h=-1}++f,32===y&&(h=a.length-1)}}else{if(v===p-1)continue;if(f>=c){_=(w=a[f]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(_,d),n&&this._applyJustification(a,c,f),c=a.length}t?l-=i:l+=i,s=0,++u}}if(f>=c){var w,C=(w=a[f]).x+w.glyphMosaicItem.metrics.advance;d=Math.max(d,C),n&&this._applyJustification(a,c,f)}if(a.length>0){var D=(n-this._hAnchor)*d,T=(-this._vAnchor*(u+1)+.5)*i;t&&u&&(T+=u*i),D+=this._offset[0],T+=this._offset[1];for(var P=0,S=a;P<S.length;P++){var M=S[P];M.x+=D,M.y+=T}}return a},e.getBox=function(e){var t=e.length;if(0!==t){for(var r=e[0].x+e[0].glyphMosaicItem.metrics.left,i=r,n=e[0].y,o=n,a=n,s=1;s<t;s++){var l=e[s],u=l.x+l.glyphMosaicItem.metrics.left;u<r&&(r=u),u>i&&(i=u);var c=l.y;if(c<n&&(n=c),c>o&&(o=c),c!==a){var f=e[s-1].glyphMosaicItem.metrics.width;i=Math.max(i,e[s-1].x+e[s-1].glyphMosaicItem.metrics.left+f),a=c}}var d=e[t-1].glyphMosaicItem.metrics.width;return i=Math.max(i,e[t-1].x+e[t-1].glyphMosaicItem.metrics.left+d),{x:r,y:o+=12,width:i-r,height:o-(n-=12)}}},e.addDecoration=function(e,t){var i=e.length;if(0!==i){for(var n=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y,a=1;a<i;a++){var s=e[a];if(s.y!==o){var l=e[a-1].x+e[a-1].glyphMosaicItem.metrics.left+e[a-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:l-n,height:8,left:0,top:0,advance:0},page:0}}),o=s.y,n=s.x+s.glyphMosaicItem.metrics.left}}var u=e[i-1].x+e[i-1].glyphMosaicItem.metrics.left+e[i-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:n,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:u-n,height:8,left:0,top:0,advance:0},page:0}})}},e.prototype._applyJustification=function(e,t,r){for(var i=e[r],n=i.glyphMosaicItem.metrics.advance,o=(i.x+n)*this._justify,a=t;a<=r;a++)e[a].x-=o},e}()}.apply(null,i))||(e.exports=n)},1517:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1448),r(1449)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t,r){this.ratio=e,this.x=t,this.y=r}}(),o=function(){function e(e,t,r,i,n){void 0===i&&(i=8),void 0===n&&(n=8),this.lines=[],this.starts=[],this.pixelRatio=i,this.pixelMargin=n,this.tileSize=512*i,this.dz=e,this.yPos=t,this.xPos=r}return e.prototype.setExtent=function(e){this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var r=e>>this.dz;t>r&&(t=r),this.margin=t,this.xmin=r*this.xPos-t,this.ymin=r*this.yPos-t,this.xmax=this.xmin+r+2*t,this.ymax=this.ymin+r+2*t},e.prototype.reset=function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0},e.prototype.moveTo=function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new r.Point(e,t),this._firstPt=new r.Point(e,t),this._dist=0},e.prototype.lineTo=function(e,t){var i,o,a,s,l,u,c,f,d=this._isIn(e,t),h=new r.Point(e,t),p=r.Point.distance(this._prevPt,h);if(d)this._prevIsIn?this._lineTo(e,t,!0):(i=this._prevPt,o=h,a=this._intersect(o,i),this.start=this._dist+p*(1-this._r),this._lineTo(a.x,a.y,!0),this._lineTo(o.x,o.y,!0));else if(this._prevIsIn)o=this._prevPt,i=h,a=this._intersect(o,i),this._lineTo(a.x,a.y,!0),this._lineTo(i.x,i.y,!1);else{var v=this._prevPt,y=h;if(v.x<=this.xmin&&y.x<=this.xmin||v.x>=this.xmax&&y.x>=this.xmax||v.y<=this.ymin&&y.y<=this.ymin||v.y>=this.ymax&&y.y>=this.ymax)this._lineTo(y.x,y.y,!1);else{var m=[];if((v.x<this.xmin&&y.x>this.xmin||v.x>this.xmin&&y.x<this.xmin)&&(s=(this.xmin-v.x)/(y.x-v.x),(f=v.y+s*(y.y-v.y))<=this.ymin?u=!1:f>=this.ymax?u=!0:m.push(new n(s,this.xmin,f))),(v.x<this.xmax&&y.x>this.xmax||v.x>this.xmax&&y.x<this.xmax)&&(s=(this.xmax-v.x)/(y.x-v.x),(f=v.y+s*(y.y-v.y))<=this.ymin?u=!1:f>=this.ymax?u=!0:m.push(new n(s,this.xmax,f))),(v.y<this.ymin&&y.y>this.ymin||v.y>this.ymin&&y.y<this.ymin)&&(s=(this.ymin-v.y)/(y.y-v.y),(c=v.x+s*(y.x-v.x))<=this.xmin?l=!1:c>=this.xmax?l=!0:m.push(new n(s,c,this.ymin))),(v.y<this.ymax&&y.y>this.ymax||v.y>this.ymax&&y.y<this.ymax)&&(s=(this.ymax-v.y)/(y.y-v.y),(c=v.x+s*(y.x-v.x))<=this.xmin?l=!1:c>=this.xmax?l=!0:m.push(new n(s,c,this.ymax))),0===m.length)l?u?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):u?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(m.length>1&&m[0].ratio>m[1].ratio)this.start=this._dist+p*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+p*m[0].ratio;for(var x=0;x<m.length;x++)this._lineTo(m[x].x,m[x].y,!0)}this._lineTo(y.x,y.y,!1)}}this._dist+=p,this._prevIsIn=d,this._prevPt=h},e.prototype.close=function(){if(this.line.length>2){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var r=this.line,i=r.length;i>=4&&(r[0].x===r[1].x&&r[0].x===r[i-2].x||r[0].y===r[1].y&&r[0].y===r[i-2].y);)r.pop(),r[0].x=r[i-2].x,r[0].y=r[i-2].y,--i}},e.prototype.result=function(e){return void 0===e&&(e=!0),this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&s.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)},e.prototype.resultWithStarts=function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var r=[],i=0;i<t;i++)r.push({line:e[i],start:this.starts[i]||0});return r},e.prototype._isIn=function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax},e.prototype._intersect=function(e,t){var i,n,o;if(t.x>=this.xmin&&t.x<=this.xmax)o=((n=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),i=e.x+o*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)o=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),n=e.y+o*(t.y-e.y);else{n=t.y<=this.ymin?this.ymin:this.ymax;var a=((i=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),s=(n-e.y)/(t.y-e.y);a<s?(o=a,n=e.y+a*(t.y-e.y)):(o=s,i=e.x+s*(t.x-e.x))}return this._r=o,new r.Point(i,n)},e.prototype._pushLine=function(){this.line&&(1===this.type?this.line.length>0&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?this.line.length>1&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&this.line.length>3&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0},e.prototype._moveTo=function(e,t,i){3!==this.type?i&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new r.Point(e,t))):(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new r.Point(e,t)),this._is_h=!1,this._is_v=!1)},e.prototype._lineTo=function(e,t,i){var n,o;if(3!==this.type)if(i){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.length>0&&(n=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new r.Point(e,t))}else this.line&&this.line.length>0&&this._pushLine();else if(i||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&this.line.length>0){var a=(n=this.line[this.line.length-1]).x===e,s=n.y===t;if(a&&s)return;this._is_h&&a?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):this._is_v&&s?(n.x=e,n.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):(this.line.push(new r.Point(e,t)),this._is_h=a,this._is_v=s)}else this.line.push(new r.Point(e,t))},e}();t.TileClipper=o;var a=function(){function e(){}return e.prototype.setExtent=function(e){this._ratio=4096===e?1:4096/e},e.prototype.reset=function(e){this.type=e,this.lines=[],this.line=null},e.prototype.moveTo=function(e,t){this.line&&this.lines.push(this.line),this.line=[];var i=this._ratio;this.line.push(new r.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.lineTo=function(e,t){var i=this._ratio;this.line.push(new r.Point(Math.round(e*i),Math.round(t*i)))},e.prototype.close=function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])},e.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&s.simplify(4096,64,this.lines),this.lines)},e}();t.SimpleBuilder=a;var s=function(){function e(){}return e.simplify=function(t,r,i){if(i){for(var n=-r,o=t+r,a=-r,s=t+r,l=[],u=[],c=i.length,f=0;f<c;++f){var d=i[f];if(d&&!(d.length<2))for(var h=d[0],p=void 0,v=d.length,y=1;y<v;++y)p=d[y],h.x===p.x&&(h.x<=n&&(h.y>p.y?(l.push(f),l.push(y),l.push(0),l.push(-1)):(u.push(f),u.push(y),u.push(0),u.push(-1))),h.x>=o&&(h.y<p.y?(l.push(f),l.push(y),l.push(1),l.push(-1)):(u.push(f),u.push(y),u.push(1),u.push(-1)))),h.y===p.y&&(h.y<=a&&(h.x<p.x?(l.push(f),l.push(y),l.push(2),l.push(-1)):(u.push(f),u.push(y),u.push(2),u.push(-1))),h.y>=s&&(h.x>p.x?(l.push(f),l.push(y),l.push(3),l.push(-1)):(u.push(f),u.push(y),u.push(3),u.push(-1)))),h=p}if(0!==l.length&&0!==u.length){e.fillParent(i,u,l),e.fillParent(i,l,u);var m=[];e.calcDeltas(m,u,l),e.calcDeltas(m,l,u),e.addDeltas(m,i)}}},e.fillParent=function(e,t,r){for(var n=r.length,o=t.length,a=0;a<o;a+=4){for(var s=t[a],l=t[a+1],u=t[a+2],c=e[s][l-1],f=e[s][l],d=8092,h=-1,p=0;p<n;p+=4)if(r[p+2]===u){var v=r[p],y=r[p+1],m=e[v][y-1],x=e[v][y];switch(u){case 0:case 1:if(i.between(c.y,m.y,x.y)&&i.between(f.y,m.y,x.y))(g=Math.abs(x.y-m.y))<d&&(d=g,h=p);break;case 2:case 3:var g;if(i.between(c.x,m.x,x.x)&&i.between(f.x,m.x,x.x))(g=Math.abs(x.x-m.x))<d&&(d=g,h=p)}}t[a+3]=h}},e.calcDeltas=function(t,r,i){for(var n=r.length,o=0;o<n;o+=4){var a=e.calcDelta(o,r,i,[]);t.push(r[o]),t.push(r[o+1]),t.push(r[o+2]),t.push(a)}},e.calcDelta=function(t,r,i,n){var o=r[t+3];if(-1===o)return 0;var a=n.length;return a>1&&n[a-2]===o?0:(n.push(o),e.calcDelta(o,i,r,n)+1)},e.addDeltas=function(e,t){for(var r=e.length,i=0,n=0;n<r;n+=4){(s=e[n+3])>i&&(i=s)}for(n=0;n<r;n+=4){var o=t[e[n]],a=e[n+1],s=i-e[n+3];switch(e[n+2]){case 0:o[a-1].x-=s,o[a].x-=s,1===a&&(o[o.length-1].x-=s),a===o.length-1&&(o[0].x-=s);break;case 1:o[a-1].x+=s,o[a].x+=s,1===a&&(o[o.length-1].x+=s),a===o.length-1&&(o[0].x+=s);break;case 2:o[a-1].y-=s,o[a].y-=s,1===a&&(o[o.length-1].y-=s),a===o.length-1&&(o[0].y-=s);break;case 3:o[a-1].y+=s,o[a].y+=s,1===a&&(o[o.length-1].y+=s),a===o.length-1&&(o[0].y+=s)}}},e}()}.apply(null,i))||(e.exports=n)},1526:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(2),r(1),r(5),r(0),r(1473),r(250),r(1620)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-class-breaks",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.colorClassBreakInfos=null,r}var c;return i(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:o.clone(this.colorClassBreakInfos),legendOptions:o.clone(this.legendOptions)}))},n([a.property()],t.prototype,"type",void 0),n([a.property({json:{write:!0},type:String})],t.prototype,"field",void 0),n([a.property({type:l.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),n([a.property({json:{read:s.fieldTransformTypeKebabDict.read,write:s.fieldTransformTypeKebabDict.write},type:String})],t.prototype,"fieldTransformType",void 0),n([a.property({type:[u.default],json:{write:!0}})],t.prototype,"colorClassBreakInfos",void 0),c=n([a.subclass("esri.renderers.PointCloudClassBreaksRenderer")],t)}(a.declared(s))}.apply(null,i))||(e.exports=n)},1527:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(0),r(1501)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="fixed-size",t.size=0,t.useRealWorldSymbolSizes=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})},i([n.property()],t.prototype,"type",void 0),i([n.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"size",void 0),i([n.property({type:Boolean,json:{write:!0}})],t.prototype,"useRealWorldSymbolSizes",void 0),o=i([n.subclass("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],t)}(n.declared(o.default));t.PointSizeFixedSizeAlgorithm=a,t.default=a}.apply(null,i))||(e.exports=n)},1528:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(0),r(1501)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="splat",t.scaleFactor=1,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({scaleFactor:this.scaleFactor})},i([n.property()],t.prototype,"type",void 0),i([n.property({type:Number,value:1,nonNullable:!0,json:{write:!0}})],t.prototype,"scaleFactor",void 0),o=i([n.subclass("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],t)}(n.declared(o.default));t.PointSizeSplatAlgorithm=a,t.default=a}.apply(null,i))||(e.exports=n)},1529:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(2),r(1),r(5),r(0),r(1473),r(250),r(1621)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-stretch",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.stops=null,r}var c;return i(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),stops:o.clone(this.stops),legendOptions:o.clone(this.legendOptions)}))},n([a.property()],t.prototype,"type",void 0),n([a.property({json:{write:!0},type:String})],t.prototype,"field",void 0),n([a.property({type:l.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),n([a.property({json:{read:s.fieldTransformTypeKebabDict.read,write:s.fieldTransformTypeKebabDict.write},type:String})],t.prototype,"fieldTransformType",void 0),n([a.property({type:[u.default],json:{write:!0}})],t.prototype,"stops",void 0),c=n([a.subclass("esri.renderers.PointCloudStretchRenderer")],t)}(a.declared(s))}.apply(null,i))||(e.exports=n)},1530:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(2),r(1),r(5),r(0),r(1473),r(250),r(1622)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-unique-value",r.field=null,r.fieldTransformType=null,r.colorUniqueValueInfos=null,r.legendOptions=null,r}var c;return i(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),colorUniqueValueInfos:o.clone(this.colorUniqueValueInfos),legendOptions:o.clone(this.legendOptions)}))},n([a.property()],t.prototype,"type",void 0),n([a.property({json:{write:!0},type:String})],t.prototype,"field",void 0),n([a.property({json:{read:s.fieldTransformTypeKebabDict.read,write:s.fieldTransformTypeKebabDict.write},type:String})],t.prototype,"fieldTransformType",void 0),n([a.property({type:[u.default],json:{write:!0}})],t.prototype,"colorUniqueValueInfos",void 0),n([a.property({type:l.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),c=n([a.subclass("esri.renderers.PointCloudUniqueValueRenderer")],t)}(a.declared(s))}.apply(null,i))||(e.exports=n)},1531:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(1625),r(1626),r(1627)],void 0===(n=function(e,t,r,i,n,o,a){Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t,r){switch(this.type=e,this.id=t.id,this.source=t.source,this.sourceLayer=t["source-layer"],this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,this.filter=t.filter,this.layout=t.layout,this.paint=t.paint,this.z=r,e){case 0:this._layoutDefinition=o.StyleDefinition.backgroundLayoutDefinition,this._paintDefinition=o.StyleDefinition.backgroundPaintDefinition;break;case 1:this._layoutDefinition=o.StyleDefinition.fillLayoutDefinition,this._paintDefinition=o.StyleDefinition.fillPaintDefinition;break;case 2:this._layoutDefinition=o.StyleDefinition.lineLayoutDefinition,this._paintDefinition=o.StyleDefinition.linePaintDefinition;break;case 3:this._layoutDefinition=o.StyleDefinition.symbolLayoutDefinition,this._paintDefinition=o.StyleDefinition.symbolPaintDefinition;break;case 4:this._layoutDefinition=o.StyleDefinition.circleLayoutDefinition,this._paintDefinition=o.StyleDefinition.circlePaintDefinition}this._layoutProperties=this._parseLayout(this.layout),this._paintProperties=this._parsePaint(this.paint)}return e.prototype.getFeatureFilter=function(){return void 0!==this._featureFilter?this._featureFilter:this._featureFilter=n.createFilter(this.filter)},e.prototype.getLayoutProperty=function(e){var t=this._layoutProperties;if(t)return t[e]},e.prototype.getPaintProperty=function(e){var t=this._paintProperties;if(t)return t[e]},e.prototype.getLayoutValue=function(e,t,r){var i,n=this._layoutProperties;if(n){var o=n[e];o&&(i=o.getValue(t,r))}var a=this._layoutDefinition[e];return void 0===i&&(i=a.default),"enum"===a.type&&(i=a.values.indexOf(i)),i},e.prototype.getPaintValue=function(e,t,r){var i,n=this._paintProperties;if(n){var o=n[e];o&&(i=o.getValue(t,r))}var a=this._paintDefinition[e];return void 0===i&&(i=a.default),"enum"===a.type&&(i=a.values.indexOf(i)),i},e.prototype._parseLayout=function(e){var t={};for(var r in e){var i=this._layoutDefinition[r];i&&(t[r]=new a(r,i,e[r]))}return t},e.prototype._parsePaint=function(e){var t={};for(var r in e){var i=this._paintDefinition[r];i&&(t[r]=new a(r,i,e[r]))}return t},e}();t.StyleLayer=s;var l=function(e){function t(t,r,i){return e.call(this,t,r,i)||this}return r(t,e),t}(s);t.BackgroundStyleLayer=l;var u=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this,o=n.getPaintProperty("fill-color");n.hasDataDrivenColor=!!o&&o.isDataDriven;var a=n.getPaintProperty("fill-opacity");n.hasDataDrivenOpacity=!!a&&a.isDataDriven,n.hasDataDrivenFill=n.hasDataDrivenColor||n.hasDataDrivenOpacity;var s=n.getPaintProperty("fill-outline-color");return n.outlineUsesFillColor=!s,n.hasDataDrivenOutlineColor=!!s&&s.isDataDriven,n.hasDataDrivenOutline=(s?n.hasDataDrivenOutlineColor:n.hasDataDrivenColor)||n.hasDataDrivenOpacity,n}return r(t,e),t}(s);t.FillStyleLayer=u;var c=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this,o=n.getPaintProperty("line-color");n.hasDataDrivenColor=!!o&&o.isDataDriven;var a=n.getPaintProperty("line-opacity");n.hasDataDrivenOpacity=!!a&&a.isDataDriven;var s=n.getPaintProperty("line-width");return n.hasDataDrivenWidth=!!s&&s.isDataDriven,n.hasDataDrivenLine=n.hasDataDrivenColor||n.hasDataDrivenOpacity||n.hasDataDrivenWidth,n}return r(t,e),t}(s);t.LineStyleLayer=c;var f=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this,o=n.getPaintProperty("icon-color");n.hasDataDrivenIconColor=!!o&&o.isDataDriven;var a=n.getPaintProperty("icon-opacity");n.hasDataDrivenIconOpacity=!!a&&a.isDataDriven;var s=n.getLayoutProperty("icon-size");n.hasDataDrivenIconSize=!!s&&s.isDataDriven,n.hasDataDrivenIcon=n.hasDataDrivenIconColor||n.hasDataDrivenIconOpacity||n.hasDataDrivenIconSize;var l=n.getPaintProperty("text-color");n.hasDataDrivenTextColor=!!l&&l.isDataDriven;var u=n.getPaintProperty("text-opacity");n.hasDataDrivenTextOpacity=!!u&&u.isDataDriven;var c=n.getLayoutProperty("text-size");return n.hasDataDrivenTextSize=!!c&&c.isDataDriven,n.hasDataDrivenText=n.hasDataDrivenTextColor||n.hasDataDrivenTextOpacity||n.hasDataDrivenTextSize,n}return r(t,e),t}(s);t.SymbolStyleLayer=f;var d=function(e){function t(t,r,i){var n=e.call(this,t,r,i)||this,o=n.getPaintProperty("circle-radius");n.hasDataDrivenRadius=!!o&&o.isDataDriven;var a=n.getPaintProperty("circle-color");n.hasDataDrivenColor=!!a&&a.isDataDriven;var s=n.getPaintProperty("circle-opacity");n.hasDataDrivenOpacity=!!s&&s.isDataDriven;var l=n.getPaintProperty("circle-stroke-width");n.hasDataDrivenStrokeWidth=!!l&&l.isDataDriven;var u=n.getPaintProperty("circle-stroke-color");n.hasDataDrivenStrokeColor=!!u&&u.isDataDriven;var c=n.getPaintProperty("circle-stroke-opacity");n.hasDataDrivenStrokeOpacity=!!c&&c.isDataDriven;var f=n.getPaintProperty("circle-blur");return n.hasDataDrivenBlur=!!f&&f.isDataDriven,n}return r(t,e),t}(s);t.CircleStyleLayer=d;var h=function(){return function(e,t,r){this.cap=e.getLayoutValue("line-cap",t,r),this.join=e.getLayoutValue("line-join",t,r),this.miterLimit=e.getLayoutValue("line-miter-limit",t,r),this.roundLimit=e.getLayoutValue("line-round-limit",t,r)}}();t.LineLayout=h;var p=function(){return function(e,t,r,i){this.allowOverlap=e.getLayoutValue("icon-allow-overlap",t,i),this.ignorePlacement=e.getLayoutValue("icon-ignore-placement",t,i),this.optional=e.getLayoutValue("icon-optional",t,i),this.rotationAlignment=e.getLayoutValue("icon-rotation-alignment",t,i),this.size=e.getLayoutValue("icon-size",t,i),this.rotate=e.getLayoutValue("icon-rotate",t,i),this.padding=e.getLayoutValue("icon-padding",t,i),this.keepUpright=e.getLayoutValue("icon-keep-upright",t,i),this.offset=e.getLayoutValue("icon-offset",t,i),2===this.rotationAlignment&&(this.rotationAlignment=r?0:1)}}();t.IconLayout=p;var v=function(){return function(e,t,r,i){this.allowOverlap=e.getLayoutValue("text-allow-overlap",t,i),this.ignorePlacement=e.getLayoutValue("text-ignore-placement",t,i),this.optional=e.getLayoutValue("text-optional",t,i),this.rotationAlignment=e.getLayoutValue("text-rotation-alignment",t,i),this.fontArray=e.getLayoutValue("text-font",t,i),this.maxWidth=e.getLayoutValue("text-max-width",t,i),this.lineHeight=e.getLayoutValue("text-line-height",t,i),this.letterSpacing=e.getLayoutValue("text-letter-spacing",t,i),this.justify=e.getLayoutValue("text-justify",t,i),this.anchor=e.getLayoutValue("text-anchor",t,i),this.maxAngle=e.getLayoutValue("text-max-angle",t,i),this.size=e.getLayoutValue("text-size",t,i),this.rotate=e.getLayoutValue("text-rotate",t,i),this.padding=e.getLayoutValue("text-padding",t,i),this.keepUpright=e.getLayoutValue("text-keep-upright",t,i),this.transform=e.getLayoutValue("text-transform",t,i),this.offset=e.getLayoutValue("text-offset",t,i),2===this.rotationAlignment&&(this.rotationAlignment=r?0:1)}}();t.TextLayout=v}.apply(null,i))||(e.exports=n)},1536:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e,t){this.layerExtent=4096,this._features=[],this.layer=e,this.zoom=t,this._filter=e.getFeatureFilter()}return e.prototype.pushFeature=function(e){this._filter.filter(e)&&this._features.push(e)},e.prototype.hasFeatures=function(){return this._features.length>0},e.prototype.processFeatures=function(e,t){},e.prototype.assignBufferInfo=function(e){},e}()}.apply(null,i))||(e.exports=n)},1605:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(e){this._array=[],e<=0&&console.error("strideInBytes must be positive!"),this._stride=e}return Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.array.length=0},e.prototype.toBuffer=function(){return new Uint32Array(this._array).buffer},e.i1616to32=function(e,t){return 65535&e|t<<16},e.i8888to32=function(e,t,r,i){return 255&e|(255&t)<<8|(255&r)<<16|i<<24},e.i8816to32=function(e,t,r){return 255&e|(255&t)<<8|r<<16},e}()}.apply(null,i))||(e.exports=n)},1606:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){function r(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push(void 0);return r}function i(e,t){b.vector[0]=e.vector[0],b.vector[1]=e.vector[1],b.texCoords[0]=e.texCoords[0],b.texCoords[1]=e.texCoords[1],b.direction[0]=e.direction[0],b.direction[1]=e.direction[1],b.base=e.base,e.vector[0]=t.vector[0],e.vector[1]=t.vector[1],e.texCoords[0]=t.texCoords[0],e.texCoords[1]=t.texCoords[1],e.direction[0]=t.direction[0],e.direction[1]=t.direction[1],e.base=t.base,t.vector[0]=b.vector[0],t.vector[1]=b.vector[1],t.texCoords[0]=b.texCoords[0],t.texCoords[1]=b.texCoords[1],t.direction[0]=b.direction[0],t.direction[1]=b.direction[1],t.base=b.base}function n(e,t){return e[0]*t[0]+e[1]*t[1]}function o(e){return Math.sqrt(n(e,e))}function a(e,t){var r=o(t);return e[0]=t[0]/r,e[1]=t[1]/r,e}function s(e,t){return e[0]=-t[1],e[1]=t[0],e}function l(e,t){return e[0]*t[1]-e[1]*t[0]}function u(e,t){return e[0]=-t[0],e[1]=-t[1],e}function c(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function f(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function d(e,t,r){return function(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(r[0]-e[0])*(t[1]-e[1])}(e,t,r)<0}function h(e,t){var r=n(e,t);return r>.999?0:r<-.999?Math.PI:Math.acos(r)}function p(e,t,r,i,n){if(0!==i){var a,s=o(t),l=h(c(I[0],t,1/s),c(I[1],r,1/s)),u=(n?-1:1)*l/i,f=Math.cos(u),d=Math.sin(u),p=t[0],v=t[1];for(a=0;a<i-1;++a){var y=p;p=f*y-d*v,v=d*y+f*v,e.items[a][0]=p,e.items[a][1]=v}e.count=i-1}else e.count=0}function v(e){var t,r=e.count,i=Math.floor(r/2);for(t=0;t<i;++t){var n=e.items[t];e.items[t]=e.items[r-t-1],e.items[r-t-1]=n}}var y,m;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ENTRY=1]="ENTRY",e[e.EXIT=2]="EXIT",e[e.CAP=3]="CAP"}(y=t.VectorRole||(t.VectorRole={})),function(e){e[e.START=1]="START",e[e.END=2]="END"}(m=t.CapPosition||(t.CapPosition={})),t.SYSTEM_MAG_LIMIT=3.8,t.MITER_SAFE_RADS=2*Math.acos(1/t.SYSTEM_MAG_LIMIT);var x=t.SYSTEM_MAG_LIMIT*t.SYSTEM_MAG_LIMIT,g=16/(2*Math.PI);t.allocTriangles=function(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return r},t.allocExtrudeVectors=function(){var e=function(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return r}(30),t={};return t[y.ENTRY]=r(20),t[y.EXIT]=r(20),t[y.CAP]=r(20),{vectors:e,lists:t}},t.copyExtrudeVectors=function(e,t){var r;for(r=0;r<t.vectors.count;++r)e.vectors.items[r].vector[0]=t.vectors.items[r].vector[0],e.vectors.items[r].vector[1]=t.vectors.items[r].vector[1],e.vectors.items[r].texCoords[0]=t.vectors.items[r].texCoords[0],e.vectors.items[r].texCoords[1]=t.vectors.items[r].texCoords[1],e.vectors.items[r].direction[0]=t.vectors.items[r].direction[0],e.vectors.items[r].direction[1]=t.vectors.items[r].direction[1],e.vectors.items[r].base=t.vectors.items[r].base;e.vectors.count=t.vectors.count;var i=t.lists[y.ENTRY],n=e.lists[y.ENTRY],o=t.lists[y.EXIT],a=e.lists[y.EXIT],s=t.lists[y.CAP],l=e.lists[y.CAP];for(r=0;r<i.count;++r)n.items[r]=i.items[r];for(n.count=i.count,r=0;r<o.count;++r)a.items[r]=o.items[r];for(a.count=o.count,r=0;r<s.count;++r)l.items[r]=s.items[r];l.count=s.count,e.capCenter=t.capCenter};var b={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};t.swapExtrudeVectors=i;var _,I=[];for(_=0;_<32;++_)I.push([void 0,void 0]);var w=function(e){var t,r={items:new Array,count:0};for(t=0;t<16;++t)r.items.push([void 0,void 0]);return r}();t.length=o,t.normalize=a,t.getNumberOfSlices=function(e){return Math.max(Math.round(e*g),1)},t.getRads=h,t.reverse=v;var C=[void 0,void 0],D=[void 0,void 0],T=[0,0],P=[0,0],S=[0,0],M=[0,0],B=Math.cos(Math.PI/4),V=Math.sin(Math.PI/4),A=Math.sqrt(2),E=function(){function e(e){this._distanceAlongCorrection=e.distanceAlongCorrection}return e.prototype.bridge=function(e,t,r){var n,o,a,s,l=t.vectors,u=t.lists[y.EXIT],c=r.vectors,f=r.lists[y.ENTRY];if(u.count===f.count+1)n=u.items,o=l.items,a=f.items,s=c.items;else if(f.count===u.count+1)n=f.items,o=c.items,a=u.items,s=l.items;else{if(u.count!==f.count)return console.error("Cannot bridge "+u.count+" to "+f.count+"."),void(e.count=0);n=f.items,o=c.items,a=u.items,s=l.items}var h,p=u.count+f.count-2;for(e.count=p,C[0]=n,C[1]=a,D[0]=o,D[1]=s,h=0;h<p;++h){var v=e.items[h],m=(h+0)%2,x=Math.floor((h+0)/2),g=D[m][C[m][x]];v.v1.vector[0]=g.vector[0],v.v1.vector[1]=g.vector[1],v.v1.texCoords[0]=g.texCoords[0],v.v1.texCoords[1]=g.texCoords[1],v.v1.direction[0]=g.direction[0],v.v1.direction[1]=g.direction[1],v.v1.base=g.base;var b=(h+1)%2,_=Math.floor((h+1)/2),I=D[b][C[b][_]];v.v2.vector[0]=I.vector[0],v.v2.vector[1]=I.vector[1],v.v2.texCoords[0]=I.texCoords[0],v.v2.texCoords[1]=I.texCoords[1],v.v2.direction[0]=I.direction[0],v.v2.direction[1]=I.direction[1],v.v2.base=I.base;var w=(h+2)%2,B=Math.floor((h+2)/2),V=D[w][C[w][B]];v.v3.vector[0]=V.vector[0],v.v3.vector[1]=V.vector[1],v.v3.texCoords[0]=V.texCoords[0],v.v3.texCoords[1]=V.texCoords[1],v.v3.direction[0]=V.direction[0],v.v3.direction[1]=V.direction[1],v.v3.base=V.base;var A=v.v1.base&&v.v1.base.point||T,E=v.v2.base&&v.v2.base.point||T,z=v.v3.base&&v.v3.base.point||T;P[0]=A[0]+v.v1.vector[0],P[1]=A[1]+v.v1.vector[1],S[0]=E[0]+v.v2.vector[0],S[1]=E[1]+v.v2.vector[1],M[0]=z[0]+v.v3.vector[0],M[1]=z[1]+v.v3.vector[1],d(P,S,M)||i(v.v2,v.v3)}},e.prototype.pie=function(e,t){if(0!==t.lists[y.CAP].count){if(1===t.lists[y.CAP].count)return console.error("A single vector is not enough to define a pie."),void(e.count=0);var r;for(e.count=t.lists[y.CAP].count-1,r=0;r<e.count;++r){var n=e.items[r],o=t.lists[y.CAP].items[r],a=t.vectors.items[o];n.v1.vector[0]=a.vector[0],n.v1.vector[1]=a.vector[1],n.v1.texCoords[0]=a.texCoords[0],n.v1.texCoords[1]=a.texCoords[1],n.v1.direction[0]=a.direction[0],n.v1.direction[1]=a.direction[1],n.v1.base=a.base;var s=t.lists[y.CAP].items[r+1],l=t.vectors.items[s];n.v2.vector[0]=l.vector[0],n.v2.vector[1]=l.vector[1],n.v2.texCoords[0]=l.texCoords[0],n.v2.texCoords[1]=l.texCoords[1],n.v2.direction[0]=l.direction[0],n.v2.direction[1]=l.direction[1],n.v2.base=l.base;var u=t.capCenter,c=t.vectors.items[u];n.v3.vector[0]=c.vector[0],n.v3.vector[1]=c.vector[1],n.v3.texCoords[0]=c.texCoords[0],n.v3.texCoords[1]=c.texCoords[1],n.v3.direction[0]=c.direction[0],n.v3.direction[1]=c.direction[1],n.v3.base=c.base;var f=n.v1.base&&n.v1.base.point||T,h=n.v2.base&&n.v2.base.point||T,p=n.v3.base&&n.v3.base.point||T;P[0]=f[0]+n.v1.vector[0],P[1]=f[1]+n.v1.vector[1],S[0]=h[0]+n.v2.vector[0],S[1]=h[1]+n.v2.vector[1],M[0]=p[0]+n.v3.vector[0],M[1]=p[1]+n.v3.vector[1],d(P,S,M)||i(n.v2,n.v3)}}else e.count=0},e.prototype.buttCap=function(e,t,r){this.fastMiterJoin(e,t,r)},e.prototype.roundCap=function(e,t,r,i,n,o){void 0===o&&(o=0),this.fastMiterJoin(e,t,r);var a=i===m.START?0:1,s=i===m.START?1:0;e.capCenter=e.vectors.count;var l=e.vectors.items[e.capCenter];l.vector[0]=0,l.vector[1]=0,l.texCoords[0]=0,l.texCoords[1]=0,l.direction[0]=0,l.direction[1]=0,++e.vectors.count,p(w,e.vectors.items[a].vector,e.vectors.items[s].vector,n,!1);var u=e.vectors.count,c=e.lists[y.CAP];c.items[0]=a;var f,d=e.vectors.items[a].texCoords[1],h=e.vectors.items[s].texCoords[1];for(f=0;f<w.count;++f){var v=o*(1-Math.abs(w.count/2-f)/(w.count/2)),x=d+f/(w.count-1)*(h-d),g=w.items[f],b=e.vectors.items[u+f];b.vector[0]=g[0],b.vector[1]=g[1],b.texCoords[0]=v,b.texCoords[1]=x,b.direction[0]=0,b.direction[1]=0,c.items[f+1]=u+f}c.items[w.count+1]=s,c.count=w.count+2,e.vectors.count=u+w.count},e.prototype.squareCap=function(e,t,r,i){this.fastMiterJoin(e,t,r);var n=i===m.START?0:1,o=i===m.START?1:0,a=I[0],s=I[1],l=I[2],u=I[3],f=I[4],d=e.vectors.items[n].vector;a[0]=B*d[0]-V*d[1],a[1]=V*d[0]+B*d[1],c(u,a,A),s[0]=B*a[0]-V*a[1],s[1]=V*a[0]+B*a[1],l[0]=B*s[0]-V*s[1],l[1]=V*s[0]+B*s[1],c(f,l,A);var h=e.vectors.items[n];h.vector[0]=u[0],h.vector[1]=u[1];var p=e.vectors.items[o];p.vector[0]=f[0],p.vector[1]=f[1]},e.prototype.fastMiterJoin=function(e,t,r){var i=s(I[0],r),n=i,o=u(I[1],i),a=e.vectors.items[0];a.vector[0]=n[0],a.vector[1]=n[1],a.texCoords[0]=0,a.texCoords[1]=-1,a.direction[0]=0,a.direction[1]=0;var l=e.vectors.items[1];l.vector[0]=o[0],l.vector[1]=o[1],l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0,e.vectors.count=2;var c=e.lists[y.ENTRY];c.items[0]=0,c.items[1]=1,c.count=2;var f=e.lists[y.EXIT];f.items[0]=0,f.items[1]=1,f.count=2,e.lists[y.CAP].count=0,e.capCenter=void 0},e.prototype.miterJoin=function(e,t,r){var i=s(I[0],t),o=s(I[1],r),l=I[2];l[0]=i[0]+o[0],l[1]=i[1]+o[1];var f=a(I[3],l),d=n(f,i);f=c(I[4],f,1/d);var h=u(I[5],f);if(this._distanceAlongCorrection){(m=e.vectors.items[0]).vector[0]=f[0],m.vector[1]=f[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=t[0],m.direction[1]=t[1],(x=e.vectors.items[1]).vector[0]=h[0],x.vector[1]=h[1],x.texCoords[0]=0,x.texCoords[1]=1,x.direction[0]=t[0],x.direction[1]=t[1];var p=e.vectors.items[2];p.vector[0]=f[0],p.vector[1]=f[1],p.texCoords[0]=0,p.texCoords[1]=-1,p.direction[0]=r[0],p.direction[1]=r[1];var v=e.vectors.items[3];v.vector[0]=h[0],v.vector[1]=h[1],v.texCoords[0]=0,v.texCoords[1]=1,v.direction[0]=r[0],v.direction[1]=r[1],e.vectors.count=4,(g=e.lists[y.ENTRY]).items[0]=0,g.items[1]=1,g.count=2,(b=e.lists[y.EXIT]).items[0]=2,b.items[1]=3,b.count=2}else{var m,x,g,b;(m=e.vectors.items[0]).vector[0]=f[0],m.vector[1]=f[1],m.texCoords[0]=0,m.texCoords[1]=-1,m.direction[0]=0,m.direction[1]=0,(x=e.vectors.items[1]).vector[0]=h[0],x.vector[1]=h[1],x.texCoords[0]=0,x.texCoords[1]=1,x.direction[0]=0,x.direction[1]=0,e.vectors.count=2,(g=e.lists[y.ENTRY]).items[0]=0,g.items[1]=1,g.count=2,(b=e.lists[y.EXIT]).items[0]=0,b.items[1]=1,b.count=2}e.lists[y.CAP].count=0,e.capCenter=void 0},e.prototype.bevelJoin=function(e,t,r,i){var o=i*i,d=l(t,r),h=d>0?[-1,1]:[1,-1],p=h[0],m=h[1],g=d>0?u(I[0],s(I[1],t)):s(I[2],t),b=d>0?u(I[3],s(I[4],r)):s(I[5],r),_=I[6];_[0]=g[0]+b[0],_[1]=g[1]+b[1];var w=a(I[7],_),C=u(I[8],w),D=n(w,g),T=l(w,g),P=Math.abs(T/D),S=1+P*P,M=S<x?[P,this._distanceAlongCorrection]:[Math.sqrt(x-1),!0],B=M[0],V=M[1],A=S<o?[P,this._distanceAlongCorrection]:[Math.sqrt(o-1),!0],E=A[0],z=A[1];if(z&&V){f((k=e.vectors.items[0]).vector,u(I[9],g),c(I[10],u(I[11],t),B)),k.texCoords[0]=0,k.texCoords[1]=p,k.direction[0]=this._distanceAlongCorrection?t[0]:0,k.direction[1]=this._distanceAlongCorrection?t[1]:0,f((F=e.vectors.items[1]).vector,u(I[12],b),c(I[13],r,B)),F.texCoords[0]=0,F.texCoords[1]=p,F.direction[0]=this._distanceAlongCorrection?r[0]:0,F.direction[1]=this._distanceAlongCorrection?r[1]:0,(L=e.vectors.items[2]).vector[0]=0,L.vector[1]=0,L.texCoords[0]=0,L.texCoords[1]=0,L.direction[0]=0,L.direction[1]=0,f((N=e.vectors.items[3]).vector,g,c(I[14],t,E)),N.texCoords[0]=0,N.texCoords[1]=m,N.direction[0]=this._distanceAlongCorrection?t[0]:0,N.direction[1]=this._distanceAlongCorrection?t[1]:0;var O=e.vectors.items[4];if(f(O.vector,b,c(I[15],u(I[16],r),E)),O.texCoords[0]=0,O.texCoords[1]=m,O.direction[0]=this._distanceAlongCorrection?r[0]:0,O.direction[1]=this._distanceAlongCorrection?r[1]:0,e.vectors.count=5,(R=e.lists[y.ENTRY]).items[0]=0,R.items[1]=2,R.items[2]=3,R.count=3,(U=e.lists[y.EXIT]).items[0]=1,U.items[1]=2,U.items[2]=4,U.count=3,S<o)(j=e.lists[y.CAP]).count=0,e.capCenter=void 0;else(j=e.lists[y.CAP]).items[0]=3,j.items[1]=4,j.count=2,e.capCenter=2}else if(!z&&V){f((k=e.vectors.items[0]).vector,u(I[9],g),c(I[10],u(I[11],t),B)),k.texCoords[0]=0,k.texCoords[1]=p,k.direction[0]=this._distanceAlongCorrection?t[0]:0,k.direction[1]=this._distanceAlongCorrection?t[1]:0,f((F=e.vectors.items[1]).vector,u(I[12],b),c(I[13],r,B)),F.texCoords[0]=0,F.texCoords[1]=p,F.direction[0]=this._distanceAlongCorrection?r[0]:0,F.direction[1]=this._distanceAlongCorrection?r[1]:0,(L=e.vectors.items[2]).vector[0]=0,L.vector[1]=0,L.texCoords[0]=0,L.texCoords[1]=0,L.direction[0]=0,L.direction[1]=0,c((N=e.vectors.items[3]).vector,w,1/D),N.texCoords[0]=0,N.texCoords[1]=m,N.direction[0]=0,N.direction[1]=0,e.vectors.count=4,(R=e.lists[y.ENTRY]).items[0]=0,R.items[1]=2,R.items[2]=3,R.count=3,(U=e.lists[y.EXIT]).items[0]=1,U.items[1]=2,U.items[2]=3,U.count=3,e.lists[y.CAP].count=0,e.capCenter=void 0}else if(z&&!V){var L,N,j;if(c((k=e.vectors.items[0]).vector,C,1/D),k.texCoords[0]=0,k.texCoords[1]=p,k.direction[0]=0,k.direction[1]=0,(F=e.vectors.items[1]).vector[0]=0,F.vector[1]=0,F.texCoords[0]=0,F.texCoords[1]=0,F.direction[0]=0,F.direction[1]=0,f((L=e.vectors.items[2]).vector,g,c(I[9],t,E)),L.texCoords[0]=0,L.texCoords[1]=m,L.direction[0]=this._distanceAlongCorrection?t[0]:0,L.direction[1]=this._distanceAlongCorrection?t[1]:0,f((N=e.vectors.items[3]).vector,b,c(I[10],u(I[11],r),E)),N.texCoords[0]=0,N.texCoords[1]=m,N.direction[0]=this._distanceAlongCorrection?r[0]:0,N.direction[1]=this._distanceAlongCorrection?r[1]:0,e.vectors.count=4,(R=e.lists[y.ENTRY]).items[0]=0,R.items[1]=1,R.items[2]=2,R.count=3,(U=e.lists[y.EXIT]).items[0]=0,U.items[1]=1,U.items[2]=3,U.count=3,S<o)(j=e.lists[y.CAP]).count=0,e.capCenter=void 0;else(j=e.lists[y.CAP]).items[0]=2,j.items[1]=3,j.count=2,e.capCenter=1}else if(!z&&!V){var k,F,R,U;c((k=e.vectors.items[0]).vector,C,1/D),k.texCoords[0]=0,k.texCoords[1]=p,k.direction[0]=0,k.direction[1]=0,c((F=e.vectors.items[1]).vector,w,1/D),F.texCoords[0]=0,F.texCoords[1]=m,F.direction[0]=0,F.direction[1]=0,e.vectors.count=2,(R=e.lists[y.ENTRY]).items[0]=0,R.items[1]=1,R.count=2,(U=e.lists[y.EXIT]).items[0]=0,U.items[1]=1,U.count=2,e.lists[y.CAP].count=0,e.capCenter=void 0}d<0&&(v(e.lists[y.ENTRY]),v(e.lists[y.EXIT]))},e.prototype.roundJoin=function(e,t,r,i){var o=l(t,r),d=o>0?[-1,1]:[1,-1],h=d[0],m=d[1],g=o>0?u(I[0],s(I[1],t)):s(I[2],t),b=o>0?u(I[3],s(I[4],r)):s(I[5],r),_=I[6];_[0]=g[0]+b[0],_[1]=g[1]+b[1];var C=a(I[7],_),D=u(I[8],C),T=n(C,g),P=l(C,g),S=Math.abs(P/T),M=1+S*S<x?[S,this._distanceAlongCorrection]:[Math.sqrt(x-1),!0],B=M[0];if(M[1]){(A=e.vectors.items[0]).vector[0]=g[0],A.vector[1]=g[1],A.texCoords[0]=0,A.texCoords[1]=m,A.direction[0]=0,A.direction[1]=0,(E=e.vectors.items[1]).vector[0]=b[0],E.vector[1]=b[1],E.texCoords[0]=0,E.texCoords[1]=m,E.direction[0]=0,E.direction[1]=0,f((z=e.vectors.items[2]).vector,u(I[9],g),c(I[10],u(I[11],t),B)),z.texCoords[0]=0,z.texCoords[1]=h,z.direction[0]=this._distanceAlongCorrection?t[0]:0,z.direction[1]=this._distanceAlongCorrection?t[1]:0,f((O=e.vectors.items[3]).vector,u(I[12],b),c(I[13],r,B)),O.texCoords[0]=0,O.texCoords[1]=h,O.direction[0]=this._distanceAlongCorrection?r[0]:0,O.direction[1]=this._distanceAlongCorrection?r[1]:0;var V=e.vectors.items[4];V.vector[0]=0,V.vector[1]=0,V.texCoords[0]=0,V.texCoords[1]=0,V.direction[0]=0,V.direction[1]=0,e.vectors.count=5,(L=e.lists[y.ENTRY]).items[0]=2,L.items[1]=4,L.items[2]=0,L.count=3,(N=e.lists[y.EXIT]).items[0]=3,N.items[1]=4,N.items[2]=1,N.count=3,e.capCenter=4}else{var A,E,z,O,L,N;(A=e.vectors.items[0]).vector[0]=g[0],A.vector[1]=g[1],A.texCoords[0]=0,A.texCoords[1]=m,A.direction[0]=0,A.direction[1]=0,(E=e.vectors.items[1]).vector[0]=b[0],E.vector[1]=b[1],E.texCoords[0]=0,E.texCoords[1]=m,E.direction[0]=0,E.direction[1]=0,c((z=e.vectors.items[2]).vector,D,1/T),z.texCoords[0]=0,z.texCoords[1]=h,z.direction[0]=0,z.direction[1]=0,(O=e.vectors.items[3]).vector[0]=0,O.vector[1]=0,O.texCoords[0]=0,O.texCoords[1]=0,O.direction[0]=0,O.direction[1]=0,e.vectors.count=4,(L=e.lists[y.ENTRY]).items[0]=2,L.items[1]=3,L.items[2]=0,L.count=3,(N=e.lists[y.EXIT]).items[0]=2,N.items[1]=3,N.items[2]=1,N.count=3,e.capCenter=3}p(w,g,b,i,o<0);var j,k=e.vectors.count,F=e.lists[y.CAP];for(F.items[0]=0,j=0;j<w.count;++j){var R=w.items[j],U=e.vectors.items[k+j];U.vector[0]=R[0],U.vector[1]=R[1],U.texCoords[0]=0,U.texCoords[1]=m,U.direction[0]=0,U.direction[1]=0,F.items[j+1]=k+j}F.items[w.count+1]=1,F.count=w.count+2,e.vectors.count=k+w.count,o<0&&(v(e.lists[y.ENTRY]),v(e.lists[y.EXIT]))},e.prototype.unitRoundJoin=function(e,t,r,i){var n=l(t,r),o=n>0?[-1,1]:[1,-1],a=o[0],c=o[1],f=n>0?u(I[0],s(I[1],t)):s(I[2],t),d=n>0?u(I[3],s(I[4],r)):s(I[5],r),h=e.vectors.items[0];h.vector[0]=f[0],h.vector[1]=f[1],h.texCoords[0]=0,h.texCoords[1]=c,h.direction[0]=0,h.direction[1]=0;var m=e.vectors.items[1];m.vector[0]=d[0],m.vector[1]=d[1],m.texCoords[0]=0,m.texCoords[1]=c,m.direction[0]=0,m.direction[1]=0;var x=e.vectors.items[2];u(x.vector,f),x.texCoords[0]=0,x.texCoords[1]=a,x.direction[0]=0,x.direction[1]=0;var g=e.vectors.items[3];u(g.vector,d),g.texCoords[0]=0,g.texCoords[1]=a,g.direction[0]=0,g.direction[1]=0;var b=e.vectors.items[4];b.vector[0]=0,b.vector[1]=0,b.texCoords[0]=0,b.texCoords[1]=0,b.direction[0]=0,b.direction[1]=0,e.vectors.count=5;var _=e.lists[y.ENTRY];_.items[0]=2,_.items[1]=0,_.count=2;var C=e.lists[y.EXIT];C.items[0]=3,C.items[1]=1,C.count=2,e.capCenter=4,p(w,f,d,i,n<0);var D,T=e.vectors.count,P=e.lists[y.CAP];for(P.items[0]=0,D=0;D<w.count;++D){var S=w.items[D],M=e.vectors.items[T+D];M.vector[0]=S[0],M.vector[1]=S[1],M.texCoords[0]=0,M.texCoords[1]=c,M.direction[0]=0,M.direction[1]=0,P.items[D+1]=T+D}P.items[w.count+1]=1,P.count=w.count+2,e.vectors.count=T+w.count,n<0&&(v(e.lists[y.ENTRY]),v(e.lists[y.EXIT]))},e.prototype.rectJoin=function(e,t,r){var i=s(I[0],t),n=s(I[1],r),o=e.vectors.items[0];o.vector[0]=i[0],o.vector[1]=i[1],o.texCoords[0]=0,o.texCoords[1]=-1,o.direction[0]=0,o.direction[1]=0;var a=e.vectors.items[1];a.vector[0]=n[0],a.vector[1]=n[1],a.texCoords[0]=0,a.texCoords[1]=-1,a.direction[0]=0,a.direction[1]=0;var l=e.vectors.items[2];u(l.vector,i),l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0;var c=e.vectors.items[3];u(c.vector,n),c.texCoords[0]=0,c.texCoords[1]=1,c.direction[0]=0,c.direction[1]=0,e.vectors.count=4;var f=e.lists[y.ENTRY];f.items[0]=0,f.items[1]=2,f.count=2;var d=e.lists[y.EXIT];d.items[0]=1,d.items[1]=3,d.count=2,e.capCenter=void 0},e}();t.Tessellator=E}.apply(null,i))||(e.exports=n)},1607:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1526),r(1529),r(1530),r(1342)],void 0===(n=function(e,t,r,i,n,o){function a(e,t){for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.name===t&&null!=n.attributeValues&&"UInt8"===n.attributeValues.valueType&&3===n.attributeValues.valuesPerElement)return{storageInfo:n,useElevation:!1}}return null}function s(e,t){for(var r=0,i=e;r<i.length;r++){var n=i[r];if(n.name===t){var o="embedded-elevation"===n.encoding;return{storageInfo:o?null:n,useElevation:o}}}return"elevation"===t.toLowerCase()?{storageInfo:null,useElevation:!0}:null}function l(e,t,r,i){if(e&&e.useElevation){for(var n=new Float64Array(i),a=0;a<i;a++)n[a]=r[3*a+2];return n}return e&&t?o.readBinaryAttribute(e.storageInfo,t,i):null}function u(e){return null==e||"none"===e?null:"low-four-bit"===e?function(e){return 15&e}:"high-four-bit"===e?function(e){return(240&e)>>4}:"absolute-value"===e?function(e){return Math.abs(e)}:"modulo-ten"===e?function(e){return e%10}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getRendererInfo=function(e){var t=e.renderer,r=t&&t.type,i=t&&e.renderer.toJSON()||null,n=null,o=!1;"point-cloud-unique-value"===r?n=s(e.attributeStorageInfo,t.field):"point-cloud-stretch"===r?n=s(e.attributeStorageInfo,t.field):"point-cloud-class-breaks"===r?n=s(e.attributeStorageInfo,t.field):o="point-cloud-rgb"===r?null!=(n=a(e.attributeStorageInfo,t.field)):null!=(n=a(e.attributeStorageInfo,"RGB"));var l=null;return t&&t.colorModulation&&(l=s(e.attributeStorageInfo,t.colorModulation.field)),{rendererJSON:i,isRGBRenderer:o,primaryAttribute:n,modulationAttribute:l}},t.evaluateRenderer=function(e,t,o,a,s){var c=e.rendererJSON,f=e.isRGBRenderer,d=e.primaryAttribute,h=e.modulationAttribute,p=l(d,t,a,s),v=l(h,o,a,s),y=null,m=null;if(p&&f)y=p;else if(p&&"pointCloudUniqueValueRenderer"===c.type){var x=(m=n.fromJSON(c)).colorUniqueValueInfos;y=new Uint8Array(3*s);for(var g=u(m.fieldTransformType),b=0;b<s;b++)for(var _=(C=g?g(p[b]):p[b])+"",I=0;I<x.length;I++)if(x[I].values.indexOf(_)>=0){y[3*b]=x[I].color.r,y[3*b+1]=x[I].color.g,y[3*b+2]=x[I].color.b;break}}else if(p&&"pointCloudStretchRenderer"===c.type){var w=(m=i.fromJSON(c)).stops;for(y=new Uint8Array(3*s),g=u(m.fieldTransformType),b=0;b<s;b++){var C=g?g(p[b]):p[b],D=w.length-1;if(C<w[0].value)y[3*b]=w[0].color.r,y[3*b+1]=w[0].color.g,y[3*b+2]=w[0].color.b;else if(C>=w[D].value)y[3*b]=w[D].color.r,y[3*b+1]=w[D].color.g,y[3*b+2]=w[D].color.b;else for(I=1;I<w.length;I++)if(C<w[I].value){var T=(C-w[I-1].value)/(w[I].value-w[I-1].value);y[3*b]=w[I].color.r*T+w[I-1].color.r*(1-T),y[3*b+1]=w[I].color.g*T+w[I-1].color.g*(1-T),y[3*b+2]=w[I].color.b*T+w[I-1].color.b*(1-T);break}}}else if(p&&"pointCloudClassBreaksRenderer"===c.type){var P=(m=r.fromJSON(c)).colorClassBreakInfos;for(y=new Uint8Array(3*s),g=u(m.fieldTransformType),b=0;b<s;b++)for(C=g?g(p[b]):p[b],I=0;I<P.length;I++)if(C>=P[I].minValue&&C<=P[I].maxValue){y[3*b]=P[I].color.r,y[3*b+1]=P[I].color.g,y[3*b+2]=P[I].color.b;break}}else for(y=new Uint8Array(3*s),b=0;b<y.length;b++)y[b]=255;if(v&&m&&m.colorModulation){var S=m.colorModulation.minValue,M=m.colorModulation.maxValue;for(b=0;b<s;b++){var B=(C=v[b])>=M?1:C<=S?.3:.3+.7*(C-S)/(M-S);y[3*b]=B*y[3*b],y[3*b+1]=B*y[3*b+1],y[3*b+2]=B*y[3*b+2]}}return y},t.getSplatSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"splat"===t.type?t:null},t.getFixedSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"fixed-size"===t.type?t:null},t.rendererUsesFixedSizes=function(e){var t=e&&e.pointSizeAlgorithm;return!(!t||!t.type)&&"fixed-size"===t.type}}.apply(null,i))||(e.exports=n)},1617:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(6),r(0)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.field=null,t.minValue=0,t.maxValue=255,t}var n;return r(t,e),n=t,t.prototype.clone=function(){return new n({field:this.field,minValue:this.minValue,maxValue:this.maxValue})},i([o.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),i([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minValue",void 0),i([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxValue",void 0),n=i([o.subclass("esri.renderers.support.pointCloud.ColorModulation")],t)}(o.declared(n));t.ColorModulation=a,t.default=a}.apply(null,i))||(e.exports=n)},1618:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(96),r(1527),r(1528)],void 0===(n=function(e,t,r,i,n){function o(e){return e&&a[e.type]||null}Object.defineProperty(t,"__esModule",{value:!0});var a={pointCloudFixedSizeAlgorithm:i.default,pointCloudSplatAlgorithm:n.default};t.read=function(e,t,i){var n=o(e);if(n){var a=new n;return a.read(e,i),a}return i&&i.messages&&e&&i.messages.push(new r("pointsizealgorithm:unsupported","Point size algorithms of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:i})),null},t.fromJSON=function(e){var t=o(e);return t?t.fromJSON(e):null}}.apply(null,i))||(e.exports=n)},1619:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1501),r(1527),r(1528)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.pointSizeAlgorithmTypes={key:"type",base:r.default,typeMap:{"fixed-size":i.default,splat:n.default}}}.apply(null,i))||(e.exports=n)},1620:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(24),r(6),r(5),r(0),r(35)],void 0===(n=function(e,t,r,i,n,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.minValue=0,t.maxValue=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:a.clone(this.color)})},i([s.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),i([s.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),i([s.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],t.prototype,"minValue",void 0),i([s.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],t.prototype,"maxValue",void 0),i([s.property({type:n,json:{type:[l.Integer],write:!0}})],t.prototype,"color",void 0),o=i([s.subclass("esri.renderers.support.pointCloud.ColorClassBreakInfo")],t)}(s.declared(o));t.ColorClassBreakInfo=u,t.default=u}.apply(null,i))||(e.exports=n)},1621:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(24),r(6),r(5),r(0),r(35)],void 0===(n=function(e,t,r,i,n,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.value=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({label:this.label,value:this.value,color:a.clone(this.color)})},i([s.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),i([s.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"value",void 0),i([s.property({type:n,json:{type:[l.Integer],write:!0}})],t.prototype,"color",void 0),o=i([s.subclass("esri.renderers.support.pointCloud.StopInfo")],t)}(s.declared(o));t.StopInfo=u,t.default=u}.apply(null,i))||(e.exports=n)},1622:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(2),r(1),r(24),r(6),r(5),r(0),r(35)],void 0===(n=function(e,t,r,i,n,o,a,s,l){Object.defineProperty(t,"__esModule",{value:!0});var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.values=null,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,values:a.clone(this.values),color:a.clone(this.color)})},i([s.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),i([s.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),i([s.property({type:[String],json:{write:!0}})],t.prototype,"values",void 0),i([s.property({type:n,json:{type:[l.Integer],write:!0}})],t.prototype,"color",void 0),o=i([s.subclass("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],t)}(s.declared(o));t.ColorUniqueValueInfo=u,t.default=u}.apply(null,i))||(e.exports=n)},1624:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(1531)],void 0===(n=function(e,t,r,i){return function(){function e(t,i){if(this.styleJSON=t,this.version=parseFloat(t.version),this.sprite=i?i.spriteUrl:t.sprite,this.glyphs=i?i.glyphsUrl:t.glyphs,r("stable-symbol-rendering")){var n=(t.layers||[]).filter(function(e){return e.layout&&e.layout["text-font"]})[0];n&&(t.layers||[]).forEach(function(e){e.layout&&e.layout["text-font"]&&(e.layout["text-font"]=n.layout["text-font"])})}this.layers=(t.layers||[]).map(e._create),this._identifyRefLayers()}return e.prototype._identifyRefLayers=function(){for(var e=[],t=[],r=0,i=0,n=this.layers;i<n.length;i++){var o=n[i];if(1===o.type){var a=o,s=o.sourceLayer;s+="|"+JSON.stringify(o.minzoom),s+="|"+JSON.stringify(o.maxzoom),s+="|"+JSON.stringify(o.filter),(a.hasDataDrivenFill||a.hasDataDrivenOutline)&&(s+="|"+JSON.stringify(r)),e.push({key:s,layer:o})}if(2===o.type){var l=o;s=o.sourceLayer;s+="|"+JSON.stringify(o.minzoom),s+="|"+JSON.stringify(o.maxzoom),s+="|"+JSON.stringify(o.filter),s+="|"+JSON.stringify(o.layout&&o.layout["line-cap"]),s+="|"+JSON.stringify(o.layout&&o.layout["line-join"]),l.hasDataDrivenLine&&(s+="|"+JSON.stringify(r)),t.push({key:s,layer:o})}++r}this._assignRefLayers(e),this._assignRefLayers(t)},e.prototype._assignRefLayers=function(e){e.sort(function(e,t){return e.key<t.key?-1:e.key>t.key?1:0});for(var t,r,i=e.length,n=0;n<i;n++){var o=e[n];if(o.key===t)o.layer.refLayerId=r;else if(t=o.key,r=o.layer.id,1===o.layer.type&&!o.layer.getPaintProperty("fill-outline-color"))for(var a=n+1;a<i;a++){var s=e[a];if(s.key!==t)break;if(s.layer.getPaintProperty("fill-outline-color")){e[n]=s,e[a]=o,r=s.layer.id;break}}}},e._create=function(e,t,r){var n=1-(1+t)*(1/(r.length+1));switch(e.type){case"background":return new i.BackgroundStyleLayer(0,e,n);case"fill":return new i.FillStyleLayer(1,e,n);case"line":return new i.LineStyleLayer(2,e,n);case"symbol":return new i.SymbolStyleLayer(3,e,n);case"raster":throw new Error("Unsupported vector tile raster layer");case"circle":return new i.CircleStyleLayer(4,e,n)}throw new Error("Unknown vector tile layer")},e}()}.apply(null,i))||(e.exports=n)},1625:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(t,r,i){this._op=t,"$type"===r?(i instanceof Array?this._val=i.map(function(t){return e._types.indexOf(t)}):this._val=e._types.indexOf(i),this._op+=11):(this._key=r,this._val=i)}return e.prototype.filter=function(e){switch(this._op){case 0:return this._val;case 1:return e.values[this._key]===this._val;case 2:return e.values[this._key]!==this._val;case 3:return e.values[this._key]<this._val;case 4:return e.values[this._key]>this._val;case 5:return e.values[this._key]<=this._val;case 6:return e.values[this._key]>=this._val;case 7:return-1!==this._val.indexOf(e.values[this._key]);case 8:return-1===this._val.indexOf(e.values[this._key]);case 9:for(var t=0,r=this._val;t<r.length;t++){if(r[t].filter(e))return!0}return!1;case 10:for(var i=0,n=this._val;i<n.length;i++){if(!n[i].filter(e))return!1}return!0;case 11:for(var o=0,a=this._val;o<a.length;o++){if(a[o].filter(e))return!1}return!0;case 12:return e.type===this._val;case 13:return e.type!==this._val;case 14:return e.type<this._val;case 15:return e.type>this._val;case 16:return e.type>=this._val;case 17:return e.type<=this._val;case 18:return-1!==this._val.indexOf(e.type);case 19:return-1===this._val.indexOf(e.type)}},e.createFilter=function(t){if(!t)return new e(0,void 0,!0);var r=t[0];if(t.length<=1)return new e(0,void 0,"any"!==r);switch(r){case"==":return new e(1,t[1],t[2]);case"!=":return new e(2,t[1],t[2]);case">":return new e(4,t[1],t[2]);case"<":return new e(3,t[1],t[2]);case">=":return new e(6,t[1],t[2]);case"<=":return new e(5,t[1],t[2]);case"in":return new e(7,t[1],t.slice(2));case"!in":return new e(8,t[1],t.slice(2));case"any":return new e(9,void 0,t.slice(1).map(e.createFilter.bind(this)));case"all":return new e(10,void 0,t.slice(1).map(e.createFilter.bind(this)));case"none":return new e(11,void 0,t.slice(1).map(e.createFilter.bind(this)));default:throw new Error("invalid operator: "+r)}},e._types=["Unknown","Point","LineString","Polygon"],e}()}.apply(null,i))||(e.exports=n)},1626:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.backgroundLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e.fillLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e.lineLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"line-cap":{type:"enum",values:["butt","round","square"],default:"butt"},"line-join":{type:"enum",values:["bevel","round","miter"],default:"miter"},"line-miter-limit":{type:"number",default:2},"line-round-limit":{type:"number",default:1.05}},e.symbolLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"},"symbol-placement":{type:"enum",values:["point","line"],default:"point"},"symbol-spacing":{type:"number",minimum:1,default:250},"symbol-avoid-edges":{type:"boolean",default:!1},"icon-image":{type:"string"},"icon-allow-overlap":{type:"boolean",default:!1},"icon-ignore-placement":{type:"boolean",default:!1},"icon-optional":{type:"boolean",default:!1},"icon-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"icon-size":{type:"number",minimum:0,default:1},"icon-rotate":{type:"number",default:0},"icon-padding":{type:"number",minimum:0,default:2},"icon-keep-upright":{type:"boolean",default:!1},"icon-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-field":{type:"string"},"text-rotation-alignment":{type:"enum",values:["map","viewport","auto"],default:"auto"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"]},"text-size":{type:"number",minimum:0,default:16},"text-max-width":{type:"number",minimum:0,default:10},"text-line-height":{type:"number",default:1.2},"text-letter-spacing":{type:"number",default:0},"text-justify":{type:"enum",values:["left","center","right"],default:"center"},"text-anchor":{type:"enum",values:["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"],default:"center"},"text-max-angle":{type:"number",minimum:0,default:45},"text-rotate":{type:"number",default:0},"text-padding":{type:"number",minimum:0,default:2},"text-keep-upright":{type:"boolean",default:!0},"text-transform":{type:"enum",values:["none","uppercase","lowercase"],default:"none"},"text-offset":{type:"array",value:"number",length:2,default:[0,0]},"text-allow-overlap":{type:"boolean",default:!1},"text-ignore-placement":{type:"boolean",default:!1},"text-optional":{type:"boolean",default:!1}},e.circleLayoutDefinition={visibility:{type:"enum",values:["visible","none"],default:"visible"}},e.backgroundPaintDefinition={"background-opacity":{type:"number",minimum:0,maximum:1,default:1},"background-color":{type:"color",default:[0,0,0,1]},"background-pattern":{type:"string"}},e.fillPaintDefinition={"fill-opacity":{type:"number",minimum:0,maximum:1,default:1},"fill-antialias":{type:"boolean",default:!0},"fill-color":{type:"color",default:[0,0,0,1]},"fill-outline-color":{type:"color",default:[0,0,0,0]},"fill-translate":{type:"array",value:"number",length:2,default:[0,0]},"fill-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"fill-pattern":{type:"string"}},e.linePaintDefinition={"line-opacity":{type:"number",minimum:0,maximum:1,default:1},"line-color":{type:"color",default:[0,0,0,1]},"line-translate":{type:"array",value:"number",length:2,default:[0,0]},"line-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"line-width":{type:"number",minimum:0,default:1},"line-gap-width":{type:"number",minimum:0,default:0},"line-offset":{type:"number",default:0},"line-blur":{type:"number",minimum:0,default:0},"line-dasharray":{type:"array",value:"number",default:[]},"line-pattern":{type:"string"}},e.symbolPaintDefinition={"icon-opacity":{type:"number",minimum:0,maximum:1,default:1},"icon-color":{type:"color",default:[0,0,0,1]},"icon-halo-color":{type:"color",default:[0,0,0,0]},"icon-halo-width":{type:"number",minimum:0,default:0},"icon-halo-blur":{type:"number",minimum:0,default:0},"icon-translate":{type:"array",value:"number",length:2,default:[0,0]},"icon-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"text-opacity":{type:"number",minimum:0,maximum:1,default:1},"text-color":{type:"color",default:[0,0,0,1]},"text-halo-color":{type:"color",default:[0,0,0,0]},"text-halo-width":{type:"number",minimum:0,default:0},"text-halo-blur":{type:"number",minimum:0,default:0},"text-translate":{type:"array",value:"number",length:2,default:[0,0]},"text-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"}},e.rasterPaintDefinition={"raster-opacity":{type:"number",minimum:0,maximum:1,default:1},"raster-hue-rotate":{type:"number",default:0},"raster-brightness-min":{type:"number",minimum:0,maximum:1,default:0},"raster-brightness-max":{type:"number",minimum:0,maximum:1,default:1},"raster-saturation":{type:"number",minimum:-1,maximum:1,default:0},"raster-contrast":{type:"number",minimum:-1,maximum:1,default:0},"raster-fade-duration":{type:"number",minimum:0,default:300}},e.circlePaintDefinition={"circle-opacity":{type:"number",minimum:0,maximum:1,default:1},"circle-radius":{type:"number",minimum:0,default:5},"circle-color":{type:"color",default:[0,0,0,1]},"circle-blur":{type:"number",minimum:0,default:0},"circle-translate":{type:"array",value:"number",length:2,default:[0,0]},"circle-translate-anchor":{type:"enum",values:["map","viewport"],default:"map"},"circle-stroke-width":{type:"number",minimum:0,default:0},"circle-stroke-color":{type:"color",default:[0,0,0,1]},"circle-stroke-opacity":{type:"number",minimum:0,maximum:1,default:1}},e}();t.StyleDefinition=r}.apply(null,i))||(e.exports=n)},1627:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(24),r(457)],void 0===(n=function(e,t,r,i){return function(){function e(t,r,i){var n;switch(this.isDataDriven=!1,r.type){case"number":n=!0;break;case"color":n=!0,i=e._parseColor(i);break;case"array":n="number"===r.value;break;default:n=!1}null==i&&(i=r.default),n&&"interval"===i.type&&(n=!1);var o=i&&i.stops&&i.stops.length>0;if(o)for(var a=0,s=i.stops;a<s.length;a++){var l=s[a];l[1]=this._validate(l[1],r)}if(this.isDataDriven=!!i&&!!i.property,this.isDataDriven)if(void 0!==i.default&&(i.default=this._validate(i.default,r)),o)switch(i.type){case"identity":this.getValue=this._buildIdentity(i,r);break;case"categorical":this.getValue=this._buildCategorical(i,r);break;default:this.getValue=n?this._buildInterpolate(i,r):this._buildInterval(i,r)}else this.getValue=this._buildIdentity(i,r);else o?this.getValue=n?this._buildZoomInterpolate(i):this._buildZoomInterval(i):(i=this._validate(i,r),this.getValue=this._buildSimple(i))}return e.prototype._validate=function(e,t){if("number"===t.type){if(e<t.minimum)return t.minimum;if(e>t.maximum)return t.maximum}return e},e.prototype._buildSimple=function(e){return function(){return e}},e.prototype._buildIdentity=function(t,r){var i=this;return function(n,o){var a;return o&&(a=o.values[t.property],"color"===r.type&&(a=e._parseColor(a))),void 0===a&&(a=t.default),void 0!==a?i._validate(a,r):r.default}},e.prototype._buildCategorical=function(e,t){var r=this;return function(i,n){var o;return n&&(o=n.values[e.property]),void 0!==(o=r._categorical(o,e.stops))?o:void 0!==e.default?e.default:t.default}},e.prototype._buildInterval=function(e,t){var r=this;return function(i,n){var o;return n&&(o=n.values[e.property]),"number"==typeof o?r._interval(o,e.stops):void 0!==e.default?e.default:t.default}},e.prototype._buildInterpolate=function(e,t){var r=this;return function(i,n){var o;return n&&(o=n.values[e.property]),"number"==typeof o?r._interpolate(o,e.stops,e.base||1):void 0!==e.default?e.default:t.default}},e.prototype._buildZoomInterpolate=function(e){var t=this;return function(r){return t._interpolate(r,e.stops,e.base||1)}},e.prototype._buildZoomInterval=function(e){var t=this;return function(r){return t._interval(r,e.stops)}},e.prototype._categorical=function(e,t){for(var r=t.length,i=0;i<r;i++)if(t[i][0]===e)return t[i][1]},e.prototype._interval=function(e,t){for(var r=t.length,i=0,n=0;n<r&&t[n][0]<=e;n++)i=n;return t[i][1]},e.prototype._interpolate=function(e,t,r){for(var n,o,a=t.length,s=0;s<a;s++){var l=t[s];if(!(l[0]<=e)){o=l;break}n=l}if(n&&o){var u=o[0]-n[0],c=e-n[0],f=1===r?c/u:(Math.pow(r,c)-1)/(Math.pow(r,u)-1);if(Array.isArray(n[1])){var d=n[1],h=o[1],p=[];for(s=0;s<d.length;s++)p.push(i.interpolate(d[s],h[s],f));return p}return i.interpolate(n[1],o[1],f)}return n?n[1]:o?o[1]:void 0},e._isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},e._parseColor=function(t){if(Array.isArray(t))return t;if("string"!=typeof t)return t&&t.default&&(t.default=e._parseColor(t.default)),t&&t.stops&&(t.stops=t.stops.map(function(t){return[t[0],e._parseColor(t[1])]})),t;var i=new r(t);return this._isEmpty(i)?void 0:r.toUnitRGBA(i)},e}()}.apply(null,i))||(e.exports=n)},1634:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(9),r(8)],void 0===(n=function(e,t,i,n,o){Object.defineProperty(t,"__esModule",{value:!0}),t.getControllerConfiguration=function(e){var t=e.source;return e.capabilities.operations.supportsQuery?function(e){return e&&"esri.layers.graphics.sources.CSVSource"===e.declaredClass}(t)?o.resolve().then(function(){return{type:"memory",processing:e.processing&&e.processing.toWorker()||null}}):o.resolve({type:"on-demand",gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime(),processing:e.processing&&e.processing.toWorker()||null}):o.reject(new n("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:e}))},t.createController=function(e,t){return("memory"===e?o.create(function(e){return r.e(66).then(function(){var t=[r(1750)];e.apply(null,t)}.bind(this)).catch(r.oe)}):o.create(function(e){return Promise.all([r.e(29),r.e(67)]).then(function(){var t=[r(1751)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,n=t.remoteClient,o=t.tileStore;return new e(i({},r,{tileStore:o,remoteClient:n}))})}}.apply(null,i))||(e.exports=n)},1731:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(116),r(467),r(1448),r(1536)],void 0===(n=function(e,t,r,i,n,o,a,s){return function(e){function t(t,r,i,n,o,a){var s=e.call(this,t,r)||this;if(t.hasDataDrivenFill!==i.isDataDriven())throw new Error("incompatible fill buffer");if(t.hasDataDrivenOutline!==o.isDataDriven())throw new Error("incompatible outline buffer");return s._fillVertexBuffer=i,s._fillIndexBuffer=n,s._outlineVertexBuffer=o,s._outlineIndexBuffer=a,s}return r(t,e),Object.defineProperty(t.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexStart",{get:function(){return this._outlineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._fillIndexStart=this._fillIndexStart,t._fillIndexCount=this._fillIndexCount,e.layer.getPaintProperty("fill-outline-color")?(t._outlineIndexStart=this._outlineIndexStart,t._outlineIndexCount=this._outlineIndexCount):(t._outlineIndexStart=0,t._outlineIndexCount=0)},t.prototype.processFeatures=function(e,t){this._fillIndexStart=this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=this._outlineIndexBuffer.index,this._outlineIndexCount=0;var r=this.layer,i=this.zoom,n=r.hasDataDrivenFill,o=r.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var a=r.getPaintValue("fill-pattern",i),s=r.getPaintValue("fill-antialias",i)&&void 0===a,l=[1,1,1,1],u=[1,1,1,1],c=1;if(r.outlineUsesFillColor){if(s&&!r.hasDataDrivenOpacity){var f=r.getPaintValue("fill-opacity",i),d=r.getPaintValue("fill-opacity",i+1);f<1&&d<1&&(s=!1)}if(s&&!r.hasDataDrivenColor){var h=r.getPaintValue("fill-color",i),p=r.getPaintValue("fill-color",i+1);h[3]<1&&p[3]<1&&(s=!1)}}for(var v=0,y=this._features;v<y.length;v++){var m=y[v];!a&&r.hasDataDrivenColor&&(l=r.getPaintValue("fill-color",i,m)),r.hasDataDrivenOpacity&&(c=r.getPaintValue("fill-opacity",i,m)),!a&&r.hasDataDrivenOutlineColor&&(u=r.getPaintValue("fill-outline-color",i,m));var x=void 0;n&&(x={color:l,opacity:c});var g=void 0;o&&(g={color:r.outlineUsesFillColor?l:u,opacity:c});var b=m.getGeometry(e);this._processFeature(b,s,r.outlineUsesFillColor,x,g)}},t.prototype._processFeature=function(e,r,i,n,o){if(e){var a=e.length;if(r&&(!i||!o||o.color[3]*o.opacity==1))for(var s=0;s<a;s++)this._processOutline(e[s],o);var l;for(s=0;s<a;s++){var u=t._area(e[s]);u>128?(void 0!==l&&this._processFill(e,l,n),l=[s]):u<-128&&void 0!==l&&l.push(s)}void 0!==l&&this._processFill(e,l,n)}},t.prototype._processOutline=function(e,t){var r,i,n,o=this._outlineVertexBuffer,s=this._outlineIndexBuffer,l=s.index,u=new a.Point(0,0),c=new a.Point(0,0),f=new a.Point(0,0),d=-1,h=-1,p=-1,v=-1,y=-1,m=!1,x=e.length;if(!(x<2)){for(var g=e[0],b=e[x-1];x&&b.isEqual(g);)b=e[--x-1];if(!(x-0<2)){for(var _=0;_<x;++_){0===_?(r=e[x-1],i=e[0],n=e[1],u.assignSub(i,r),u.normalize(),u.rightPerpendicular()):(r=i,i=n,n=_!==x-1?e[_+1]:e[0],u.assign(c));var I=this._isClipEdge(r,i);-1===v&&(m=I),c.assignSub(n,i),c.normalize(),c.rightPerpendicular();var w=u.x*c.y-u.y*c.x;f.assignAdd(u,c),f.normalize();var C=-f.x*-u.x+-f.y*-u.y,D=Math.abs(0!==C?1/C:1);D>8&&(D=8),w>=0?(p=o.add(i.x,i.y,u.x,u.y,0,1,t),-1===v&&(v=p),d>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p),h=o.add(i.x,i.y,D*-f.x,D*-f.y,0,-1,t),-1===y&&(y=h),d>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p),d=h,h=p,p=o.add(i.x,i.y,f.x,f.y,0,1,t),d>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p),h=o.add(i.x,i.y,c.x,c.y,0,1,t),d>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p)):(p=o.add(i.x,i.y,D*f.x,D*f.y,0,1,t),-1===v&&(v=p),d>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p),h=o.add(i.x,i.y,-u.x,-u.y,0,-1,t),-1===y&&(y=h),d>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p),d=h,h=p,p=o.add(i.x,i.y,-f.x,-f.y,0,-1,t),d>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p),(d=o.add(i.x,i.y,-c.x,-c.y,0,-1,t))>=0&&h>=0&&p>=0&&!I&&s.add(d,h,p))}d>=0&&h>=0&&v>=0&&!m&&s.add(d,h,v),d>=0&&v>=0&&y>=0&&!m&&s.add(d,y,v),this._outlineIndexCount+=3*(s.index-l)}}},t.prototype._processFill=function(e,t,r){var i;t.length>1&&(i=[]);for(var a=0,s=0,l=t;s<l.length;s++){var u=l[s];0!==a&&i.push(a),a+=e[u].length}for(var c=2*a,f=n.acquire(),d=0,h=t;d<h.length;d++)for(var p=e[u=h[d]],v=p.length,y=0;y<v;++y)f.push(p[y].x),f.push(p[y].y);var m=o(f,i,2),x=m.length;if(x>0){for(var g=this._fillVertexBuffer.index,b=0;b<c;)this._fillVertexBuffer.add(f[b++],f[b++],r);for(var _=0;_<x;)this._fillIndexBuffer.add(g+m[_++],g+m[_++],g+m[_++]);this._fillIndexCount+=x}n.release(f)},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t._area=function(e){for(var t=0,r=e.length-1,i=0;i<r;i++)t+=(e[i].x-e[i+1].x)*(e[i].y+e[i+1].y);return.5*(t+(e[r].x-e[0].x)*(e[r].y+e[0].y))},t}(s)}.apply(null,i))||(e.exports=n)},1732:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(495),r(135),r(8)],void 0===(n=function(e,t,r,i,n,o){function a(){var e=0===l.length;if(!e){for(var t=n();!e&&n()-t<s;){var r=l[c];if(r){if(!0===r()){var o=u.get(r);l[c]=null,u.delete(r),o()}c=(c+1)%l.length}else l.splice(c,1),(e=0===l.length)?c=0:c%=l.length}e||i(a)}}var s=r("host-browser")?6:200,l=[],u=new Map,c=0;return function(e){return e?o.create(function(t){l.push(e),u.set(e,t),1===l.length&&i(a)},function(){l[l.indexOf(e)]=null,u.delete(e)}):o.reject(new TypeError("callback is not a function"))}}.apply(null,i))||(e.exports=n)},1733:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(1536)],void 0===(n=function(e,t,r,i,n){return function(e){function t(t,r){return e.call(this,t,r)||this}return r(t,e),t}(n)}.apply(null,i))||(e.exports=n)},1734:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(1536)],void 0===(n=function(e,t,r,i,n){return function(e){function t(t,r,i,n){var o=e.call(this,t,r)||this;return o._circleVertexBuffer=i,o._circleIndexBuffer=n,o}return r(t,e),Object.defineProperty(t.prototype,"circleIndexStart",{get:function(){return this._circleIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"circleIndexCount",{get:function(){return this._circleIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._circleIndexStart=this._circleIndexStart,t._circleIndexCount=this._circleIndexCount},t.prototype.processFeatures=function(e,t){var r=this._circleVertexBuffer,i=this._circleIndexBuffer;this._circleIndexStart=i.index,this._circleIndexCount=0;var n=this.layer,o=this.zoom;e&&e.setExtent(this.layerExtent);for(var a=1,s=[1,1,1,1],l=1,u=0,c=1,f=[1,1,1,1],d=1,h=0,p=this._features;h<p.length;h++){var v=p[h],y=v.getGeometry(e);if(y){n.hasDataDrivenRadius&&(a=n.getPaintValue("circle-radius",o,v)),n.hasDataDrivenColor&&(s=n.getPaintValue("circle-color",o,v)),n.hasDataDrivenOpacity&&(l=n.getPaintValue("circle-opacity",o,v)),n.hasDataDrivenStrokeWidth&&(c=n.getPaintValue("circle-stroke-width",o,v)),n.hasDataDrivenStrokeColor&&(f=n.getPaintValue("circle-stroke-color",o,v)),n.hasDataDrivenStrokeOpacity&&(d=n.getPaintValue("circle-stroke-opacity",o,v)),n.hasDataDrivenBlur&&(u=n.getPaintValue("circle-blur",o,v));for(var m=0,x=y;m<x.length;m++){var g=x[m];if(g)for(var b=0,_=g;b<_.length;b++){var I=_[b],w=r.index;r.add(I.x,I.y,0,0,a,s,l,u,c,f,d),r.add(I.x,I.y,0,1,a,s,l,u,c,f,d),r.add(I.x,I.y,1,0,a,s,l,u,c,f,d),r.add(I.x,I.y,1,1,a,s,l,u,c,f,d),i.add(w+0,w+1,w+2),i.add(w+1,w+2,w+3),this._circleIndexCount+=6}}}}},t}(n)}.apply(null,i))||(e.exports=n)},1735:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(1606),r(1536),r(1531)],void 0===(n=function(e,t,r,i,n,o,a){var s=20,l=new n.Tessellator({distanceAlongCorrection:!0});return function(e){function t(t,r,i,o){var a=e.call(this,t,r)||this;if(a.extrudeVectorsDoubleBuffer=[n.allocExtrudeVectors(),n.allocExtrudeVectors()],a.firstExtrudeVectors=n.allocExtrudeVectors(),a.recycledTriangleBridge=n.allocTriangles(s),a.recycledTrianglePie=n.allocTriangles(s),t.hasDataDrivenLine!==i.isDataDriven())throw new Error("incompatible line buffer");return a._lineVertexBuffer=i,a._lineIndexBuffer=o,a}return r(t,e),Object.defineProperty(t.prototype,"lineIndexStart",{get:function(){return this._lineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._lineIndexStart=this._lineIndexStart,t._lineIndexCount=this._lineIndexCount},t.prototype.processFeatures=function(e,t){this._lineIndexStart=this._lineIndexBuffer.index,this._lineIndexCount=0;var r=this.layer,i=this.zoom,n=r.hasDataDrivenLine;e&&e.setExtent(this.layerExtent);for(var o=r.getPaintValue("line-pattern",i),s=[1,1,1,1],l=1,u=1,c=0,f=this._features;c<f.length;c++){var d=f[c],h=new a.LineLayout(r,i,d);!o&&r.hasDataDrivenColor&&(s=r.getPaintValue("line-color",i,d)),r.hasDataDrivenOpacity&&(l=r.getPaintValue("line-opacity",i,d)),r.hasDataDrivenWidth&&(u=r.getPaintValue("line-width",i,d));var p=void 0;if(!(n&&(p={color:s,opacity:l,size:Math.max(Math.min(u,256),0)},p.size<=0||p.opacity<=0||p.color[3]<=0))){var v=d.getGeometry(e);this._processFeature(h,v,p)}}},t.prototype._processFeature=function(e,t,r){if(t)for(var i=t.length,n=0;n<i;n++)this._processGeometry(t[n],e,r)},t.prototype._processGeometry=function(e,t,r){if(!(e.length<2)){for(var i=e[0],o=e[e.length-1],a=o.x-i.x,s=o.y-i.y,l=a*a+s*s<1e-6,u=e[0],c=1;c<e.length;)(a=e[c].x-u.x)*a+(s=e[c].y-u.y)*s<1e-6?e.splice(c,1):(u=e[c],++c);if(!(e.length<2)){this.vertices=e,this.verticesLen=e.length,this.isClosed=l,this.cap=t.cap,this.join=t.join,this.almostParallelRads=.05,this.veryShallowRads=.1,this.miterSafeRads=n.MITER_SAFE_RADS,this.miterLimitMag=Math.min(t.miterLimit,n.SYSTEM_MAG_LIMIT),this.roundLimitRads=Math.min(t.roundLimit,.5),this.newRoundJoinsSafeRads=2.3;for(var f=this._lineIndexBuffer.index,d=0,h=void 0,p=this.verticesLen,v=0;v<p;++v){var y=e[v],m=e[(v+p-1)%p],x=l&&this._isClipEdge(m,y),g=h===this.extrudeVectorsDoubleBuffer[v%2]?this.extrudeVectorsDoubleBuffer[(v+1)%2]:this.extrudeVectorsDoubleBuffer[v%2];if(v<p-1||!l||this.hasPattern?(this._computeExtrudeVectors(g,v),this._writeGPUVertices(y.x,y.y,d,g,r),!g.capCenter||l&&v===p-1||this._writeGPUPieElements(g,x),l&&0===v&&!this.hasPattern&&n.copyExtrudeVectors(this.firstExtrudeVectors,g)):n.copyExtrudeVectors(g,this.firstExtrudeVectors),h&&this._writeGPUBridgeElements(h,g,x),v<p-1){var b=e[v+1];d+=n.length([b.x-y.x,b.y-y.y])}h=g}this._lineIndexCount+=3*(this._lineIndexBuffer.index-f)}}},t.prototype._computeExtrudeVectors=function(e,t){var r=this.vertices,i=this.verticesLen,o=this.isClosed,a=r[t],s=[void 0,void 0],l=[void 0,void 0];if(t>0&&t<i-1){var u=r[(t+i-1)%i],c=r[(t+1)%i];n.normalize(s,[a.x-u.x,a.y-u.y]),n.normalize(l,[c.x-a.x,c.y-a.y])}else if(0===t){c=r[(t+1)%i];if(n.normalize(l,[c.x-a.x,c.y-a.y]),o){var f=r[i-2];n.normalize(s,[a.x-f.x,a.y-f.y])}else s=l}else{if(t!==i-1)return void console.error("Vertex index 'i' out of range.");u=r[(t+i-1)%i];if(n.normalize(s,[a.x-u.x,a.y-u.y]),o){var d=r[1];n.normalize(l,[d.x-a.x,d.y-a.y])}else l=s}o||0!==t?o||t!==i-1?this._computeJoinExtrudeVectors(e,s,l):this._computeCapExtrudeVectors(e,s,l,n.CapPosition.END):this._computeCapExtrudeVectors(e,s,l,n.CapPosition.START)},t.prototype._computeCapExtrudeVectors=function(e,t,r,i){0===this.cap?l.buttCap(e,t,r):1===this.cap?l.roundCap(e,t,r,i,n.getNumberOfSlices(Math.PI),i===n.CapPosition.START?-1:1):2===this.cap?l.squareCap(e,t,r,i):l.buttCap(e,t,r)},t.prototype._computeJoinExtrudeVectors=function(e,t,r){var i=n.getRads(t,r);if(i>Math.PI-this.almostParallelRads)l.rectJoin(e,t,r);else if(0===this.join&&i>=this.veryShallowRads)l.bevelJoin(e,t,r,1);else if(1===this.join&&i>=this.veryShallowRads){var o=n.getNumberOfSlices(i);i<this.newRoundJoinsSafeRads?o<2||i<this.roundLimitRads?l.bevelJoin(e,t,r,1):l.roundJoin(e,t,r,o):l.unitRoundJoin(e,t,r,o)}else i<this.almostParallelRads?l.fastMiterJoin(e,t,r):i<this.miterSafeRads?l.miterJoin(e,t,r):l.bevelJoin(e,t,r,this.miterLimitMag)},t.prototype._writeGPUVertices=function(e,t,r,i,n){for(var o=0;o<i.vectors.count;++o){var a=i.vectors.items[o].vector[0],s=i.vectors.items[o].vector[1],l=i.vectors.items[o].texCoords[0],u=i.vectors.items[o].texCoords[1];i.vectors.items[o].base=this._lineVertexBuffer.index,this._lineVertexBuffer.add(e,t,a,s,l,u,r,n)}},t.prototype._writeGPUBridgeElements=function(e,t,r){if(l.bridge(this.recycledTriangleBridge,e,t),!r)for(var i=0;i<this.recycledTriangleBridge.count;++i){var n=this.recycledTriangleBridge.items[i];this._lineIndexBuffer.add(n.v1.base,n.v2.base,n.v3.base)}},t.prototype._writeGPUPieElements=function(e,t){if(l.pie(this.recycledTrianglePie,e),!t)for(var r=0;r<this.recycledTrianglePie.count;++r){var i=this.recycledTrianglePie.items[r];this._lineIndexBuffer.add(i.v1.base,i.v2.base,i.v3.base)}},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t}(o)}.apply(null,i))||(e.exports=n)},1736:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1448),r(2069),r(457)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t,r,i,n){void 0===r&&(r=0),void 0===i&&(i=-1),void 0===n&&(n=u),this.x=e,this.y=t,this.angle=r,this.segment=i,this.minzoom=n}}();t.Anchor=o;var a=function(){return function(e,t,r,i,o,a,s){void 0===o&&(o=!1),void 0===a&&(a=u),void 0===s&&(s=n.C_INFINITY),this.anchor=e,this.labelAngle=t,this.glyphAngle=r,this.page=i,this.upsideDown=o,this.minzoom=a,this.maxzoom=s}}(),s=function(){return function(e,t,r,i,n,o,a,s,l,u){this.tl=e,this.tr=t,this.bl=r,this.br=i,this.mosaicRect=n,this.labelAngle=o,this.anchor=a,this.minzoom=s,this.maxzoom=l,this.page=u}}();t.PlacedSymbol=s;var l=function(){return function(e,t){this.footprint=e,this.shapes=t}}();t.Placement=l;var u=.5,c=function(){function e(){this.mapAngle=0,this._conflictEngine=new i.ConflictEngine}return e.prototype.reset=function(){this._conflictEngine.reset()},e.prototype.setAngle=function(e){this.mapAngle=e,this._conflictEngine.setAngle(e)},e.prototype.getIconPlacement=function(e,t,o,a,c,f,d){var h=o.width/o.pixelRatio,p=o.height/o.pixelRatio,v=f.offset[0]-h/2,y=f.offset[1]-p/2,m=v+h,x=y+p,g=o.rect,b=o.sdf?17:2,_=v-b,I=y-b,w=_+g.width/o.pixelRatio,C=I+g.height/o.pixelRatio,D=new r.Point(_,I),T=new r.Point(w,C),P=new r.Point(_,C),S=new r.Point(w,I),M=f.rotate*n.C_DEG_TO_RAD,B=1===f.rotationAlignment;if(e.segment>=0&&!B&&(M+=e.angle),0!==M){var V=Math.cos(M),A=Math.sin(M);D.rotate(V,A),T.rotate(V,A),P.rotate(V,A),S.rotate(V,A)}var E=8*f.padding,z=new r.Point(e.x,e.y),O=new i.Footprint(this.mapAngle,E,B);O.addBox(z,new i.Box(v,y,m,x),a,M,t,u,n.C_INFINITY);var L=new s(D,S,P,T,g,0,z,u,n.C_INFINITY,0),N=new l(O,[L]),j=u;return f.allowOverlap||(j=this._conflictEngine.getMinZoom(N.footprint,j,d,B)),O.minzoom=j,N},e.prototype.getTextPlacement=function(e,t,o,c,f,d,h,p){for(var v,y=new r.Point(e.x,e.y),m=h.rotate*n.C_DEG_TO_RAD,x=0===h.rotationAlignment,g=h.keepUpright,b=u,_=!x,I=_?0:e.angle,w=e.segment>=0&&x,C=8*h.padding,D=new i.Footprint(this.mapAngle,C,_),T=[],P=!w,S=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,B=S,V=M,A=w?g:x&&g,E=0,z=c;E<z.length;E++){var O=z[E],L=O.glyphMosaicItem;if(L&&!L.rect.isEmpty){var N=L.rect,j=L.metrics,k=L.page;P&&(v&&v!==O.y&&(D.addBox(y,new i.Box(S,B,M,V),f,m,t,u,n.C_INFINITY),B=S=Number.POSITIVE_INFINITY,V=M=Number.NEGATIVE_INFINITY),v=O.y);var F=[];if(w){var R=.5*L.metrics.width,U=(o.x+O.x+j.left-4+R)*f;if(b=this._placeGlyph(e,b,U,d,e.segment,1,k,F),g&&(b=this._placeGlyph(e,b,U,d,e.segment,-1,k,F)),b>=2)break}else F.push(new a(y,I,I,k)),x&&g&&F.push(new a(y,I+n.C_PI,I+n.C_PI,k,!0));for(var Y=O.x+o.x+j.left,q=O.y+o.y-j.top,G=Y+j.width,J=q+j.height,X=new r.Point(Y-4,q-4),Z=new r.Point(X.x+N.width,X.y+N.height),W=new r.Point(X.x,Z.y),H=new r.Point(Z.x,X.y),K=0,Q=F;K<Q.length;K++){var $=Q[K],ee=X.clone(),te=W.clone(),re=H.clone(),ie=Z.clone(),ne=q,oe=J,ae=$.glyphAngle+m;if(0!==ae){var se=Math.cos(ae),le=Math.sin(ae);ee.rotate(se,le),ie.rotate(se,le),te.rotate(se,le),re.rotate(se,le)}T.push(new s(ee,re,te,ie,N,$.labelAngle,$.anchor,$.minzoom,$.maxzoom,$.page)),A&&!this._legible($.labelAngle)||(P?(Y<S&&(S=Y),ne<B&&(B=ne),G>M&&(M=G),oe>V&&(V=oe)):$.minzoom<2&&D.addBox($.anchor,new i.Box(Y,ne,G,oe),f,ae,t,$.minzoom,$.maxzoom))}}}if(b>=2)return null;P&&D.addBox(y,new i.Box(S,B,M,V),f,m,t,u,n.C_INFINITY);var ue=new l(D,T);return h.allowOverlap||(b=this._conflictEngine.getMinZoom(ue.footprint,b,p,_)),D.minzoom=b,ue},e.prototype.add=function(e){this._conflictEngine.add(e.footprint)},e.prototype._legible=function(e){var t=n.radToByte(e);return t<65||t>=193},e.prototype._placeGlyph=function(e,t,i,o,s,l,u,c){var f=l,d=f<0?n.positiveMod(e.angle+n.C_PI,n.C_2PI):e.angle,h=this._legible(d),p=0;i<0&&(f*=-1,i*=-1,p=n.C_PI),f>0&&++s;var v=new r.Point(e.x,e.y),y=o[s],m=n.C_INFINITY;if(o.length<=s)return m;for(;;){var x=y.x-v.x,g=y.y-v.y,b=Math.sqrt(x*x+g*g),_=Math.max(i/b,t),I=x/b,w=g/b,C=n.positiveMod(Math.atan2(w,I)+p,n.C_2PI);if(c.push(new a(v,d,C,u,h,_,m)),_<=t)return _;v=y.clone();do{if(s+=f,o.length<=s||s<0)return _;y=o[s]}while(v.isEqual(y));var D=y.x-v.x,T=y.y-v.y,P=Math.sqrt(D*D+T*T);D*=b/P,T*=b/P,v.x-=D,v.y-=T,m=_}},e}();t.PlacementEngine=c}.apply(null,i))||(e.exports=n)},1737:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(1535),r(1448),r(1516),r(1536),r(457),r(1736),r(1531)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c){function f(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page<t.iconMosaicItem.page?-1:1:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}return function(e){function t(t,r,i,n,o,a,s,l){var u=e.call(this,t,r)||this;if(u._markerMap=new Map,u._glyphMap=new Map,u._glyphBufferDataStorage=new Map,u._sdfMarkers=!1,t.hasDataDrivenIcon!==i.isDataDriven())throw new Error("incompatible icon buffer");if(t.hasDataDrivenText!==o.isDataDriven())throw new Error("incompatible text buffer");return u._iconVertexBuffer=i,u._iconIndexBuffer=n,u._textVertexBuffer=o,u._textIndexBuffer=a,u._placementEngine=s,u._workerTileHandler=l,u}return r(t,e),Object.defineProperty(t.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sdfMarker",{get:function(){return this._sdfMarkers},enumerable:!0,configurable:!0}),t.prototype.copy=function(e,r,i,n,o){var a=new t(this.layer,this.zoom,e,r,i,n,o,this._workerTileHandler);return a.layerIndex=this.layerIndex,a.layerExtent=this.layerExtent,a._iconIndexStart=r.index,a._textIndexStart=n.index,a._iconIndexCount=0,a._textIndexCount=0,a._symbolInstances=this._symbolInstances,a._workerTileHandler=this._workerTileHandler,a._fontArray=this._fontArray,a._textLayout=this._textLayout,a._iconLayout=this._iconLayout,a._isLinePlacement=this._isLinePlacement,a._avoidEdges=this._avoidEdges,a},t.prototype.getResources=function(e,r,i){var n=this.layer,o=this.zoom,a=n.hasDataDrivenIcon,s=n.hasDataDrivenText;e&&e.setExtent(this.layerExtent);for(var l=n.getLayoutProperty("icon-image"),u=n.getLayoutProperty("text-field"),c=n.getLayoutValue("text-font",o),f=n.getLayoutValue("text-transform",o),d=[],h=[1,1,1,1],p=1,v=1,y=[1,1,1,1],m=1,x=1,g=0,b=this._features;g<b.length;g++){var _=b[g],I=_.getGeometry(e);if(I&&0!==I.length){var w=void 0;l&&(w=n.getLayoutValue("icon-image",o,_),l.isDataDriven||(w=this._replaceKeys(w,_.values)),w&&r.add(w));var C=void 0,D=!1;if(u&&(C=n.getLayoutValue("text-field",o,_),u.isDataDriven||(C=this._replaceKeys(C,_.values)),C=C.replace(/\\n/g,"\n"))){switch(f){case 2:C=C.toLowerCase();break;case 1:C=C.toUpperCase()}if(t._bidiEngine.hasBidiChar(C)){var T;T="rtl"===t._bidiEngine.checkContextual(C)?"IDNNN":"ICNNN",C=t._bidiEngine.bidiTransform(C,T,"VLYSN"),D=!0}var P=C.length;if(P>0)for(var S=0,M=c;S<M.length;S++){var B=M[S],V=i[B];V||(V=i[B]=new Set);for(var A=0;A<P;A++){var E=C.charCodeAt(A);V.add(E)}}}if(w||C){var z=n.getLayoutValue("icon-size",o,_),O=n.getLayoutValue("text-size",o,_);n.hasDataDrivenIconColor&&(h=n.getPaintValue("icon-color",o,_)),n.hasDataDrivenIconOpacity&&(p=n.getPaintValue("icon-opacity",o,_)),n.hasDataDrivenIconSize&&(v=z),n.hasDataDrivenTextColor&&(y=n.getPaintValue("text-color",o,_)),n.hasDataDrivenTextOpacity&&(m=n.getPaintValue("text-opacity",o,_)),n.hasDataDrivenTextSize&&(x=O);var L={sprite:w,label:C,rtl:D,type:_.type,geometry:I,iconSize:z,iconRotate:n.getLayoutValue("icon-rotate",o,_),ddIconValues:a?{color:h,opacity:p,size:v}:null,textSize:O,textRotate:n.getLayoutValue("text-rotate",o,_),ddTextValues:s?{color:y,opacity:m,size:x}:null};d.push(L)}}}this._symbolFeatures=d},t.prototype.processFeatures=function(e,r){e&&e.setExtent(this.layerExtent);var i,n,o,s,d,h=this.layer,p=this.zoom,v=this._isLinePlacement=1===h.getLayoutValue("symbol-placement",p),y=this._avoidEdges=h.getLayoutValue("symbol-avoid-edges",p)&&!v,m=8*h.getLayoutValue("symbol-spacing",p),x=h.getLayoutProperty("icon-image"),g=h.getLayoutProperty("text-field"),b=this._workerTileHandler;if(x&&(this._iconLayout=new c.IconLayout(h,p,v),i=b.getSpriteItems(),n=this._getTranslate(!0)),g){var _=this._textLayout=new c.TextLayout(h,p,v);this._fontArray=_.fontArray;var I=.5;switch(_.anchor){case 5:case 1:case 7:I=0;break;case 6:case 2:case 8:I=1}var w=.5;switch(_.anchor){case 5:case 3:case 6:w=0;break;case 7:case 4:case 8:w=1}var C=.5;switch(_.justify){case 0:C=0;break;case 2:C=1}var D=24*_.letterSpacing,T=v?0:24*_.maxWidth,P=24*_.lineHeight,S=[24*_.offset[0],24*_.offset[1]];o=this._fontArray.map(function(e){return b.getGlyphItems(e)}),s=new a(o,T,P,D,S,I,w,C),d=this._getTranslate(!1)}this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var M=[];this._symbolInstances=M;var B=this._textLayout,V=1;B&&B.size&&(V=B.size/24);for(var A=B?B.maxAngle*l.C_DEG_TO_RAD:0,E=B?8*B.size:0,z=0,O=this._symbolFeatures;z<O.length;z++){var L=O[z],N=void 0;L.sprite&&(N=i[L.sprite])&&N.sdf&&(this._sdfMarkers=!0);var j=void 0,k=L.label,F=0;if(k&&(j=s.getShaping(k,L.rtl))&&j.length>0){for(var R=1e30,U=-1e30,Y=0,q=j;Y<q.length;Y++){var G=q[Y];R=Math.min(R,G.x),U=Math.max(U,G.x)}F=(U-R+48)*V*8}for(var J=0,X=L.geometry;J<X.length;J++){var Z=X[J],W=void 0;if(v){if(j&&j.length>0&&B&&B.size){var H=8*B.size*(2+Math.min(2,4*Math.abs(B.offset[1])));t._smoothVertices(Z,H)}W=t._findAnchors(Z,m,F)}else W=3===L.type?t._findCentroid(Z):[new u.Anchor(Z[0].x,Z[0].y)];for(var K=0,Q=W;K<Q.length;K++){var $=Q[K];$.x<0||$.x>4096||$.y<0||$.y>4096||v&&F>0&&0===B.rotationAlignment&&!t._honorsTextMaxAngle(Z,$,F,A,E)||M.push({shaping:j,line:Z,iconMosaicItem:N,anchor:$,iconSize:L.iconSize,iconRotate:L.iconRotate,ddIconValues:L.ddIconValues,textSize:L.textSize,textRotate:L.textRotate,ddTextValues:L.ddTextValues})}}}M.sort(f);for(var ee=0,te=M;ee<te.length;ee++){var re=te[ee];this._processFeature(re,n,d,y)}this._addPlacedGlyphs()},t.prototype.updateSymbols=function(){this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var e,t,r=this._avoidEdges,i=this.layer;i.getLayoutProperty("icon-image")&&(e=this._getTranslate(!0)),i.getLayoutProperty("text-field")&&(t=this._getTranslate(!1));for(var n=0,o=this._symbolInstances;n<o.length;n++){var a=o[n];this._processFeature(a,e,t,r)}this._addPlacedGlyphs()},t.prototype._getTranslate=function(e){var t=this.layer.getPaintValue(e?"icon-translate":"text-translate",this.zoom);if(0!==t[0]||0!==t[1]){var r=this._placementEngine.mapAngle;if(0!==r&&0===this.layer.getPaintValue(e?"icon-translate-anchor":"text-translate-anchor",this.zoom)){var i=Math.sin(r),n=Math.cos(r);return[8*(t[0]*n-t[1]*i),8*(t[0]*i+t[1]*n)]}return[8*t[0],8*t[1]]}},t.prototype._replaceKeys=function(e,t){return e.replace(/{([^{}]+)}/g,function(e,r){return r in t?t[r]:""})},t.prototype._processFeature=function(e,t,r,i){var n=e.line,a=e.iconMosaicItem,s=e.shaping,u=e.anchor,c=this._iconLayout,f=c&&!!a,d=!0,h=1;f&&(c.size=e.iconSize,c.rotate=e.iconRotate,h=8*c.size,d=c.optional||!a);var p=this._textLayout,v=p&&s&&s.length>0,y=1,m=y,x=!0;v&&(p.size=e.textSize,p.rotate=e.textRotate,m=8*(y=p.size/24),x=p.optional||!s||0===s.length);var g,b,_=new o.Point(0,-17);if((f&&(g=this._placementEngine.getIconPlacement(u,t,a,h,n,c,i),u.minzoom>g.footprint.minzoom&&(g.footprint.minzoom=u.minzoom),g.footprint.minzoom===l.C_INFINITY&&(g=null)),g||d)&&(v&&(b=this._placementEngine.getTextPlacement(u,r,_,s,m,n,p,i))&&(u.minzoom>b.footprint.minzoom&&(b.footprint.minzoom=u.minzoom),b.footprint.minzoom===l.C_INFINITY&&(b=null)),b||x)){if(g&&b||(x||d?x||b?d||g||(b=null):g=null:(g=null,b=null)),g&&b&&!x&&!d){var I=Math.max(g.footprint.minzoom,b.footprint.minzoom);g.footprint.minzoom=I,b.footprint.minzoom=I}b&&(p.ignorePlacement||this._placementEngine.add(b),this._storePlacedGlyphs(b.shapes,b.footprint.minzoom,this.zoom,e.ddTextValues)),g&&(c.ignorePlacement||this._placementEngine.add(g),this._addPlacedIcons(g.shapes,g.footprint.minzoom,this.zoom,a.page,e.ddIconValues))}},t.prototype._addPlacedIcons=function(e,t,r,i,n){for(var o=Math.max(r+l.log2(t),0),a=this._iconVertexBuffer,s=this._iconIndexBuffer,u=0,c=e;u<c.length;u++){var f=c[u],d=Math.max(r+l.log2(f.minzoom),o),h=Math.min(r+l.log2(f.maxzoom),25);if(!(h<=d)){var p=f.tl,v=f.tr,y=f.bl,m=f.br,x=f.mosaicRect,g=f.labelAngle,b=f.anchor,_=a.index,I=x.x,w=x.y,C=I+x.width,D=w+x.height;a.add(b.x,b.y,p.x,p.y,I,w,g,d,h,o,n),a.add(b.x,b.y,v.x,v.y,C,w,g,d,h,o,n),a.add(b.x,b.y,y.x,y.y,I,D,g,d,h,o,n),a.add(b.x,b.y,m.x,m.y,C,D,g,d,h,o,n),s.add(_+0,_+1,_+2),s.add(_+1,_+2,_+3),this._markerMap.has(i)?this._markerMap.get(i)[1]+=6:this._markerMap.set(i,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=2}}},t.prototype._addPlacedGlyphs=function(){var e=this,t=this._textVertexBuffer,r=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(i,n){for(var o=0,a=i;o<a.length;o++){var s=a[o],l=t.index;t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.tl[0],s.tl[1],s.xmin,s.ymin,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.tr[0],s.tr[1],s.xmax,s.ymin,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.bl[0],s.bl[1],s.xmin,s.ymax,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),t.add(s.glyphAnchor[0],s.glyphAnchor[1],s.br[0],s.br[1],s.xmax,s.ymax,s.labelAngle,s.minLod,s.maxLod,s.placementLod,s.ddValues),r.add(l+0,l+1,l+2),r.add(l+1,l+2,l+3),e._glyphMap.has(n)?e._glyphMap.get(n)[1]+=6:e._glyphMap.set(n,[e._textIndexStart+e._textIndexCount,6]),e._textIndexCount+=2}}),this._glyphBufferDataStorage.clear()},t.prototype._storePlacedGlyphs=function(e,t,r,i){for(var n=Math.max(r+l.log2(t),0),o=0,a=e;o<a.length;o++){var s=a[o],u=Math.max(r+l.log2(s.minzoom),n),c=Math.min(r+l.log2(s.maxzoom),25);if(!(c<=u)){var f=s.tl,d=s.tr,h=s.bl,p=s.br,v=s.labelAngle,y=s.anchor,m=s.mosaicRect;this._glyphBufferDataStorage.has(s.page)||this._glyphBufferDataStorage.set(s.page,[]),this._glyphBufferDataStorage.get(s.page).push({glyphAnchor:[y.x,y.y],tl:[f.x,f.y],tr:[d.x,d.y],bl:[h.x,h.y],br:[p.x,p.y],xmin:m.x,ymin:m.y,xmax:m.x+m.width,ymax:m.y+m.height,labelAngle:v,minLod:u,maxLod:c,placementLod:n,ddValues:i})}}},t._findAnchors=function(e,t,r){t+=r;for(var i=0,n=e.length-1,a=0;a<n;a++)i+=o.Point.distance(e[a],e[a+1]);var s=r||t;if(i<=(s*=.5))return[];var c=s/i,f=0,d=-(t=i/Math.max(Math.round(i/t),1))/2,h=[],p=e.length-1;for(a=0;a<p;a++){for(var v=e[a],y=e[a+1],m=y.x-v.x,x=y.y-v.y,g=Math.sqrt(m*m+x*x),b=void 0;d+t<f+g;){var _=((d+=t)-f)/g,I=l.interpolate(v.x,y.x,_),w=l.interpolate(v.y,y.y,_);void 0===b&&(b=Math.atan2(x,m)),h.push(new u.Anchor(I,w,b,a,c))}f+=g}return h},t._deviation=function(e,t,r){var i=(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y),n=(t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x);return Math.atan2(n,i)},t._honorsTextMaxAngle=function(e,t,r,i,n){for(var a=0,s=r/2,l=new o.Point(t.x,t.y),u=t.segment+1;a>-s;){if(--u<0)return!1;a-=o.Point.distance(e[u],l),l=e[u]}a+=o.Point.distance(e[u],e[u+1]);for(var c=[],f=0,d=e.length;a<s;){var h=e[u],p=u,v=void 0;do{if(++p===d)return!1;v=e[p]}while(v.isEqual(h));var y=p,m=void 0;do{if(++y===d)return!1;m=e[y]}while(m.isEqual(v));var x=this._deviation(h,v,m);for(c.push({deviation:x,distToAnchor:a}),f+=x;a-c[0].distToAnchor>n;)f-=c.shift().deviation;if(Math.abs(f)>i)return!1;a+=o.Point.distance(v,m),u=p}return!0},t._smoothVertices=function(e,t){if(!(t<=0)){var r=e.length;if(!(r<3)){var i=[],n=0;i.push(0);for(var a=1;a<r;a++)n+=o.Point.distance(e[a],e[a-1]),i.push(n);t=Math.min(t,.2*n);var s=[];s.push(e[0].x),s.push(e[0].y);var l=e[r-1].x,u=e[r-1].y,c=o.Point.sub(e[0],e[1]);c.normalize(),e[0].x+=t*c.x,e[0].y+=t*c.y,c.assignSub(e[r-1],e[r-2]),c.normalize(),e[r-1].x+=t*c.x,e[r-1].y+=t*c.y;for(a=1;a<r;a++)i[a]+=t;i[r-1]+=t;var f=.5*t;for(a=1;a<r-1;a++){for(var d=0,h=0,p=0,v=a-1;v>=0&&!(i[v+1]<i[a]-f);v--){var y=f+i[v+1]-i[a],m=i[v+1]-i[v],x=i[a]-i[v]<f?1:y/m;if(Math.abs(x)<1e-6)break;var g=x*y-.5*(C=x*x)*m,b=x*m/t,_=e[v+1],I=e[v].x-_.x,w=e[v].y-_.y;d+=b/g*(_.x*x*y+.5*C*(y*I-m*_.x)-C*x*m*I/3),h+=b/g*(_.y*x*y+.5*C*(y*w-m*_.y)-C*x*m*w/3),p+=b}for(v=a+1;v<r&&!(i[v-1]>i[a]+f);v++){y=f-i[v-1]+i[a],m=i[v]-i[v-1],x=i[v]-i[a]<f?1:y/m;if(Math.abs(x)<1e-6)break;var C;g=x*y-.5*(C=x*x)*m,b=x*m/t,_=e[v-1],I=e[v].x-_.x,w=e[v].y-_.y;d+=b/g*(_.x*x*y+.5*C*(y*I-m*_.x)-C*x*m*I/3),h+=b/g*(_.y*x*y+.5*C*(y*w-m*_.y)-C*x*m*w/3),p+=b}s.push(d/p),s.push(h/p)}s.push(l),s.push(u);for(a=0,v=0;a<r;a++)e[a].x=s[v++],e[a].y=s[v++]}}},t._findCentroid=function(e){var t=e.length-1,r=0,i=0,n=0,o=e[0].x,a=e[0].y;o>4096&&(o=4096),o<0&&(o=0),a>4096&&(a=4096),a<0&&(a=0);for(var s=1;s<t;s++){var l=e[s].x,c=e[s].y,f=e[s+1].x,d=e[s+1].y;l>4096&&(l=4096),l<0&&(l=0),c>4096&&(c=4096),c<0&&(c=0),f>4096&&(f=4096),f<0&&(f=0),d>4096&&(d=4096),d<0&&(d=0);var h=(l-o)*(d-a)-(f-o)*(c-a);r+=h*(o+l+f),i+=h*(a+c+d),n+=h}return r/=3*n,i/=3*n,isNaN(r)||isNaN(i)?[]:[new u.Anchor(r,i)]},t._bidiEngine=new n,t}(s)}.apply(null,i))||(e.exports=n)},2067:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(25),r(1732),r(92),r(8),r(1313),r(1733),r(1734),r(1731),r(457),r(2068),r(1735),r(1736),r(1737),r(2070),r(2073)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c,f,d,h,p,v,y){return function(){function e(){this.rotation=0,this.status=a.TileStatus.INITIALIZED,this._symbolBuckets=[],this.placementEngine=new h.PlacementEngine,this.fillVertexBuffer=new y.FillVertexBuffer(!1),this.fillDDVertexBuffer=new y.FillVertexBuffer(!0),this.fillIndexBuffer=new f.TriangleIndexBuffer,this.outlineVertexBuffer=new y.OutlineVertexBuffer(!1),this.outlineDDVertexBuffer=new y.OutlineVertexBuffer(!0),this.outlineIndexBuffer=new f.TriangleIndexBuffer,this.lineVertexBuffer=new y.LineVertexBuffer(!1),this.lineDDVertexBuffer=new y.LineVertexBuffer(!0),this.lineIndexBuffer=new f.TriangleIndexBuffer,this.iconVertexBuffer=new y.SymbolVertexBuffer(!1),this.iconDDVertexBuffer=new y.SymbolVertexBuffer(!0),this.iconIndexBuffer=new f.TriangleIndexBuffer,this.textVertexBuffer=new y.SymbolVertexBuffer(!1),this.textDDVertexBuffer=new y.SymbolVertexBuffer(!0),this.textIndexBuffer=new f.TriangleIndexBuffer,this.circleVertexBuffer=new y.CircleVertexBuffer,this.circleIndexBuffer=new f.TriangleIndexBuffer}return e.prototype.initialize=function(e,t,r,i){void 0===i&&(i=0),this.tileKey=e,this.refKey=t,this._workerTileHandler=r,this.rotation=i,this.placementEngine.setAngle(c.C_DEG_TO_RAD*i)},e.prototype.release=function(){this.tileKey=this.refKey="",this.status=a.TileStatus.INITIALIZED,this.rotation=0,this.fillVertexBuffer.reset(),this.fillDDVertexBuffer.reset(),this.fillIndexBuffer.reset(),this.outlineVertexBuffer.reset(),this.outlineDDVertexBuffer.reset(),this.outlineIndexBuffer.reset(),this.lineVertexBuffer.reset(),this.lineDDVertexBuffer.reset(),this.lineIndexBuffer.reset(),this.iconVertexBuffer.reset(),this.iconDDVertexBuffer.reset(),this.iconIndexBuffer.reset(),this.textVertexBuffer.reset(),this.textDDVertexBuffer.reset(),this.textIndexBuffer.reset(),this.circleVertexBuffer.reset(),this.circleIndexBuffer.reset(),this.placementEngine.reset(),this._symbolBuckets.length=0,this._workerTileHandler=null},e.prototype.setDataAndParse=function(e,t){var i=this,n=new r(function(e){i.status=a.TileStatus.INVALID});return this._parse(e,t).then(function(e){i.status=a.TileStatus.READY;for(var t=[1,i.fillVertexBuffer.sizeInBytes,2,i.fillDDVertexBuffer.sizeInBytes,3,i.fillIndexBuffer.sizeInBytes,4,i.outlineVertexBuffer.sizeInBytes,5,i.outlineDDVertexBuffer.sizeInBytes,6,i.outlineIndexBuffer.sizeInBytes,7,i.lineVertexBuffer.sizeInBytes,8,i.lineDDVertexBuffer.sizeInBytes,9,i.lineIndexBuffer.sizeInBytes,10,i.iconVertexBuffer.sizeInBytes,11,i.iconDDVertexBuffer.sizeInBytes,12,i.iconIndexBuffer.sizeInBytes,13,i.textVertexBuffer.sizeInBytes,14,i.textDDVertexBuffer.sizeInBytes,15,i.textIndexBuffer.sizeInBytes,16,i.circleVertexBuffer.sizeInBytes,17,i.circleIndexBuffer.sizeInBytes],r=new Uint32Array(t),o=[],c=e.length,f=0;f<c;f++){var h=e[f];if(h instanceof u)o.push(h.layerIndex),o.push(1),o.push(h.fillIndexStart),o.push(h.fillIndexCount),o.push(h.outlineIndexStart),o.push(h.outlineIndexCount);else if(h instanceof d)o.push(h.layerIndex),o.push(2),o.push(h.lineIndexStart),o.push(h.lineIndexCount);else if(h instanceof p){o.push(h.layerIndex),o.push(3),o.push(h.sdfMarker?1:0);var v=h.markerPageMap;o.push(v.size),v.forEach(function(e,t){o.push(t),o.push(e[0]),o.push(e[1])});var y=h.glyphsPageMap;o.push(y.size),y.forEach(function(e,t){o.push(t),o.push(e[0]),o.push(e[1])})}else h instanceof l?(o.push(h.layerIndex),o.push(4),o.push(h.circleIndexStart),o.push(h.circleIndexCount)):h instanceof s&&(o.push(h.layerIndex),o.push(0))}var m=new Uint32Array(o),x=i.fillVertexBuffer.toBuffer(),g=i.fillDDVertexBuffer.toBuffer(),b=i.fillIndexBuffer.toBuffer(),_=i.outlineVertexBuffer.toBuffer(),I=i.outlineDDVertexBuffer.toBuffer(),w=i.outlineIndexBuffer.toBuffer(),C=i.lineVertexBuffer.toBuffer(),D=i.lineDDVertexBuffer.toBuffer(),T=i.lineIndexBuffer.toBuffer(),P=i.iconVertexBuffer.toBuffer(),S=i.iconDDVertexBuffer.toBuffer(),M=i.iconIndexBuffer.toBuffer(),B=i.textVertexBuffer.toBuffer(),V=i.textDDVertexBuffer.toBuffer(),A=i.textIndexBuffer.toBuffer(),E=i.circleVertexBuffer.toBuffer(),z=i.circleIndexBuffer.toBuffer();n.resolve({result:{bufferDataInfo:r.buffer,bucketDataInfo:m.buffer,bufferData:[x,g,b,_,I,w,C,D,T,P,S,M,B,V,A,E,z]},transferList:[x,g,b,_,I,w,C,D,T,P,S,M,B,V,A,E,z,r.buffer,m.buffer]})}),n.promise},e.prototype.addBucket=function(e){this._symbolBuckets.push(e)},e.prototype.updateSymbols=function(e){var t=this,r=this._symbolBuckets;if(!r||0===r.length)return o.resolve();this.rotation=e;var n=this.placementEngine;n.reset(),n.setAngle(e/256*360*c.C_DEG_TO_RAD);var s=this.iconVertexBuffer;s.reset();var l=this.iconDDVertexBuffer;l.reset();var u=this.iconIndexBuffer;u.reset();var f=this.textVertexBuffer;f.reset();var d=this.textDDVertexBuffer;d.reset();var h=this.textIndexBuffer;h.reset();var p=[],v=r.length,y=0;return i(function(){if(t.status===a.TileStatus.INVALID||t.status===a.TileStatus.INITIALIZED)return!0;if(y<v){var e=r[y++],i=e.layer,o=e.copy(i.hasDataDrivenIcon?l:s,u,i.hasDataDrivenText?d:f,h,n);o&&(p.push(o),o.updateSymbols())}return y>=v}).then(function(){if(t.status===a.TileStatus.INVALID||t.status===a.TileStatus.INITIALIZED||0===s.sizeInBytes&&0===l.sizeInBytes&&0===u.sizeInBytes&&0===f.sizeInBytes&&0===d.sizeInBytes&&0===h.sizeInBytes)return{result:null,transferList:null};var e=[10,s.sizeInBytes,11,l.sizeInBytes,12,u.sizeInBytes,13,f.sizeInBytes,14,d.sizeInBytes,15,h.sizeInBytes],r=new Uint32Array(e),i=[];v=p.length;for(var n=0;n<v;n++){var o=p[n];i.push(o.layerIndex),i.push(3),i.push(o.sdfMarker?1:0);var c=o.markerPageMap;i.push(c.size),c.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])});var y=o.glyphsPageMap;i.push(y.size),y.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])})}var m=new Uint32Array(i),x=s.toBuffer(),g=l.toBuffer(),b=u.toBuffer(),_=f.toBuffer(),I=d.toBuffer(),w=h.toBuffer();return{result:{bufferDataInfo:r.buffer,bucketDataInfo:m.buffer,bufferData:[x,g,b,_,I,w]},transferList:[x,g,b,_,I,w,r.buffer,m.buffer]}}).catch(function(){return null})},e.prototype.setObsolete=function(){this.status=a.TileStatus.INVALID},e.prototype.getLayers=function(){return this._workerTileHandler.getLayers()},e.prototype.getWorkerTileHandler=function(){return this._workerTileHandler},e.prototype._parse=function(e,t){return e&&0!==e.byteLength?(this.status=a.TileStatus.MODIFIED,new v(e,this,t).parse()):o.resolve([])},e.pool=new n(e),e}()}.apply(null,i))||(e.exports=n)},2068:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(1605)],void 0===(n=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this,12)||this}return r(t,e),t.prototype.add=function(e,t,r){var i=this.array;i.push(e),i.push(t),i.push(r)},t}(n);t.TriangleIndexBuffer=o;var a=function(e){function t(){return e.call(this,4)||this}return r(t,e),t.prototype.add=function(e){this.array.push(e)},t}(n);t.PointElementMemoryBuffer=a}.apply(null,i))||(e.exports=n)},2069:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1448),r(457)],void 0===(n=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t,r,i){this.left=e,this.top=t,this.right=r,this.bottom=i}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.move=function(e,t){this.left+=e,this.top+=t,this.right+=e,this.bottom+=t},e.prototype.rotate=function(e,t){var r=this.left,i=this.right,n=this.top,o=this.bottom,a=r*e-n*t,s=r*t+n*e,l=i*e-n*t,u=i*t+n*e,c=r*e-o*t,f=r*t+o*e,d=i*e-o*t,h=i*t+o*e;this.left=Math.min(a,l,c,d),this.top=Math.min(s,u,f,h),this.right=Math.max(a,l,c,d),this.bottom=Math.max(s,u,f,h)},e.overlaps=function(e,t){return e.right>t.left&&e.left<t.right&&e.bottom>t.top&&e.top<t.bottom},e}();t.Box=n;var o=function(){function e(e,t,r,i){this.anchor=e,this.corners=t,this.minzoom=r,this.maxzoom=i}return e.prototype.left=function(){return this.corners[0].x},e.prototype.right=function(){return this.corners[2].x},e.prototype.top=function(){return this.corners[1].y},e.prototype.bottom=function(){return this.corners[3].y},e}();t.Obstacle=o;var a=function(){function e(e,t,r){this.obstacles=[],this.mapAngle=e,this.padding=t,this.isScreenAligned=r,this.minzoom=s}return e.prototype.addBox=function(e,t,i,n,a,s,l){var u=t.left*i-this.padding,c=t.top*i-this.padding,f=t.right*i+this.padding,d=t.bottom*i+this.padding,h=[new r.Point(u,c),new r.Point(f,c),new r.Point(f,d),new r.Point(u,d)];if(0!==this.mapAngle){var p=Math.cos(this.mapAngle),v=Math.sin(this.mapAngle);(e=e.clone()).rotate(p,v)}if(this.isScreenAligned||(n+=this.mapAngle),0!==n){p=Math.cos(n),v=Math.sin(n);h[0].rotate(p,v),h[1].rotate(p,v),h[2].rotate(p,v),h[3].rotate(p,v);for(var y=0,m=1;m<4;m++)h[m].x<h[y].x?y=m:h[m].x===h[y].x&&h[m].y<h[y].y&&(y=m);if(y){var x=[];for(m=0;m<4;m++)x.push(h[(m+y)%4]);h=x}}if(a)for(var g=0,b=h;g<b.length;g++){b[g].move(a[0],a[1])}this.obstacles.push(new o(e,h,s,l))},e}();t.Footprint=a;var s=.5,l=function(){function e(){this._grid=[]}return e.prototype.setAngle=function(e){},e.prototype.reset=function(){this._grid=[]},e.prototype.add=function(t){for(var r=this._grid,i=0,n=t.obstacles;i<n.length;i++)for(var o=n[i],a=o.anchor,s=e._gridClamp(Math.min(o.left()+a.x,a.x)),l=e._gridClamp(Math.max(o.right()+a.x,a.x)),u=e._gridClamp(Math.min(o.top()+a.y,a.y)),c=e._gridClamp(Math.max(o.bottom()+a.y,a.y)),f=u;f<=c;f++)for(var d=s;d<=l;d++){var h=r[16*f+d];h||(h=r[16*f+d]=[]),h.push(o)}},e.prototype.getMinZoom=function(t,r,n,o){if(0===t.obstacles.length)return i.C_INFINITY;for(var a=r,s=this._grid,l=0,u=t.obstacles;l<u.length;l++)for(var c=u[l],f=c.anchor,d=e._gridClamp(Math.min(c.left()+f.x,f.x)),h=e._gridClamp(Math.max(c.right()+f.x,f.x)),p=e._gridClamp(Math.min(c.top()+f.y,f.y)),v=e._gridClamp(Math.max(c.bottom()+f.y,f.y)),y=p;y<=v;y++)for(var m=d;m<=h;m++){var x=s[16*y+m];if(x)for(var g=0,b=x;g<b.length;g++){var _=b[g];if(!(c.minzoom>=_.maxzoom||_.minzoom>=c.maxzoom)&&(a=e._calcPlacementZoom(c,_,a))>=2)return i.C_INFINITY}}return a<2?a:i.C_INFINITY},e._gridClamp=function(e){return i.clamp(e>>9,-7,8)},e._calcPlacementZoom=function(t,r,n){var o=r.anchor.x-t.anchor.x;if(0===o&&(t.right()<r.left()||r.right()<t.left()))return n;var a=r.anchor.y-t.anchor.y;if(0===a&&(t.bottom()<r.top()||r.bottom()<t.top()))return n;var s=i.C_INFINITY;if(0!==o){var l=(o>0?t.right()-r.left():t.left()-r.right())/o;l<s&&(s=l);var u=o>0?e._calcExtZoomX(t,r,l):e._calcExtZoomX(r,t,l);u<s&&(s=u)}if(0!==a){var c=(a>0?t.bottom()-r.top():t.top()-r.bottom())/a;c<s&&(s=c);var f=a>0?e._calcExtZoomY(t,r,c):e._calcExtZoomY(r,t,c);f<s&&(s=f)}return s<t.minzoom||s<r.minzoom?n:((s=Math.min(s,t.maxzoom,r.maxzoom))<n&&(s=n),s)},e._calcExtZoomX=function(e,t,r){var i,n,o,a;if(e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[0].y/r){var s=e.corners[2].x-e.corners[3].x,l=e.corners[2].y-e.corners[3].y,u=t.corners[1].x-t.corners[0].x;s*(t.corners[1].y-t.corners[0].y)-l*u>=0?e.anchor.y+e.corners[3].y/r<t.anchor.y+t.corners[0].y/r?(i=e.corners[3],n=t.corners[0],o=t.corners[1],a=1):(i=t.corners[0],n=e.corners[3],o=e.corners[2],a=-1):e.anchor.y+e.corners[2].y/r>t.anchor.y+t.corners[1].y/r?(i=e.corners[2],n=t.corners[0],o=t.corners[1],a=1):(i=t.corners[1],n=e.corners[3],o=e.corners[2],a=-1)}else{s=e.corners[2].x-e.corners[1].x,l=e.corners[2].y-e.corners[1].y,u=t.corners[3].x-t.corners[0].x;s*(t.corners[3].y-t.corners[0].y)-l*u<0?e.anchor.y+e.corners[1].y/r>t.anchor.y+t.corners[0].y/r?(i=e.corners[1],n=t.corners[0],o=t.corners[3],a=1):(i=t.corners[0],n=e.corners[1],o=e.corners[2],a=-1):e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[3].y/r?(i=e.corners[2],n=t.corners[0],o=t.corners[3],a=1):(i=t.corners[3],n=e.corners[1],o=e.corners[2],a=-1)}var c=o.x-n.x,f=o.y-n.y;return a*((i.y-n.y)*c-(i.x-n.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*c)},e._calcExtZoomY=function(e,t,r){var i,n,o,a;if(e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[1].x/r){var s=e.corners[3].x-e.corners[2].x,l=e.corners[3].y-e.corners[2].y,u=t.corners[0].x-t.corners[1].x;s*(t.corners[0].y-t.corners[1].y)-l*u<0?e.anchor.x+e.corners[2].x/r<t.anchor.x+t.corners[1].x/r?(i=e.corners[2],n=t.corners[1],o=t.corners[0],a=1):(i=t.corners[1],n=e.corners[2],o=e.corners[3],a=-1):e.anchor.x+e.corners[3].x/r>t.anchor.x+t.corners[0].x/r?(i=e.corners[3],n=t.corners[1],o=t.corners[0],a=1):(i=t.corners[0],n=e.corners[2],o=e.corners[3],a=-1)}else{s=e.corners[3].x-e.corners[0].x,l=e.corners[3].y-e.corners[0].y,u=t.corners[2].x-t.corners[1].x;s*(t.corners[2].y-t.corners[1].y)-l*u>0?e.anchor.x+e.corners[0].x/r>t.anchor.x+t.corners[1].x/r?(i=e.corners[0],n=t.corners[1],o=t.corners[2],a=1):(i=t.corners[1],n=e.corners[0],o=e.corners[3],a=-1):e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[2].x/r?(i=e.corners[3],n=t.corners[1],o=t.corners[2],a=1):(i=t.corners[2],n=e.corners[0],o=e.corners[3],a=-1)}var c=o.x-n.x,f=o.y-n.y;return a*((i.y-n.y)*c-(i.x-n.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*c)},e}();t.ConflictEngine=l}.apply(null,i))||(e.exports=n)},2070:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(82),r(1732),r(492),r(8),r(1517),r(1313),r(1733),r(1734),r(2071),r(1731),r(1735),r(2072),r(1737)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c,f,d,h,p){return function(){function e(e,t,r){this._pbfTile=new n(new Uint8Array(e),new DataView(e)),this._tile=t,this._connection=r,this._layers=t.getLayers();var i=t.tileKey.split("/").map(parseFloat),o=i[0],s=i[1],l=i[2];if(this._level=o,t.refKey){var u=o-t.refKey.split("/").map(parseFloat)[0];if(u>0){var c=(1<<u)-1,f=s&c,d=l&c;this._tileClipper=new a.TileClipper(u,f,d)}}this._tileClipper||(this._tileClipper=new a.SimpleBuilder)}return e.prototype.parse=function(){for(var e,t=this,n=this._parseTileData(this._pbfTile),a=this._layers,l=a.length,u=this._level,f=[],d={},h=new Set,p=l-1;p>=0;p--)if(!((e=a[p]).minzoom&&u<e.minzoom||e.maxzoom&&u>=e.maxzoom||e.layout&&"none"===e.layout.visibility))if(0!==e.type){var v=e.sourceLayer,y=n[v];if(y)if(h.add(v),x=this._createBucket(e)){x.layerIndex=p,x.layerExtent=y.extent;var m=d[v];m||(m=d[v]=[]),m.push(x)}}else{var x;(x=this._createBucket(e)).layerIndex=p,f.push(x)}var g=10*this._level,b=10*(this._level+1),_=[],I=[],w=[],C=[],D=this._tileClipper,T=new Set,P={},S=[];h.forEach(function(e){return S.push(e)});var M=0,B=0,V=S.length;return i(function(){if(t._tile.status===s.TileStatus.INVALID)return!0;switch(M){case 0:if(B<V){var e=S[B++],r=n[e];if(!(v=d[e])||0===v.length)break;for(var i=r.getData();i.next(2);){var o=new c(i.getMessage(),r),a=o.values;if(a){var l=a._minzoom;if(l&&l>=b)continue;var u=a._maxzoom;if(u&&u<=g)continue}for(var f=0,h=v;f<h.length;f++){(x=h[f]).pushFeature(o)}}}else{var p=t._tile;for(var e in d)for(var v,y=0,m=v=d[e];y<m.length;y++){var x;(x=m[y]).hasFeatures()&&(3===x.layer.type?(_.push(x),p.addBucket(x)):x.layer.refLayerId?w.push(x):(I.push(x),C[x.layer.id]=x))}M=1,B=0,V=_.length}break;case 1:B<V?_[B++].getResources(D,T,P):M=2}return 2===M}).then(function(){if(t._tile.status===s.TileStatus.INVALID)return[];var e,n,a=[],l=t._tile.getWorkerTileHandler();for(var u in T.size>0&&(e=l.fetchSprites(T,t._connection),a.push(e)),P){var c=P[u];c.size>0&&(n=l.fetchGlyphs(t._tile.tileKey,u,c,t._connection),a.push(n))}return r(a).then(function(e){if(t._tile.status===s.TileStatus.INVALID)return[];var r=0,n=0,o=I.length;return i(function(){if(t._tile.status===s.TileStatus.INVALID)return!0;switch(r){case 0:if(n<o)(a=I[n++]).processFeatures(D,t._tile),f.push(a);else r=1,n=0,o=w.length;break;case 1:for(var e=0,i=w;e<i.length;e++){var a=i[e],l=C[a.layer.refLayerId];l&&(l.assignBufferInfo(a),f.push(a))}r=2,n=0,o=_.length;break;case 2:if(n<o)(a=_[n++]).processFeatures(D,t._tile),f.push(a);else r=3}return 3===r}).then(function(){return f.sort(function(e,t){return e.layerIndex-t.layerIndex}),f})}).catch(function(e){return o.reject(new Error(e))})}).catch(function(e){return o.reject(new Error(e))})},e.prototype._parseTileData=function(e){for(var t={};e.next();)switch(e.tag()){case 3:var r=new h(e.getMessage());t[r.name]=r;break;default:e.skip()}return t},e.prototype._createBucket=function(e){switch(e.type){case 0:return this._createBackgroundBucket(e);case 1:return this._createFillBucket(e);case 2:return this._createLineBucket(e);case 4:return this._createCircleBucket(e);case 3:return this._createSymbolBucket(e)}},e.prototype._createBackgroundBucket=function(e){return new l(e,this._level)},e.prototype._createFillBucket=function(e){var t=this._tile;return new f(e,this._level,e.hasDataDrivenFill?t.fillDDVertexBuffer:t.fillVertexBuffer,t.fillIndexBuffer,e.hasDataDrivenOutline?t.outlineDDVertexBuffer:t.outlineVertexBuffer,t.outlineIndexBuffer)},e.prototype._createLineBucket=function(e){var t=this._tile;return new d(e,this._level,e.hasDataDrivenLine?t.lineDDVertexBuffer:t.lineVertexBuffer,t.lineIndexBuffer)},e.prototype._createCircleBucket=function(e){var t=this._tile;return new u(e,this._level,t.circleVertexBuffer,t.circleIndexBuffer)},e.prototype._createSymbolBucket=function(e){var t=this._tile;return new p(e,this._level,e.hasDataDrivenIcon?t.iconDDVertexBuffer:t.iconVertexBuffer,t.iconIndexBuffer,e.hasDataDrivenText?t.textDDVertexBuffer:t.textVertexBuffer,t.textIndexBuffer,t.placementEngine,t.getWorkerTileHandler())},e}()}.apply(null,i))||(e.exports=n)},2071:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(1448)],void 0===(n=function(e,t,r){return function(){function e(e,t){this.values={};for(var r=t.keys,i=t.values;e.next();)switch(e.tag()){case 1:this.id=e.getUInt64();break;case 2:for(var n=e.getMessage(),o=this.values;!n.empty();){var a=n.getUInt32(),s=n.getUInt32();o[r[a]]=i[s]}break;case 3:this.type=e.getUInt32();break;case 4:this._pbfGeometry=e.getMessage();break;default:e.skip()}}return e.prototype.getGeometry=function(e){if(void 0!==this._geometry)return this._geometry;var t,i,n,o=this._pbfGeometry;e?e.reset(this.type):t=[];for(var a=1,s=0,l=0,u=0;!o.empty();){if(0===s){var c=o.getUInt32();a=7&c,s=c>>3}switch(s--,a){case 1:l+=o.getSInt32(),u+=o.getSInt32(),e?e.moveTo(l,u):(i&&t.push(i),(i=[]).push(new r.Point(l,u)));break;case 2:l+=o.getSInt32(),u+=o.getSInt32(),e?e.lineTo(l,u):i.push(new r.Point(l,u));break;case 7:e?e.close():i&&!i[0].equals(l,u)&&i.push(i[0].clone());break;default:throw new Error("Invalid path operation")}}return e?n=e.result():(i&&t.push(i),n=t),this._geometry=n,n},e}()}.apply(null,i))||(e.exports=n)},2072:function(e,t,r){var i,n;i=[r.dj.c(e.i),t],void 0===(n=function(e,t){return function(){function e(t){for(this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(e._parseValue(t.getMessage()));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return e.prototype.getData=function(){return this._pbfLayer},e._parseValue=function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null},e}()}.apply(null,i))||(e.exports=n)},2073:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(457),r(1605)],void 0===(n=function(e,t,r,i,n,o){Object.defineProperty(t,"__esModule",{value:!0});var a=new Float32Array(1),s=new Uint32Array(a.buffer),l=function(e){function t(t){var r=e.call(this,t?20:12)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,n,l,u,c){var f=this.array,d=o.i1616to32(e,t);if(f.push(d),d=o.i8888to32(Math.round(31*r),Math.round(31*i),Math.round(31*n),Math.round(31*l)),f.push(d),d=o.i1616to32(u,0),f.push(d),this._isDataDriven){if(!c)throw new Error("Expecting data driven values.");var h=c.color,p=h[3]*c.opacity*255;f.push(o.i8888to32(h[0]*p,h[1]*p,h[2]*p,p)),a[0]=c.size,f.push(s[0])}},t}(o);t.LineVertexBuffer=l;var u=function(e){function t(t){var r=e.call(this,t?8:4)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r){var i=this.array;if(i.push(o.i1616to32(e,t)),this._isDataDriven){if(!r)throw new Error("Expecting data driven values.");var n=r.color,a=n[3]*r.opacity*255;i.push(o.i8888to32(n[0]*a,n[1]*a,n[2]*a,a))}},t}(o);t.FillVertexBuffer=u;var c=function(e){function t(t){var r=e.call(this,t?12:8)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,n,a,s){var l=this.array,u=this.index,c=o.i1616to32(e,t);if(l.push(c),c=o.i8888to32(Math.round(15*r),Math.round(15*i),n,a),l.push(c),this._isDataDriven){if(!s)throw new Error("Expecting data driven values.");var f=s.color,d=f[3]*s.opacity*255;l.push(o.i8888to32(f[0]*d,f[1]*d,f[2]*d,d))}return u},t}(o);t.OutlineVertexBuffer=c;var f=function(e){function t(t){var r=e.call(this,t?24:16)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,i,l,u,c,f,d,h,p){var v=this.array,y=o.i1616to32(e,t);if(v.push(y),y=o.i1616to32(Math.round(8*r),Math.round(8*i)),v.push(y),y=o.i8888to32(l/4,u/4,0,0),v.push(y),y=o.i8888to32(Math.ceil(10*h),n.radToByte(c),10*f,Math.min(10*d,255)),v.push(y),this._isDataDriven){if(!p)throw new Error("Expecting data driven values.");var m=p.color,x=m[3]*p.opacity*255;v.push(o.i8888to32(m[0]*x,m[1]*x,m[2]*x,x)),a[0]=p.size,v.push(s[0])}},t}(o);t.SymbolVertexBuffer=f;var d=function(e){function t(){return e.call(this,16)||this}return r(t,e),t.prototype.add=function(e,t,r,i,n,a,s,l,u,c,f){var d=this.array,h=o.i1616to32(2*e+r,2*t+i);d.push(h);var p=a[3]*s*255;h=o.i8888to32(a[0]*p,a[1]*p,a[2]*p,p),d.push(h);var v=c[3]*f*255;h=o.i8888to32(c[0]*v,c[1]*v,c[2]*v,v),d.push(h),h=o.i8888to32(Math.min(32*l,255),Math.min(4*u,255),Math.min(n,255),0),d.push(h)},t}(o);t.CircleVertexBuffer=d}.apply(null,i))||(e.exports=n)},2074:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(8)],void 0===(n=function(e,t,i,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createProcessor=function(e,t){var o;return"heatmap"===e?o=n.create(function(e){return r.e(68).then(function(){var t=[r(2174)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"symbol"===e&&(o=n.create(function(e){return Promise.all([r.e(11),r.e(77)]).then(function(){var t=[r(2175)];e.apply(null,t)}.bind(this)).catch(r.oe)})),o.then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,n=t.remoteClient,o=t.tileStore;return new e(i({},r,{tileStore:o,remoteClient:n}))})}}.apply(null,i))||(e.exports=n)},2075:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(1450),r(10),r(1738),r(1518),r(1635),r(1346),r(168)],void 0===(n=function(e,t,r,i,n,o,a,s,l,u,c){Object.defineProperty(t,"__esModule",{value:!0});var f={added:[],removed:[]},d=new n.default,h=new c(0,0,0,0),p=function(e){function t(t){var r=e.call(this)||this;return r._tiles=new Map,r._index=a(9,o("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),r.tiles=[],r.tileInfo=t,r._tileInfoView=new s.TileInfoView(t),r.spatialReference=t.spatialReference,r}return r(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var r="string"==typeof e?this.get(e):e;if(!r)return[];for(var i=t*r.resolution,n=r.bounds[0]-i,o=r.bounds[1]-i,a=r.bounds[2]+i,s=r.bounds[3]+i,l=[],u=0,c=this._index.search({minX:n,minY:o,maxX:a,maxY:s});u<c.length;u++){var f=c[u],d=f.bounds.slice();d[0]=Math.max(d[0],n),d[1]=Math.max(d[1],o),d[2]=Math.min(d[2],a),d[3]=Math.min(d[3],s),d[2]-d[0]>0&&d[3]-d[1]>0&&l.push({bounds:d,tile:f})}return l},t.prototype.setViewState=function(e){var t=this._tileInfoView.getTileCoverage(e,0);if(t){var r=t.spans,i=t.lodInfo,n=i.level;if(r.length>0)for(var o=0,a=r;o<a.length;o++)for(var s=a[o],u=s.row,c=s.colFrom,p=s.colTo,v=c;v<=p;v++){var y=h.set(n,u,i.normalizeCol(v),i.getWorldForColumn(v)).id;if(d.add(y),!this.has(y)){var m=new l.default(this._tileInfoView,y);this._tiles.set(y,m),this._index.insert(m),this.tiles.push(m),f.added.push(m)}}for(var x=this.tiles.length-1;x>=0;x--){m=this.tiles[x];d.has(m.id)||(this._tiles.delete(m.id),this.tiles.splice(x,1),this._index.remove(m),f.removed.push(m))}(f.added.length||f.removed.length)&&this.emit("update",f),d.clear(),f.added.length=0,f.removed.length=0}},t}(u.default);t.default=p}.apply(null,i))||(e.exports=n)},2078:function(e,t,r){var i,n;i=[r(13),r(235)],void 0===(n=function(e,t){var r=/^\s*"([\S\s]*)"\s*$/,i=/""/g,n=/"/g;function o(e,t){var r,i={},n=e.length;for(r=0;r<n;r++)i[e[r]]=t[r];return i}return t(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(t){var n,a,s,l,u,c,f,d,h=[],p=t.split(this.newline),v=this.fieldNames,y=0,m=[],x="",g="";e:for(c=0,s=p.length;c<s;c++)if(e.trim(p[c])){for(f=0,l=(n=p[c].split(this.delimiter)).length;f<l;f++){for(d=-1,x+=g+(a=n[f]),g="";(d=a.indexOf('"',d+1))>=0;)y++;if(y%2==0){if(y>0){if(!(u=r.exec(x))){console.warn("Csv: discarding row with invalid value: "+x),m=[],x="",y=0;continue e}m.push(u[1].replace(i,'"'))}else m.push(this.trim||!v?e.trim(x):x);x="",y=0}else g=this.delimiter}0===y?(v?h.push(o(v,m)):v=this.fieldNames=m,m=[]):g=this.newline}return h},toCsv:function(e){return this.stringify(this.data,e)},stringify:function(e,t){var r,i,o,a,s=(t=t||{}).alwaysQuote,l=this.fieldNames,u=this.delimiter,c=this.newline,f="";for(r=-1;r<e.length;r++)for(r>-1&&(f+=c),i=0;i<l.length;i++)null!==(o=r<0?l[i]:e[r][l[i]])&&void 0!==o||(o=""),"string"!=typeof o&&(o=o.toString()),a=s||o.indexOf('"')>=0||o.indexOf(u)>=0,f+=(i>0?u:"")+(a?'"'+o.replace(n,'""')+'"':o);return t.trailingNewline&&(f+=c),f}})}.apply(null,i))||(e.exports=n)}}]);
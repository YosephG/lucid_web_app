(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/ElevationLayer":1168,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/layers/ElevationLayer":1168,"esri/Basemap":1184,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/Basemap":1184,"esri/layers/mixins/ArcGISCachedService":1280,"esri/layers/support/TilemapCache":1355,"esri/layers/support/Tilemap":1369,"esri/layers/support/rasterFormats/LercCodec":1370,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/Ground":1659,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/ground/navigationConstraints":1953,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/support/basemapUtils":1954,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/support/groundUtils":1955})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[83,15,22,36],{1168:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(12),r(2),r(1),r(74),r(14),r(36),r(9),r(11),r(23),r(0),r(165),r(118),r(1280),r(157),r(156),r(1370)],void 0===(i=function(e,t,n,i,a,o,l,s,p,u,c,f,y,d,h,v,m,g){return function(e){function t(t){var r=e.call(this)||this;return r.copyright=null,r.heightModelInfo=null,r.opacity=1,r.operationalLayerType="ArcGISTiledElevationServiceLayer",r.type="elevation",r.url=null,r}return i(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?n({url:e},t):e},Object.defineProperty(t.prototype,"minScale",{get:function(){},set:function(e){this.constructed&&l.deprecated(this.declaredClass+".minScale support has been removed.","","4.5")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxScale",{get:function(){},set:function(e){this.constructed&&l.deprecated(this.declaredClass+".maxScale support has been removed.","","4.5")},enumerable:!0,configurable:!0}),t.prototype.load=function(){var e=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(e){for(var t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new p("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}}).always(function(){return e._fetchImageService()})),this.when()},t.prototype.fetchTile=function(e,t,r,n){var i=this;return void 0===n&&(n=0),this.load().then(function(){return i._fetchTileAvailability(e,t,r)}).then(function(){var n=i.getTileUrl(e,t,r);return s(n,{responseType:"array-buffer",failOk:!0})}).then(function(e){var t=g.decode(e.data,{noDataValue:n,returnFileInfo:!0});return{values:t.pixelData,width:t.width,height:t.height,maxZError:t.fileInfo.maxZError,noDataValue:t.noDataValue}})},t.prototype.getTileUrl=function(e,t,r){var i=!this.tilemapCache&&this.supportsBlankTile,a=o.objectToQuery(n({},this.parsedUrl.query,{blankTile:!i&&null}));return this.parsedUrl.path+"/tile/"+e+"/"+t+"/"+r+(a?"?"+a:"")},t.prototype.queryElevation=function(e,t){var n=this;return u.create(function(e){return r.e(8).then(function(){var t=[r(1367)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){return(new r.ElevationQuery).query(n,e,t)})},t.prototype.createElevationSampler=function(e,t){var n=this;return u.create(function(e){return r.e(8).then(function(){var t=[r(1367)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){return(new r.ElevationQuery).createSampler(n,e,t)})},t.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return u.reject(new p("elevation-layer:view-not-supported","ElevationLayer is only supported in 3D"));case"3d":return u.create(function(e){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(49)]).then(function(){var t=[r(1463)];e.apply(null,t)}.bind(this)).catch(r.oe)})}},t.prototype._fetchTileAvailability=function(e,t,r){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,r):u.resolve("unknown")},t.prototype._fetchImageService=function(){var e=this;return u.resolve().then(function(){if(e.resourceInfo)return e.resourceInfo;var t={query:n({f:"json"},e.parsedUrl.query),responseType:"json",callbackParamName:"callback"};return s(e.parsedUrl.path,t)}).then(function(t){t.ssl&&(e.url=e.url.replace(/^http:/i,"https:")),e.read(t.data,{origin:"service",url:e.parsedUrl})})},a([f.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),a([f.property({readOnly:!0,type:y})],t.prototype,"heightModelInfo",void 0),a([f.property({json:{read:!1,write:!1}})],t.prototype,"minScale",null),a([f.property({json:{read:!1,write:!1}})],t.prototype,"maxScale",null),a([f.property({json:{read:!1,write:!1}})],t.prototype,"opacity",void 0),a([f.property()],t.prototype,"operationalLayerType",void 0),a([f.property()],t.prototype,"resourceInfo",void 0),a([f.property({json:{read:!1},value:"elevation",readOnly:!0})],t.prototype,"type",void 0),a([f.property({json:{origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writer:c.writeOperationalLayerUrl}}}}})],t.prototype,"url",void 0),a([f.subclass("esri.layers.ElevationLayer")],t)}(f.declared(d,h,v,m))}.apply(null,n))||(e.exports=i)},1184:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(12),r(2),r(1),r(18),r(237),r(32),r(6),r(5),r(172),r(7),r(11),r(23),r(0),r(118),r(60),r(127),r(1540)],void 0===(i=function(e,t,n,i,a,o,l,s,p,u,c,f,y,d,h,v,m,g,b){var w=0,L=o.ofType(v),I=f.getLogger("esri.Basemap");return function(e){function t(t){var r=e.call(this)||this;r.id=null,r.portalItem=null,r.thumbnailUrl=null,r.title="Basemap",r.id=Date.now().toString(16)+"-basemap-"+w++,r.baseLayers=new L,r.referenceLayers=new L;var n=function(e){e.parent&&e.parent!==r&&"remove"in e.parent&&e.parent.remove(e),e.parent=r,"elevation"===e.type&&I.error("Layer '"+e.title+", id:"+e.id+"' of type '"+e.type+"' is not supported as a basemap layer and will therefore be ignored.")},i=function(e){e.parent=null};return r.baseLayers.on("after-add",function(e){return n(e.item)}),r.referenceLayers.on("after-add",function(e){return n(e.item)}),r.baseLayers.on("after-remove",function(e){return i(e.item)}),r.referenceLayers.on("after-remove",function(e){return i(e.item)}),r}var o;return i(t,e),o=t,t.prototype.initialize=function(){var e=this;this.when().catch(function(t){I.error("#load()","Failed to load basemap (title: '"+e.title+"', id: '"+e.id+"')",t)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},t.prototype.normalizeCtorArgs=function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=n({},e)).resourceInfo),e},Object.defineProperty(t.prototype,"baseLayers",{set:function(e){this._set("baseLayers",l.referenceSetter(e,this._get("baseLayers"),L))},enumerable:!0,configurable:!0}),t.prototype.writeBaseLayers=function(e,t,r,i){var a=[];e?(i=n({},i,{layerContainerType:"basemap"}),this.baseLayers.forEach(function(e){if(e.write){var t={};e.write(t,i)&&a.push(t)}}),this.referenceLayers.forEach(function(e){if(e.write){var t={isReference:!0};e.write(t,i)&&a.push(t)}}),t[r]=a):t[r]=a},Object.defineProperty(t.prototype,"referenceLayers",{set:function(e){this._set("referenceLayers",l.referenceSetter(e,this._get("referenceLayers"),L))},enumerable:!0,configurable:!0}),t.prototype.writeTitle=function(e,t){t.title=e||"Basemap"},t.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},t.prototype.clone=function(){var e={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(e.loadStatus="loaded"),new o({resourceInfo:this.resourceInfo}).set(e)},t.prototype.read=function(e,t){return this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),this.inherited(arguments)},t.prototype.write=function(e,t){return e=e||{},t&&t.origin||(t=n({origin:"web-map"},t)),this.inherited(arguments,[e,t]),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(e.baseMapLayers=this.resourceInfo.data.baseMapLayers.map(function(e){var t=u.clone(e);return t.url&&d.isProtocolRelative(t.url)&&(t.url="https:"+t.url),t.templateUrl&&d.isProtocolRelative(t.templateUrl)&&(t.templateUrl="https:"+t.templateUrl),t})),e},t.prototype._loadFromSource=function(){var e=this.resourceInfo,t=this.portalItem;return e?this._loadLayersFromJSON(e.data,e.context?e.context.url:null):t?this._loadFromItem(t):y.resolve(null)},t.prototype._loadLayersFromJSON=function(e,t){var n=this,i=this.resourceInfo&&this.resourceInfo.context,a=this.portalItem&&this.portalItem.portal||i&&i.portal||null,o=i&&"web-scene"===i.origin?"web-scene":"web-map";return y.create(function(e){return r.e(26).then(function(){var t=[r(1590)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){var i=[];if(e.baseMapLayers&&Array.isArray(e.baseMapLayers)){var l={context:{origin:o,url:t,portal:a,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},s=r.populateOperationalLayers(n.baseLayers,e.baseMapLayers.filter(function(e){return!e.isReference}),l);i.push.apply(i,s);var p=r.populateOperationalLayers(n.referenceLayers,e.baseMapLayers.filter(function(e){return e.isReference}),l);i.push.apply(i,p)}return y.eachAlways(i)}).then(function(){})},t.prototype._loadFromItem=function(e){var t=this;return e.load().then(function(e){return e.fetchData()}).then(function(r){var n=d.urlToObject(e.itemUrl);return t._set("resourceInfo",{data:r.baseMap,context:{origin:"web-map",portal:e.portal||m.getDefault(),url:n}}),t.read(t.resourceInfo.data,t.resourceInfo.context),t.read({title:e.title,thumbnailUrl:e.thumbnailUrl},{origin:"portal-item",portal:e.portal||m.getDefault(),url:n}),t._loadLayersFromJSON(t.resourceInfo.data,n)})},t.fromId=function(e){var t=b[e];return t?o.fromJSON(t):null},a([h.property({type:L,json:{write:{ignoreOrigin:!0,target:"baseMapLayers"}}}),h.cast(l.castForReferenceSetter)],t.prototype,"baseLayers",null),a([h.writer("baseLayers")],t.prototype,"writeBaseLayers",null),a([h.property({type:String,json:{origins:{"web-scene":{write:!0}}}})],t.prototype,"id",void 0),a([h.property({type:g})],t.prototype,"portalItem",void 0),a([h.property({type:L}),h.cast(l.castForReferenceSetter)],t.prototype,"referenceLayers",null),a([h.property({readOnly:!0})],t.prototype,"resourceInfo",void 0),a([h.property()],t.prototype,"thumbnailUrl",void 0),a([h.property({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],t.prototype,"title",void 0),a([h.writer("title")],t.prototype,"writeTitle",null),o=a([h.subclass("esri.Basemap")],t)}(h.declared(p,s,c))}.apply(null,n))||(e.exports=i)},1280:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(12),r(2),r(1),r(37),r(0),r(225),r(441),r(1355)],void 0===(i=function(e,t,r,n,i,a,o,l,s,p){return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.copyright=null,t.minScale=0,t.maxScale=0,t.spatialReference=null,t.tileInfo=null,t.tilemapCache=null,t}return n(t,e),Object.defineProperty(t.prototype,"supportsBlankTile",{get:function(){return this.version>=10.2},enumerable:!0,configurable:!0}),t.prototype.readTileInfo=function(e,t){var r=function(e){return Math.round(1e4*e)/1e4},n=t.minScale?r(t.minScale):1/0,i=t.maxScale?r(t.maxScale):-1/0;return e?(e.lods=e.lods.filter(function(e){var t=r(e.scale);return t<=n&&t>=i}),s.fromJSON(e)):null},t.prototype.readTilemapCache=function(e,t){return t.capabilities&&t.capabilities.indexOf("Tilemap")>-1?new p({layer:this}):null},i([o.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),i([o.property({json:{origins:{service:{read:!1}}}})],t.prototype,"minScale",void 0),i([o.property({json:{origins:{service:{read:!1}}}})],t.prototype,"maxScale",void 0),i([o.property({type:a.SpatialReference})],t.prototype,"spatialReference",void 0),i([o.property({readOnly:!0,dependsOn:["version"]})],t.prototype,"supportsBlankTile",null),i([o.property({type:s})],t.prototype,"tileInfo",void 0),i([o.reader("service","tileInfo",["tileInfo","minScale","maxScale"])],t.prototype,"readTileInfo",null),i([o.property()],t.prototype,"tilemapCache",void 0),i([o.reader("service","tilemapCache",["capabilities"])],t.prototype,"readTilemapCache",null),i([o.property()],t.prototype,"version",void 0),i([o.subclass("esri.layers.mixins.ArcGISCachedService")],t)}(o.declared(l))}.apply(null,n))||(e.exports=i)},1355:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(12),r(2),r(1),r(74),r(36),r(4),r(9),r(15),r(7),r(455),r(11),r(19),r(0),r(1369)],void 0===(i=function(e,t,r,n,i,a,o,l,s,p,u,c,f,y,d,h){var v=u.getLogger("esri.layers.support.TilemapCache");return function(e){function t(t){var r=e.call(this)||this;return r._handles=new p,r._pendingTilemapRequests={},r._availableLevels={},r.levels=5,r.cacheByteSize=2097152,r.request=o,r}return n(t,e),t.prototype.initialize=function(){var e=this;this._tilemapCache=new c(this.cacheByteSize,{sizeOfFunction:function(e){return e.byteSize}}),this._handles.add([this.watch(["layer.parsedUrl","layer.tileServers"],function(){return e._initializeTilemapDefinition()}),y.init(this,"layer.tileInfo.lods",function(t){return e._initializeAvailableLevels(t)},!0)]),this._initializeTilemapDefinition()},t.prototype.destroy=function(){this._handles&&(this._handles.destroy(),this._handles=null)},t.prototype.castLevels=function(e){return e<=2?(v.error("Minimum levels for Tilemap is 3, but got ",e),3):e},Object.defineProperty(t.prototype,"size",{get:function(){return 1<<this.levels},enumerable:!0,configurable:!0}),t.prototype.getTilemap=function(e,t,r){return this._tilemapFromCache(e,t,r,this._tmpTilemapDefinition)},t.prototype.fetchTilemap=function(e,t,r,n){var i=this;if(!this._availableLevels[e])return f.reject(new s("tilemap-cache:level-unavailable","Level "+e+" is unavailable in the service"));var a=this._tmpTilemapDefinition,o=this._tilemapFromCache(e,t,r,a);if(o)return f.resolve(o);var l=h.tilemapDefinitionId(a),p=this._pendingTilemapRequests[l];return p||(p=h.Tilemap.fromDefinition(a,n).then(function(e){return i._tilemapCache.set(l,e),delete i._pendingTilemapRequests[l],e}).catch(function(e){return delete i._pendingTilemapRequests[l],f.reject(e)}),this._pendingTilemapRequests[l]=p),f.create(function(e,t){p.then(e,t)})},t.prototype.getAvailability=function(e,t,r){if(!this._availableLevels[e])return"unavailable";var n=this.getTilemap(e,t,r);return n?n.getAvailability(t,r):"unknown"},t.prototype.getAvailabilityUpsample=function(e,t,r,n){n.level=e,n.row=t,n.col=r;var i=this.layer.tileInfo;for(i.updateTileInfo(n);;){var a=this.getAvailability(n.level,n.row,n.col);if("unavailable"!==a)return a;if(!i.upsampleTile(n))return"unavailable"}},t.prototype.fetchAvailability=function(e,t,r,n){return this._availableLevels[e]?this.fetchTilemap(e,t,r,n).always(function(n){if(n instanceof h.Tilemap){var i=n.getAvailability(t,r);return"unavailable"===i?f.reject(new s("tile-map:tile-unavailable","Tile is not available",{level:e,row:t,col:r})):i}return n&&"cancel"===n.dojoType?f.reject(n):"unknown"}):f.reject(new s("tilemap-cache:level-unavailable","Level "+e+" is unavailable in the service"))},t.prototype.fetchAvailabilityUpsample=function(e,t,r,n,i){var a=this;n.level=e,n.row=t,n.col=r;var o=this.layer.tileInfo;return o.updateTileInfo(n),this.fetchAvailability(e,t,r,i).catch(function(e){return e&&"cancel"===e.dojoType?f.reject(e):o.upsampleTile(n)?a.fetchAvailabilityUpsample(n.level,n.row,n.col,n):f.reject(e)})},t.prototype._initializeTilemapDefinition=function(){if(this.layer.parsedUrl){var e=this.layer.parsedUrl,t=e.query;t&&t.token||!this.layer.token||(t=r({},t,{token:this.layer.token})),this._tilemapCache.clear(),this._tmpTilemapDefinition={service:{url:e.path,query:t?a.objectToQuery(t):null,tileServers:this.layer.tileServers,request:this.request,type:this.layer.type},width:this.size,height:this.size,level:0,row:0,col:0}}},t.prototype._tilemapFromCache=function(e,t,r,n){var i=this._getTilemapDefinition(e,t,r,n),a=h.tilemapDefinitionId(i);return this._tilemapCache.get(a)},t.prototype._getTilemapDefinition=function(e,t,r,n){return n.level=e,n.row=t-t%this.size,n.col=r-r%this.size,n},t.prototype._initializeAvailableLevels=function(e){var t=this;this._availableLevels={},e&&e.forEach(function(e){return t._availableLevels[e.level]=!0})},i([d.property({constructOnly:!0,type:Number})],t.prototype,"levels",void 0),i([d.cast("levels")],t.prototype,"castLevels",null),i([d.property({readOnly:!0,dependsOn:["levels"],type:Number})],t.prototype,"size",null),i([d.property({constructOnly:!0,type:Number})],t.prototype,"cacheByteSize",void 0),i([d.property({constructOnly:!0})],t.prototype,"layer",void 0),i([d.property({constructOnly:!0})],t.prototype,"request",void 0),i([d.subclass("esri.layers.support.TilemapCache")],t)}(d.declared(l))}.apply(null,n))||(e.exports=i)},1369:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(12),r(36),r(9),r(5),r(11)],void 0===(i=function(e,t,r,n,i,a,o){function l(e){var t;if("vector-tile"===e.service.type)t=e.service.url+"/tilemap/"+e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height;else{var r=e.service.tileServers;t=(r&&r.length?r[e.row%r.length]:e.service.url)+"/tilemap/"+e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height}var n=e.service.query;return n&&(t=t+"?"+n),t}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(){this.location={left:0,top:0,width:0,height:0},this.byteSize=40}return e.prototype.getAvailability=function(e,t){if(this._isAllAvailable)return"available";if(this._isAllUnvailable)return"unavailable";var r=(e-this.location.top)*this.location.width+(t-this.location.left),n=r%8,i=r>>3,a=this._tileAvailabilityBitSet;return i<0||i>a.length?"unknown":a[i]&1<<n?"available":"unavailable"},e.prototype._updateFromData=function(e){for(var t=this.location.width,r=this.location.height,n=!0,i=!0,a=Math.ceil(t*r/8),o=new Uint8Array(a),l=0,s=0;s<e.length;s++){var p=s%8;e[s]?(i=!1,o[l]|=1<<p):n=!1,7===p&&++l}this._isAllUnvailable=i,this._isAllAvailable=n,this._isAllAvailable||this._isAllUnvailable||(this._tileAvailabilityBitSet=o,this.byteSize+=o.length)},e.fromDefinition=function(t,a){var s=t.service.request||n,p=t.row,u=t.col,c=t.width,f=t.height,y={query:{f:"json"},callbackParamName:"callback"};return a=a?r({},y,a):y,s(l(t),a).then(function(e){return e.data}).catch(function(e){return e&&e.details&&422===e.details.httpStatus?{location:{top:p,left:u,width:c,height:f},valid:!0,data:function(){for(var e=[],t=0,r=c*f;t<r;t++)e[t]=0;return e}()}:o.reject(e)}).then(function(t){if(t.location&&(t.location.top!==p||t.location.left!==u||t.location.width!==c||t.location.height!==f))throw new i("tilemap:location-mismatch","Tilemap response for different location than requested",{response:t,definition:{top:p,left:u,width:c,height:f}});return e.fromJSON(t)})},e.fromJSON=function(t){e.validateJSON(t);var r=new e;return r.location=Object.freeze(a.clone(t.location)),r._updateFromData(t.data),Object.freeze(r)},e.validateJSON=function(e){if(!e||!e.location)throw new i("tilemap:missing-location","Location missing from tilemap response");if(!1===e.valid)throw new i("tilemap:invalid","Tilemap response was marked as invalid");if(!e.data)throw new i("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(e.data))throw new i("tilemap:data-mismatch","Data must be an array of numbers");if(e.data.length!==e.location.width*e.location.height)throw new i("tilemap:data-mismatch","Number of data items does not match width/height of tilemap")},e}();t.Tilemap=s,t.tilemapDefinitionId=function(e){return e.level+"/"+e.row+"/"+e.col+"/"+e.width+"/"+e.height},t.tilemapDefinitionUrl=l,t.default=s}.apply(null,n))||(e.exports=i)},1370:function(e,t,r){var n;void 0===(n=function(){var e={defaultNoDataValue:-3.4027999387901484e38,decode:function(a,o){var l=(o=o||{}).encodedMaskData||null===o.encodedMaskData,s=i(a,o.inputOffset||0,l),p=null!=o.noDataValue?o.noDataValue:e.defaultNoDataValue,u=t(s,o.pixelType||Float32Array,o.encodedMaskData,p,o.returnMask),c={width:s.width,height:s.height,pixelData:u.resultPixels,minValue:s.pixels.minValue,maxValue:s.pixels.maxValue,noDataValue:p};return u.resultMask&&(c.maskData=u.resultMask),o.returnEncodedMask&&s.mask&&(c.encodedMaskData=s.mask.bitset?s.mask.bitset:null),o.returnFileInfo&&(c.fileInfo=r(s),o.computeUsedBitDepths&&(c.fileInfo.bitDepths=n(s))),c}},t=function(e,t,r,n,i){var o,l,s=0,p=e.pixels.numBlocksX,u=e.pixels.numBlocksY,c=Math.floor(e.width/p),f=Math.floor(e.height/u),y=2*e.maxZError;r=r||(e.mask?e.mask.bitset:null),o=new t(e.width*e.height),i&&r&&(l=new Uint8Array(e.width*e.height));for(var d,h,v=new Float32Array(c*f),m=0;m<=u;m++){var g=m!==u?f:e.height%u;if(0!==g)for(var b=0;b<=p;b++){var w=b!==p?c:e.width%p;if(0!==w){var L,I,k,x,T=m*e.width*f+b*c,_=e.width-w,S=e.pixels.blocks[s];if(S.encoding<2?(0===S.encoding?L=S.rawData:(a(S.stuffedData,S.bitsPerPixel,S.numValidPixels,S.offset,y,v,e.pixels.maxValue),L=v),I=0):k=2===S.encoding?0:S.offset,r)for(h=0;h<g;h++){for(7&T&&(x=r[T>>3],x<<=7&T),d=0;d<w;d++)7&T||(x=r[T>>3]),128&x?(l&&(l[T]=1),o[T++]=S.encoding<2?L[I++]:k):(l&&(l[T]=0),o[T++]=n),x<<=1;T+=_}else if(S.encoding<2)for(h=0;h<g;h++){for(d=0;d<w;d++)o[T++]=L[I++];T+=_}else for(h=0;h<g;h++){for(d=0;d<w;d++)o[T++]=k;T+=_}if(1===S.encoding&&I!==S.numValidPixels)throw"Block and Mask do not match";s++}}}return{resultPixels:o,resultMask:l}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,minValue:e.pixels.minValue,noDataValue:this.noDataValue}}},n=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},n=0;n<t;n++){var i=e.pixels.blocks[n];0===i.encoding?r.float32=!0:1===i.encoding?r[i.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},i=function(e,t,r){var n={},i=new Uint8Array(e,t,10);if(n.fileIdentifierString=String.fromCharCode.apply(null,i),"CntZImage"!=n.fileIdentifierString.trim())throw"Unexpected file identifier string: "+n.fileIdentifierString;t+=10;var a=new DataView(e,t,24);if(n.fileVersion=a.getInt32(0,!0),n.imageType=a.getInt32(4,!0),n.height=a.getUint32(8,!0),n.width=a.getUint32(12,!0),n.maxZError=a.getFloat64(16,!0),t+=24,!r)if(a=new DataView(e,t,16),n.mask={},n.mask.numBlocksY=a.getUint32(0,!0),n.mask.numBlocksX=a.getUint32(4,!0),n.mask.numBytes=a.getUint32(8,!0),n.mask.maxValue=a.getFloat32(12,!0),t+=16,n.mask.numBytes>0){var o=new Uint8Array(Math.ceil(n.width*n.height/8)),l=(a=new DataView(e,t,n.mask.numBytes)).getInt16(0,!0),s=2,p=0;do{if(l>0)for(;l--;)o[p++]=a.getUint8(s++);else{var u=a.getUint8(s++);for(l=-l;l--;)o[p++]=u}l=a.getInt16(s,!0),s+=2}while(s<n.mask.numBytes);if(-32768!==l||p<o.length)throw"Unexpected end of mask RLE encoding";n.mask.bitset=o,t+=n.mask.numBytes}else if(0==(n.mask.numBytes|n.mask.numBlocksY|n.mask.maxValue)){o=new Uint8Array(Math.ceil(n.width*n.height/8));n.mask.bitset=o}a=new DataView(e,t,16),n.pixels={},n.pixels.numBlocksY=a.getUint32(0,!0),n.pixels.numBlocksX=a.getUint32(4,!0),n.pixels.numBytes=a.getUint32(8,!0),n.pixels.maxValue=a.getFloat32(12,!0),t+=16;var c=n.pixels.numBlocksX,f=n.pixels.numBlocksY,y=c+(n.width%c>0?1:0),d=f+(n.height%f>0?1:0);n.pixels.blocks=new Array(y*d);for(var h=1e9,v=0,m=0;m<d;m++)for(var g=0;g<y;g++){var b=0,w=e.byteLength-t;a=new DataView(e,t,Math.min(10,w));var L={};n.pixels.blocks[v++]=L;var I=a.getUint8(0);if(b++,L.encoding=63&I,L.encoding>3)throw"Invalid block encoding ("+L.encoding+")";if(2!==L.encoding){if(0!==I&&2!==I){if(I>>=6,L.offsetType=I,2===I)L.offset=a.getInt8(1),b++;else if(1===I)L.offset=a.getInt16(1,!0),b+=2;else{if(0!==I)throw"Invalid block offset type";L.offset=a.getFloat32(1,!0),b+=4}if(h=Math.min(L.offset,h),1===L.encoding)if(I=a.getUint8(b),b++,L.bitsPerPixel=63&I,I>>=6,L.numValidPixelsType=I,2===I)L.numValidPixels=a.getUint8(b),b++;else if(1===I)L.numValidPixels=a.getUint16(b,!0),b+=2;else{if(0!==I)throw"Invalid valid pixel count type";L.numValidPixels=a.getUint32(b,!0),b+=4}}var k;if(t+=b,3!=L.encoding)if(0===L.encoding){var x=(n.pixels.numBytes-1)/4;if(x!==Math.floor(x))throw"uncompressed block has invalid length";k=new ArrayBuffer(4*x),new Uint8Array(k).set(new Uint8Array(e,t,4*x));for(var T=new Float32Array(k),_=0;_<T.length;_++)h=Math.min(h,T[_]);L.rawData=T,t+=4*x}else if(1===L.encoding){var S=Math.ceil(L.numValidPixels*L.bitsPerPixel/8),U=Math.ceil(S/4);k=new ArrayBuffer(4*U),new Uint8Array(k).set(new Uint8Array(e,t,S)),L.stuffedData=new Uint32Array(k),t+=S}}else t++,h=Math.min(h,0)}return n.pixels.minValue=h,n.eofOffset=t,n},a=function(e,t,r,n,i,a,o){var l,s,p,u=(1<<t)-1,c=0,f=0,y=Math.ceil((o-n)/i),d=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*d,l=0;l<r;l++){if(0===f&&(p=e[c++],f=32),f>=t)s=p>>>f-t&u,f-=t;else{var h=t-f;s=(p&u)<<h&u,s+=(p=e[c++])>>>(f=32-h)}a[l]=s<y?n+s*i:o}return a};return e}.apply(null,[]))||(e.exports=n)},1659:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(12),r(2),r(1),r(25),r(18),r(237),r(9),r(6),r(5),r(172),r(7),r(11),r(0),r(1953),r(118),r(496),r(180)],void 0===(i=function(e,t,n,i,a,o,l,s,p,u,c,f,y,d,h,v,m,g,b){var w=l.ofType(m),L=y.getLogger("esri.Ground");return function(e){function t(t){var r=e.call(this)||this;r.opacity=1,r.surfaceColor=null,r.navigationConstraint=null,r.layers=new w;return r.layers.on("after-add",function(e){return function(e){e.parent&&e.parent!==r&&"remove"in e.parent&&e.parent.remove(e),e.parent=r,g.isOfType(e,["elevation","base-elevation"])||L.error("Layer '"+e.title+", id:"+e.id+"' of type '"+e.type+"' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.")}(e.item)}),r.layers.on("after-remove",function(e){return function(e){e.parent=null}(e.item)}),r}var l;return i(t,e),l=t,t.prototype.initialize=function(){this.when().catch(function(e){L.error("#load()","Failed to load ground",e)}),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)},t.prototype.normalizeCtorArgs=function(e){return e&&"resourceInfo"in e&&(this._set("resourceInfo",e.resourceInfo),delete(e=n({},e)).resourceInfo),e},Object.defineProperty(t.prototype,"layers",{set:function(e){this._set("layers",s.referenceSetter(e,this._get("layers"),w))},enumerable:!0,configurable:!0}),t.prototype.writeLayers=function(e,t,r,i){var a=[];e?(i=n({},i,{layerContainerType:"ground"}),e.forEach(function(e){if(e.write){var t={};e.write(t,i)&&a.push(t)}else i&&i.messages&&i.messages.push(new p("layer:unsupported","Layers ("+e.title+", "+e.id+") of type '"+e.declaredClass+"' cannot be persisted in the ground",{layer:e}))}),t.layers=a):t.layers=a},t.prototype.load=function(){return this.addResolvingPromise(this._loadFromSource()),this.when()},t.prototype.queryElevation=function(e,t){var n=this;return d.create(function(e){return r.e(8).then(function(){var t=[r(1367)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){var i=new r.ElevationQuery,a=n.layers.filter(function(e){return"elevation"===e.type}).toArray();return i.queryAll(a,e,t)})},t.prototype.createElevationSampler=function(e,t){var n=this;return d.create(function(e){return r.e(8).then(function(){var t=[r(1367)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){var i=new r.ElevationQuery,a=n.layers.filter(function(e){return"elevation"===e.type}).toArray();return i.createSamplerAll(a,e,t)})},t.prototype.clone=function(){var e={opacity:this.opacity,surfaceColor:c.clone(this.surfaceColor),navigationConstraint:c.clone(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(e.loadStatus="loaded"),new l({resourceInfo:this.resourceInfo}).set(e)},t.prototype.read=function(e,t){return this.resourceInfo||this._set("resourceInfo",{data:e,context:t}),this.inherited(arguments)},t.prototype._loadFromSource=function(){var e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context):d.resolve(null)},t.prototype._loadLayersFromJSON=function(e,t){var n=this,i=t&&t.origin||"web-scene",a=t&&t.portal||null,o=t&&t.url||null;return d.create(function(e){return r.e(26).then(function(){var t=[r(1590)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(t){var r=[];if(e.layers&&Array.isArray(e.layers)){var l={context:{origin:i,url:o,portal:a,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};r.push.apply(r,t.populateOperationalLayers(n.layers,e.layers,l))}return d.eachAlways(r)}).then(function(){})},a([h.property({type:w,json:{read:!1}}),h.cast(s.castForReferenceSetter)],t.prototype,"layers",null),a([h.writer("layers")],t.prototype,"writeLayers",null),a([h.property({readOnly:!0})],t.prototype,"resourceInfo",void 0),a([h.property({type:Number,json:{read:{reader:b.transparencyToOpacity,source:"transparency"},write:{writer:function(e,t){t.transparency=b.opacityToTransparency(e)},target:"transparency"}}})],t.prototype,"opacity",void 0),a([h.property({type:o,json:{write:function(e,t){t.surfaceColor=e.toJSON().slice(0,3)}}})],t.prototype,"surfaceColor",void 0),a([h.property({types:v.navigationConstraintTypes,json:{read:v.readNavigationConstraint,write:!0}})],t.prototype,"navigationConstraint",void 0),l=a([h.subclass("esri.Ground")],t)}(h.declared(u,f))}.apply(null,n))||(e.exports=i)},1952:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(1184),r(1659),r(4),r(238),r(32),r(7),r(0),r(1954),r(1955),r(491)],void 0===(i=function(e,t,r,n,i,a,o,l,s,p,u,c,f,y){var d=p.getLogger("esri.Map");return function(e){function t(t){var r=e.call(this)||this;return r.basemap=null,r.ground=new a,r._basemapCache=c.createCache(),r}return r(t,e),Object.defineProperty(t.prototype,"allLayers",{get:function(){return new l({root:this,rootCollectionNames:["basemap.baseLayers","ground.layers","layers","basemap.referenceLayers"],getChildrenFunction:function(e){return e.layers}})},enumerable:!0,configurable:!0}),t.prototype.castBasemap=function(e){return c.ensureType(e,this._basemapCache)},t.prototype.castGround=function(e){return f.ensureType(e)||(d.error("Map.ground may not be set to null or undefined"),this._get("ground"))},n([u.property({readOnly:!0})],t.prototype,"allLayers",null),n([u.property({type:i})],t.prototype,"basemap",void 0),n([u.cast("basemap")],t.prototype,"castBasemap",null),n([u.property({type:a})],t.prototype,"ground",void 0),n([u.cast("ground")],t.prototype,"castGround",null),n([u.subclass("esri.Map")],t)}(u.declared(o,s,y))}.apply(null,n))||(e.exports=i)},1953:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(1),r(6),r(94),r(0)],void 0===(i=function(e,t,r,n,i,a,o){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),n([o.property()],t.prototype,"type",void 0),n([o.subclass("esri.ground.NavigationConstraint")],t)}(o.declared(i));t.NavigationConstraint=l;var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="none",t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i},n([o.property({readOnly:!0,json:{read:!1,write:!0}})],t.prototype,"type",void 0),i=n([o.subclass("esri.ground.NoneNavigationConstraint")],t)}(o.declared(l));t.NoneNavigationConstraint=s;var p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="stay-above",t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i},n([o.property({readOnly:!0,json:{read:!1,write:function(e,t){t.type="stayAbove"}}})],t.prototype,"type",void 0),i=n([o.subclass("esri.ground.StayAboveNavigationConstraint")],t)}(o.declared(l));t.StayAboveNavigationConstraint=p,t.readNavigationConstraint=function(e,t,r){var n=e&&u[e.type];if(n){var i=new n;return i.read(e,r),i}r&&r.messages&&e&&r.messages.push(new a("navigationconstraint:unsupported","Navigation constraint of type '"+(e.type||"unknown")+"' is not supported",{definition:e,context:r}))};var u={none:s,stayAbove:p};t.navigationConstraintTypes={key:"type",base:l,typeMap:{none:s,"stay-above":p}}}.apply(null,n))||(e.exports=i)},1954:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1184),r(18),r(7),r(23),r(33),r(1540)],void 0===(i=function(e,t,r,n,i,a,o,l){function s(e,t){var n;if("string"==typeof e){if(!(e in l)){var i=Object.keys(l).map(function(e){return'"'+e+'"'}).join(", ");return b.warn("Unable to find basemap definition for: "+e+". Try one of these: "+i),null}t&&(n=t[e]),n||(n=r.fromId(e),t&&(t[e]=n))}else n=o.default(r,e);return n}function p(e,t){return e.map(function(e){return t.find(function(t){return m(f(e),f(t))})||e})}function u(e){return e?!e.loaded&&e.resourceInfo?y(e.resourceInfo.data):{baseLayers:c(e.baseLayers),referenceLayers:c(e.referenceLayers)}:null}function c(e){return(n.isCollection(e)?e.toArray():e).map(f)}function f(e){return{type:e.type,url:g(e.urlTemplate||e.url||e.styleUrl)}}function y(e){return e?{baseLayers:d(e.baseMapLayers.filter(function(e){return!e.isReference})),referenceLayers:d(e.baseMapLayers.filter(function(e){return e.isReference}))}:null}function d(e){return e.map(function(e){return function(e){var t;switch(e.layerType){case"VectorTileLayer":t="vector-tile";break;case"ArcGISTiledMapServiceLayer":t="tile";break;default:t="unknown"}return{type:t,url:g(e.templateUrl||e.urlTemplate||e.styleUrl||e.url)}}(e)})}function h(e,t,r){return null!=e!=(null!=t)?"not-equal":e?v(e.baseLayers,t.baseLayers)?v(e.referenceLayers,t.referenceLayers)?"equal":r.mustMatchReferences?"not-equal":"base-layers-equal":"not-equal":"equal"}function v(e,t){return e.length===t.length&&!e.some(function(e){return!t.some(function(t){return m(e,t)})})}function m(e,t){return e.type===t.type&&e.url===t.url}function g(e){return e?a.normalize(e).replace(/^\s*https?:/i,"").toLowerCase():""}Object.defineProperty(t,"__esModule",{value:!0});var b=i.getLogger("esri.support.basemapUtils");t.createCache=function(){return{}},t.ensureType=s,t.clonePreservingTiledLayers=function(e,t){void 0===t&&(t=null);var n=s(e);if(!n)return null;var i=new r({id:n.id,title:n.title,baseLayers:n.baseLayers.slice(),referenceLayers:n.referenceLayers.slice()});return t&&(i.baseLayers=p(i.baseLayers,t.baseLayers),i.referenceLayers=p(i.referenceLayers,t.referenceLayers)),i.load(),i.portalItem=n.portalItem,i},t.getWellKnownBasemapId=function(e){var t=null,r=u(e);for(var n in l){var i=h(r,y(l[n]),{mustMatchReferences:!1});if("equal"===i){t=n;break}"base-layers-equal"===i&&(t=n)}return t},t.contentEquals=function(e,t){return e===t||"equal"===h(u(e),u(t),{mustMatchReferences:!0})}}.apply(null,n))||(e.exports=i)},1955:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1659),r(7),r(33),r(1168)],void 0===(i=function(e,t,r,n,i,a){Object.defineProperty(t,"__esModule",{value:!0});var o=n.getLogger("esri.support.groundUtils");t.groundElevationLayers={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer"}},t.ensureType=function(e){var n;if("string"==typeof e)if(e in t.groundElevationLayers){var l=t.groundElevationLayers[e],s=new a({id:l.id,url:l.url});n=new r({layers:[s]})}else o.warn("Unable to find ground definition for: "+e+'. Try "world-elevation"');else n=i.default(r,e);return n}}.apply(null,n))||(e.exports=i)}}]);
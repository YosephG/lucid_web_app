(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/TileLayer":458,"esri/layers/ElevationLayer":1229,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/layers/ElevationLayer":1229,"esri/layers/support/arcgisLayers":1231,"esri/views/webgl/Texture":1270,"esri/views/webgl/FramebufferObject":1275,"esri/layers/support/lazyLayerLoader":1343,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/layers/support/lazyLayerLoader":1343,"esri/layers/support/rasterFormats/LercCodec":1431,"C:/Users/mlinden.LUCIDENERGY/Desktop/Web Apps/Node Dev/esri-webpack-template/node_modules/arcgis-js-api/layers/support/rasterFormats/LercCodec":1431,"esri/views/webgl/Renderbuffer":1444,"dojox/xml/parser":1445,"esri/views/3d/layers/VectorTileLayerView3D":2169})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[63,37],{1229:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(2),r(1),r(78),r(14),r(27),r(9),r(8),r(22),r(0),r(139),r(77),r(1341),r(132),r(130),r(1431)],void 0===(n=function(e,t,i,n,a,o,s,l,c,u,h,p,d,f,m,y,_,g){return function(e){function t(t){var r=e.call(this)||this;return r.copyright=null,r.heightModelInfo=null,r.opacity=1,r.operationalLayerType="ArcGISTiledElevationServiceLayer",r.type="elevation",r.url=null,r}return n(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?i({url:e},t):e},Object.defineProperty(t.prototype,"minScale",{get:function(){},set:function(e){this.constructed&&s.deprecated(this.declaredClass+".minScale support has been removed.","","4.5")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"maxScale",{get:function(){},set:function(e){this.constructed&&s.deprecated(this.declaredClass+".maxScale support has been removed.","","4.5")},enumerable:!0,configurable:!0}),t.prototype.load=function(){var e=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service"],supportsData:!1,validateItem:function(e){for(var t=0;t<e.typeKeywords.length;t++)if("elevation 3d layer"===e.typeKeywords[t].toLowerCase())return!0;throw new c("portal:invalid-layer-item-type","Invalid layer item type '${type}', expected '${expectedType}' ",{type:"Image Service",expectedType:"Image Service Elevation 3D Layer"})}}).always(function(){return e._fetchImageService()})),this.when()},t.prototype.fetchTile=function(e,t,r,i){var n=this;return void 0===i&&(i=0),this.load().then(function(){return n._fetchTileAvailability(e,t,r)}).then(function(){var i=n.getTileUrl(e,t,r);return l(i,{responseType:"array-buffer",failOk:!0})}).then(function(e){var t=g.decode(e.data,{noDataValue:i,returnFileInfo:!0});return{values:t.pixelData,width:t.width,height:t.height,maxZError:t.fileInfo.maxZError,noDataValue:t.noDataValue}})},t.prototype.getTileUrl=function(e,t,r){var n=!this.tilemapCache&&this.supportsBlankTile,a=o.objectToQuery(i({},this.parsedUrl.query,{blankTile:!n&&null}));return this.parsedUrl.path+"/tile/"+e+"/"+t+"/"+r+(a?"?"+a:"")},t.prototype.queryElevation=function(e,t){var i=this;return u.create(function(e){return r.e(8).then(function(){var t=[r(1428)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){return(new r.ElevationQuery).query(i,e,t)})},t.prototype.createElevationSampler=function(e,t){var i=this;return u.create(function(e){return r.e(8).then(function(){var t=[r(1428)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(r){return(new r.ElevationQuery).createSampler(i,e,t)})},t.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return u.reject(new c("elevation-layer:view-not-supported","ElevationLayer is only supported in 3D"));case"3d":return u.create(function(e){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(50)]).then(function(){var t=[r(1522)];e.apply(null,t)}.bind(this)).catch(r.oe)})}},t.prototype._fetchTileAvailability=function(e,t,r){return this.tilemapCache?this.tilemapCache.fetchAvailability(e,t,r):u.resolve("unknown")},t.prototype._fetchImageService=function(){var e=this;return u.resolve().then(function(){if(e.resourceInfo)return e.resourceInfo;var t={query:i({f:"json"},e.parsedUrl.query),responseType:"json",callbackParamName:"callback"};return l(e.parsedUrl.path,t)}).then(function(t){t.ssl&&(e.url=e.url.replace(/^http:/i,"https:")),e.read(t.data,{origin:"service",url:e.parsedUrl})})},a([p.property({json:{read:{source:"copyrightText"}}})],t.prototype,"copyright",void 0),a([p.property({readOnly:!0,type:d})],t.prototype,"heightModelInfo",void 0),a([p.property({json:{read:!1,write:!1}})],t.prototype,"minScale",null),a([p.property({json:{read:!1,write:!1}})],t.prototype,"maxScale",null),a([p.property({json:{read:!1,write:!1}})],t.prototype,"opacity",void 0),a([p.property()],t.prototype,"operationalLayerType",void 0),a([p.property()],t.prototype,"resourceInfo",void 0),a([p.property({json:{read:!1},value:"elevation",readOnly:!0})],t.prototype,"type",void 0),a([p.property({json:{origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writer:h.writeOperationalLayerUrl}}}}})],t.prototype,"url",void 0),a([p.subclass("esri.layers.ElevationLayer")],t)}(p.declared(f,m,y,_))}.apply(null,i))||(e.exports=n)},1231:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(134),r(27),r(9),r(8),r(129),r(129),r(1343)],void 0===(n=function(e,t,i,n,a,o,s,l,c,u){function h(e){return(0,u.layerLookupMap[e])()}function p(e){return a(e,{responseType:"json",callbackParamName:"callback",query:{f:"json"}}).then(function(e){return e.data})}Object.defineProperty(t,"__esModule",{value:!0}),t.fromUrl=function(e){return function(e){var t=c.parse(e);if(!t)return s.reject(new o("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e}));var r,i=t.serverType,a=t.sublayer;switch(i){case"MapServer":r=null!=a?"FeatureLayer":function(e){return p(e).then(function(e){return e.tileInfo})}(e).then(function(e){return e?"TileLayer":"MapImageLayer"});break;case"ImageServer":r=p(e).then(function(e){var t=e.tileInfo&&e.tileInfo.format;return e.tileInfo?t&&"LERC"===t.toUpperCase()&&e.cacheType&&"elevation"===e.cacheType.toLowerCase()?"ElevationLayer":"TileLayer":"ImageryLayer"});break;case"SceneServer":r=p(t.url.path).then(function(e){var t={Point:"SceneLayer","3DObject":"SceneLayer",IntegratedMesh:"IntegratedMeshLayer",PointCloud:"PointCloudLayer"};if(e&&Array.isArray(e.layers)&&e.layers.length>0){var r=e.layers[0].layerType;if(null!=t[r])return t[r]}return"SceneLayer"});break;default:r={FeatureServer:"FeatureLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer"}[i]}var l,u={FeatureLayer:!0,SceneLayer:!0},d={parsedUrl:t,Constructor:null,sublayerIds:null};return n(r).then(function(t){if(l=t,u[t]&&null==a)return function(e){return p(e).then(function(e){return e&&Array.isArray(e.layers)?e.layers.map(function(e){return e.id}).reverse():[]})}(e).then(function(e){1!==e.length&&(d.sublayerIds=e)})}).then(function(){return h(l)}).then(function(e){return d.Constructor=e,d})}(e.url).then(function(t){var n=function(e,t){var r=e.Constructor.prototype.declaredClass;return"esri.layers.FeatureLayer"===r||"esri.layers.StreamLayer"===r?i({outFields:["*"]},t):t}(t,i({},e.properties,{url:e.url}));return t.sublayerIds?s.create(function(e){return Promise.resolve().then(function(){var t=[r(238)];e.apply(null,t)}.bind(this)).catch(r.oe)}).then(function(e){var r=new e({title:t.parsedUrl.title});return function(e,t){return e.sublayerIds.map(function(r){return new e.Constructor(i({},t,{layerId:r,sublayerTitleMode:"service-name"}))})}(t,n).forEach(function(e){return r.add(e)}),s.resolve(r)}):s.resolve(new t.Constructor(n))})},t.fetchServerVersion=function(e){if(!l.test(e))return s.reject();var t=e.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return a(t,{query:{f:"json"},responseType:"json",callbackParamName:"callback"}).then(function(e){return e.data&&e.data.currentVersion?e.data.currentVersion:s.reject()})}}.apply(null,i))||(e.exports=n)},1270:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10)],void 0===(n=function(e,t,r){return function(){function e(t,i,n){this._context=null,this._glName=null,this._id=-1,this._desc=void 0,this._samplingModeDirty=!1,this._wrapModeDirty=!1,this._boundToUnits=new Set,this._context=t,this._desc={pixelFormat:i.pixelFormat,internalFormat:i.internalFormat,dataType:i.dataType,target:i.target?i.target:3553,samplingMode:i.samplingMode?i.samplingMode:9729,wrapMode:i.wrapMode?i.wrapMode:10497,maxAnisotropy:i.maxAnisotropy,flipped:void 0!==i.flipped&&i.flipped,hasMipmap:void 0!==i.hasMipmap&&i.hasMipmap,level:void 0!==i.level?i.level:0,unpackAlignment:i.unpackAlignment?i.unpackAlignment:4,width:i.width,height:i.height,preMultiplyAlpha:void 0!==i.preMultiplyAlpha&&i.preMultiplyAlpha},this._id=++e._nextId,r("esri-webgl-debug")&&t.instanceCounter.incrementCount(0),this.setData(n)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(this._context){if(this._glName){var t=this._context.gl;this._boundToUnits.forEach(function(t){e._context.bindTexture(null,t)}),t.deleteTexture(this._glName),this._glName=null}r("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(0),this._context=null}},e.prototype.resize=function(e,t){var r=this._desc;r.width===e&&r.height===t||(r.width=e,r.height=t,this.setData(null))},e.prototype.setData=function(t){var r=this._context.gl;this._glName||(this._glName=r.createTexture()),void 0===t&&(t=null),null===t&&(this._desc.width=this._desc.width||4,this._desc.height=this._desc.height||4);var i=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var n=this._desc;if(e._validateTexture(n),r.pixelStorei(r.UNPACK_ALIGNMENT,n.unpackAlignment),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,n.flipped?1:0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.preMultiplyAlpha),t instanceof ImageData||t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement)n.width&&n.height&&console.assert(t.width===n.width&&t.height===n.height),r.texImage2D(r.TEXTURE_2D,n.level,n.internalFormat?n.internalFormat:n.pixelFormat,n.pixelFormat,n.dataType,t),void 0===this._desc.width&&(this._desc.width=t.width),void 0===this._desc.height&&(this._desc.height=t.height);else{null!=n.width&&null!=n.height||console.error("Width and height must be specified!");var a=n.internalFormat?n.internalFormat:n.pixelFormat,o=n.pixelFormat;r.DEPTH24_STENCIL8&&a===r.DEPTH_STENCIL&&(a=r.DEPTH24_STENCIL8),r.texImage2D(r.TEXTURE_2D,n.level,a,n.width,n.height,0,o,n.dataType,t)}n.hasMipmap&&this.generateMipmap(),e._applySamplingMode(r,this._desc),e._applyWrapMode(r,this._desc),e._applyAnisotropicFilteringParameters(this._context,this._desc),this._context.bindTexture(i,0)},e.prototype.updateData=function(e,t,r,i,n,a){a||console.error("An attempt to use uninitialized data!"),this._glName||console.error("An attempt to update uninitialized texture!");var o=this._context.gl,s=this._desc,l=this._context.getBoundTexture(0);this._context.bindTexture(this,0),(t<0||r<0||i>s.width||n>s.height||t+i>s.width||r+n>s.height)&&console.error("An attempt to update out of bounds of the texture!"),a instanceof ImageData||a instanceof HTMLImageElement||a instanceof HTMLCanvasElement||a instanceof HTMLVideoElement?(console.assert(a.width===i&&a.height===n),o.texSubImage2D(o.TEXTURE_2D,e,t,r,s.pixelFormat,s.dataType,a)):o.texSubImage2D(o.TEXTURE_2D,e,t,r,i,n,s.pixelFormat,s.dataType,a),this._context.bindTexture(l,0)},e.prototype.generateMipmap=function(){var t=this._desc;t.hasMipmap||(t.hasMipmap=!0,e._validateTexture(t)),9729===t.samplingMode?(this._samplingModeDirty=!0,t.samplingMode=9985):9728===t.samplingMode&&(this._samplingModeDirty=!0,t.samplingMode=9984);var r=this._context.getBoundTexture(0);this._context.bindTexture(this,0);var i=this._context.gl;i.generateMipmap(i.TEXTURE_2D),this._context.bindTexture(r,0)},e.prototype.setSamplingMode=function(t){t!==this._desc.samplingMode&&(this._desc.samplingMode=t,e._validateTexture(this._desc),this._samplingModeDirty=!0)},e.prototype.setWrapMode=function(t){t!==this._desc.wrapMode&&(this._desc.wrapMode=t,e._validateTexture(this._desc),this._wrapModeDirty=!0)},e.prototype.applyChanges=function(){var t=this._context.gl,r=this._desc;this._samplingModeDirty&&(e._applySamplingMode(t,r),this._samplingModeDirty=!1),this._wrapModeDirty&&(e._applyWrapMode(t,r),this._wrapModeDirty=!1)},e.prototype.setBoundToUnit=function(e,t){t?this._boundToUnits.add(e):this._boundToUnits.delete(e)},e._isPowerOfTwo=function(e){return 0==(e&e-1)},e._validateTexture=function(t){(t.width<0||t.height<0)&&console.error("Negative dimension parameters are not allowed!"),e._isPowerOfTwo(t.width)&&e._isPowerOfTwo(t.height)||(33071!==t.wrapMode&&console.error("Non-power-of-two textures must have a wrap mode of CLAMP_TO_EDGE!"),t.hasMipmap&&console.error("Mipmapping requires power-of-two textures!"))},e._applySamplingMode=function(e,t){var r=t.samplingMode;9985===r||9987===r?r=9729:9984!==r&&9986!==r||(r=9728),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,t.samplingMode)},e._applyWrapMode=function(e,t){e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,t.wrapMode),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,t.wrapMode)},e._applyAnisotropicFilteringParameters=function(e,t){if(null!=t.maxAnisotropy){var r=e.capabilities.textureFilterAnisotropic;if(r){var i=e.gl;i.texParameterf(i.TEXTURE_2D,r.TEXTURE_MAX_ANISOTROPY,t.maxAnisotropy)}}},e._nextId=0,e}()}.apply(null,i))||(e.exports=n)},1275:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10),r(1444),r(1270)],void 0===(n=function(e,t,r,i,n){return function(){function e(t,a,o,s){if(this._context=null,this._glName=null,this._depthAttachment=null,this._stencilAttachment=null,this._colorAttachment=null,this._initialized=!1,this._context=t,this._desc={colorTarget:a.colorTarget,depthStencilTarget:a.depthStencilTarget,width:a.width,height:a.height,multisampled:a.multisampled},this._id=e._nextId++,r("esri-webgl-debug")&&t.instanceCounter.incrementCount(4),o){var l=void 0;o instanceof n?(this._colorAttachment=o,l=o.descriptor):(l=o,this._colorAttachment=new n(this._context,l)),0!==this._desc.colorTarget&&console.error("Framebuffer is initialized with a texture however the descriptor indicates using a renderbuffer color attachment!"),e._validateTextureDimensions(l,this._desc)}if(s instanceof i)2===a.depthStencilTarget?this._stencilAttachment=s:1===a.depthStencilTarget||3===a.depthStencilTarget?this._depthAttachment=s:console.error('If a Renderbuffer is provided, "depthStencilTarget" must be one of STENCIL_RENDER_BUFFER, DEPTH_RENDER_BUFFER or DEPTH_STENCIL_RENDER_BUFFER'),e._validateBufferDimensions(s.descriptor,this._desc);else if(s){this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!");var c=void 0;s instanceof n?(this._depthStencilTexture=s,c=this._depthStencilTexture.descriptor):(c=s,this._depthStencilTexture=new n(this._context,c)),e._validateTextureDimensions(c,this._desc)}}return e.create=function(t,r){return new e(t,r)},e.createWithAttachments=function(t,r,i,n){return new e(t,i,r,n)},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"colorTexture",{get:function(){return this._colorAttachment instanceof n?this._colorAttachment:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depthStencilTexture",{get:function(){return this._depthStencilTexture},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._desc.width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._desc.height},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){this._context&&(this._disposeColorAttachment(),this._disposeDepthStencilAttachments(),this._glName&&(this._context.gl.deleteFramebuffer(this._glName),this._glName=null),r("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(4),this._context=null)},e.prototype.attachColorTexture=function(t){if(t){var r=t.descriptor;if(e._validateTextureDimensions(r,this._desc),this._disposeColorAttachment(),this._initialized){this._context.bindFramebuffer(this);var i=this._context.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,t.glName,0)}this._colorAttachment=t}},e.prototype.detachColorTexture=function(){var e=void 0;if(this._colorAttachment instanceof n){if(e=this._colorAttachment,this._initialized){this._context.bindFramebuffer(this);var t=this._context.gl;this._context.gl.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0)}this._colorAttachment=null}return e},e.prototype.attachDepthStencilTexture=function(t){if(t){var r=t.descriptor;if(34041!==r.pixelFormat&&console.error("Depth/Stencil texture must have a pixel type of DEPTH_STENCIL!"),34042!==r.dataType&&console.error("Depth/Stencil texture must have data type of UNSIGNED_INT_24_8_WEBGL!"),this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture!"),e._validateTextureDimensions(r,this._desc),4!==this._desc.depthStencilTarget&&(this._desc.depthStencilTarget=4),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);var i=this._context.gl;i.framebufferTexture2D(i.FRAMEBUFFER,i.DEPTH_STENCIL_ATTACHMENT,i.TEXTURE_2D,t.glName,0)}this._depthStencilTexture=t}},e.prototype.detachDepthStencilTexture=function(){var e=this._depthStencilTexture;if(e&&this._initialized){this._context.bindFramebuffer(this);var t=this._context.gl;this._context.gl.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,null,0)}return this._depthStencilTexture=null,e},e.prototype.attachDepthStencilBuffer=function(t){if(t){var r=t.descriptor;if(34041!==r.internalFormat&&33189!==r.internalFormat&&console.error("Depth/Stencil buffer must have correct internalFormat"),e._validateBufferDimensions(r,this._desc),this._disposeDepthStencilAttachments(),this._desc.depthStencilTarget=34041===r.internalFormat?3:1,this._initialized){this._context.bindFramebuffer(this);var i=this._context.gl,n=1===this._desc.depthStencilTarget?i.DEPTH_ATTACHMENT:i.DEPTH_STENCIL_ATTACHMENT;i.framebufferRenderbuffer(i.FRAMEBUFFER,n,i.RENDERBUFFER,t.glName)}this._depthAttachment=t}},e.prototype.detachDepthStencilBuffer=function(){var e=this._context.gl,t=this._depthAttachment;if(t&&this._initialized){this._context.bindFramebuffer(this);var r=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,r,e.RENDERBUFFER,null)}return this._depthAttachment=null,t},e.prototype.copyToTexture=function(e,t,r,i,n,a,o){(e<0||t<0||n<0||a<0)&&console.error("Offsets cannot be negative!"),(r<=0||i<=0)&&console.error("Copy width and height must be greater than zero!");var s=this._desc,l=o.descriptor;3553!==o.descriptor.target&&console.error("Texture target must be TEXTURE_2D!"),(e+r>s.width||t+i>s.height||n+r>l.width||a+i>l.height)&&console.error("Bad dimensions, the current input values will attempt to read or copy out of bounds!");var c=this._context;c.bindTexture(o),c.bindFramebuffer(this),c.gl.copyTexSubImage2D(3553,0,n,a,e,t,r,i)},e.prototype.readPixels=function(e,t,r,i,n,a,o){(r<=0||i<=0)&&console.error("Copy width and height must be greater than zero!"),o||console.error("Target memory is not initialized!"),this._context.bindFramebuffer(this),this._context.gl.readPixels(e,t,r,i,n,a,o)},e.prototype.resize=function(t,r){var i=this._desc;if(i.width!==t||i.height!==r){if(!this._initialized){if(i.width=t,i.height=r,this._colorAttachment instanceof n)(a=this._colorAttachment).resize(t,r);return void(this._depthStencilTexture&&this._depthStencilTexture.resize(t,r))}var a,o;if(i.width=t,i.height=r,this._colorAttachment instanceof n)(o=(a=this._colorAttachment).descriptor).width=t,o.height=r,this._colorAttachment.dispose(),this._colorAttachment=new n(this._context,o),e._validateTextureDimensions(a.descriptor,this._desc);else this._colorAttachment&&this._disposeColorAttachment();if(null!=this._depthStencilTexture)(o=this._depthStencilTexture.descriptor).width=t,o.height=r,this._depthStencilTexture.dispose(),this._depthStencilTexture=new n(this._context,o);else(this._depthAttachment||this._stencilAttachment)&&this._disposeDepthStencilAttachments();this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1}},e.prototype.initialize=function(){if(this._initialized)return!1;var e=this._context.gl;this._glName&&e.deleteFramebuffer(this._glName);var t=e.createFramebuffer(),r=this._desc;if(e.bindFramebuffer(e.FRAMEBUFFER,t),!this._colorAttachment)if(0===r.colorTarget){var a={target:3553,pixelFormat:6408,dataType:5121,samplingMode:9728,wrapMode:33071,width:r.width,height:r.height};this._colorAttachment=new n(this._context,a)}else{var o=new i(this._context,{internalFormat:32854,width:r.width,height:r.height});e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,o.glName),this._colorAttachment=o}if(this._colorAttachment instanceof n){var s=this._colorAttachment;e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,s.glName,0)}switch(r.depthStencilTarget){case 1:case 3:this._depthAttachment||(this._depthAttachment=new i(this._context,{internalFormat:1===r.depthStencilTarget?33189:34041,width:r.width,height:r.height}));var l=1===r.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,l,e.RENDERBUFFER,this._depthAttachment.glName);break;case 2:this._stencilAttachment||(this._stencilAttachment=new i(this._context,{internalFormat:36168,width:r.width,height:r.height})),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,this._stencilAttachment.glName);break;case 4:if(!this._depthStencilTexture){this._context.capabilities.depthTexture||console.error("Extension WEBGL_depth_texture isn't supported therefore it is no possible to set the depth/stencil texture as an attachment!");var c={target:3553,pixelFormat:34041,dataType:34042,samplingMode:9728,wrapMode:33071,width:r.width,height:r.height};this._depthStencilTexture=new n(this._context,c)}e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,this._depthStencilTexture.glName,0)}return e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer is incomplete!"),this._glName=t,this._initialized=!0,!0},e.prototype._disposeColorAttachment=function(){if(this._colorAttachment instanceof n){var e=this._colorAttachment;if(this._initialized)this._context.bindFramebuffer(this),(r=this._context.gl).framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,null,0);e.dispose()}else if(this._colorAttachment instanceof WebGLRenderbuffer){var t=this._colorAttachment,r=this._context.gl;this._initialized&&(this._context.bindFramebuffer(this),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,null)),this._context.gl.deleteRenderbuffer(t)}this._colorAttachment=null},e.prototype._disposeDepthStencilAttachments=function(){var e=this._context.gl;if(this._depthAttachment){if(this._initialized){this._context.bindFramebuffer(this);var t=1===this._desc.depthStencilTarget?e.DEPTH_ATTACHMENT:e.DEPTH_STENCIL_ATTACHMENT;e.framebufferRenderbuffer(e.FRAMEBUFFER,t,e.RENDERBUFFER,null)}this._depthAttachment.dispose(),this._depthAttachment=null}this._stencilAttachment&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.STENCIL_ATTACHMENT,e.RENDERBUFFER,null)),this._stencilAttachment.dispose(),this._stencilAttachment=null),this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,null,0)),this._depthStencilTexture.dispose(),this._depthStencilTexture=null)},e._validateBufferDimensions=function(e,t){console.assert(e.width>=0&&e.height>=0),void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Renderbuffer dimensions must match the framebuffer's!"):(t.width=e.width,t.height=e.height)},e._validateTextureDimensions=function(e,t){console.assert(e.width>=0&&e.height>=0),3553!==e.target&&console.error("Texture type must be TEXTURE_2D!"),void 0!==t.width&&t.width>=0&&void 0!==t.height&&t.height>=0?t.width===e.width&&t.height===e.height||console.error("Color attachment texture must match the framebuffer's!"):(t.width=e.width,t.height=e.height)},e._nextId=0,e}()}.apply(null,i))||(e.exports=n)},1343:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(8)],void 0===(n=function(e,t,i){Object.defineProperty(t,"__esModule",{value:!0}),t.layerLookupMap={CSVLayer:function(){return i.create(function(e){return Promise.resolve().then(function(){var t=[r(246)];e.apply(null,t)}.bind(this)).catch(r.oe)})},ElevationLayer:function(){return i.create(function(e){return r.e(14).then(function(){var t=[r(1229)];e.apply(null,t)}.bind(this)).catch(r.oe)})},FeatureLayer:function(){return i.create(function(e){return Promise.resolve().then(function(){var t=[r(94)];e.apply(null,t)}.bind(this)).catch(r.oe)})},GroupLayer:function(){return i.create(function(e){return Promise.resolve().then(function(){var t=[r(238)];e.apply(null,t)}.bind(this)).catch(r.oe)})},GeoRSSLayer:function(){return i.create(function(e){return r.e(16).then(function(){var t=[r(1237)];e.apply(null,t)}.bind(this)).catch(r.oe)})},ImageryLayer:function(){return i.create(function(e){return r.e(31).then(function(){var t=[r(1235)];e.apply(null,t)}.bind(this)).catch(r.oe)})},KMLLayer:function(){return i.create(function(e){return r.e(18).then(function(){var t=[r(1238)];e.apply(null,t)}.bind(this)).catch(r.oe)})},MapImageLayer:function(){return i.create(function(e){return Promise.resolve().then(function(){var t=[r(137)];e.apply(null,t)}.bind(this)).catch(r.oe)})},MapNotesLayer:function(){return i.create(function(e){return r.e(51).then(function(){var t=[r(1493)];e.apply(null,t)}.bind(this)).catch(r.oe)})},OpenStreetMapLayer:function(){return i.create(function(e){return r.e(19).then(function(){var t=[r(1239)];e.apply(null,t)}.bind(this)).catch(r.oe)})},PointCloudLayer:function(){return i.create(function(e){return r.e(30).then(function(){var t=[r(1240)];e.apply(null,t)}.bind(this)).catch(r.oe)})},SceneLayer:function(){return i.create(function(e){return Promise.resolve().then(function(){var t=[r(244)];e.apply(null,t)}.bind(this)).catch(r.oe)})},IntegratedMeshLayer:function(){return i.create(function(e){return r.e(17).then(function(){var t=[r(1230)];e.apply(null,t)}.bind(this)).catch(r.oe)})},StreamLayer:function(){return i.create(function(e){return r.e(13).then(function(){var t=[r(1236)];e.apply(null,t)}.bind(this)).catch(r.oe)})},TileLayer:function(){return i.create(function(e){return r.e(52).then(function(){var t=[r(458)];e.apply(null,t)}.bind(this)).catch(r.oe)})},UnknownLayer:function(){return i.create(function(e){return r.e(53).then(function(){var t=[r(1494)];e.apply(null,t)}.bind(this)).catch(r.oe)})},UnsupportedLayer:function(){return i.create(function(e){return r.e(54).then(function(){var t=[r(1495)];e.apply(null,t)}.bind(this)).catch(r.oe)})},VectorTileLayer:function(){return i.create(function(e){return Promise.all([r.e(5),r.e(20)]).then(function(){var t=[r(1233)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WebTileLayer:function(){return i.create(function(e){return r.e(21).then(function(){var t=[r(1232)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WMSLayer:function(){return i.create(function(e){return r.e(22).then(function(){var t=[r(1241)];e.apply(null,t)}.bind(this)).catch(r.oe)})},WMTSLayer:function(){return i.create(function(e){return r.e(85).then(function(){var t=[r(1496)];e.apply(null,t)}.bind(this)).catch(r.oe)})},BingMapsLayer:function(){return i.create(function(e){return r.e(7).then(function(){var t=[r(245)];e.apply(null,t)}.bind(this)).catch(r.oe)})}}}.apply(null,i))||(e.exports=n)},1431:function(e,t,r){var i;void 0===(i=function(){var e={defaultNoDataValue:-3.4027999387901484e38,decode:function(a,o){var s=(o=o||{}).encodedMaskData||null===o.encodedMaskData,l=n(a,o.inputOffset||0,s),c=null!=o.noDataValue?o.noDataValue:e.defaultNoDataValue,u=t(l,o.pixelType||Float32Array,o.encodedMaskData,c,o.returnMask),h={width:l.width,height:l.height,pixelData:u.resultPixels,minValue:l.pixels.minValue,maxValue:l.pixels.maxValue,noDataValue:c};return u.resultMask&&(h.maskData=u.resultMask),o.returnEncodedMask&&l.mask&&(h.encodedMaskData=l.mask.bitset?l.mask.bitset:null),o.returnFileInfo&&(h.fileInfo=r(l),o.computeUsedBitDepths&&(h.fileInfo.bitDepths=i(l))),h}},t=function(e,t,r,i,n){var o,s,l=0,c=e.pixels.numBlocksX,u=e.pixels.numBlocksY,h=Math.floor(e.width/c),p=Math.floor(e.height/u),d=2*e.maxZError;r=r||(e.mask?e.mask.bitset:null),o=new t(e.width*e.height),n&&r&&(s=new Uint8Array(e.width*e.height));for(var f,m,y=new Float32Array(h*p),_=0;_<=u;_++){var g=_!==u?p:e.height%u;if(0!==g)for(var v=0;v<=c;v++){var T=v!==c?h:e.width%c;if(0!==T){var x,b,E,w,A=_*e.width*p+v*h,M=e.width-T,S=e.pixels.blocks[l];if(S.encoding<2?(0===S.encoding?x=S.rawData:(a(S.stuffedData,S.bitsPerPixel,S.numValidPixels,S.offset,d,y,e.pixels.maxValue),x=y),b=0):E=2===S.encoding?0:S.offset,r)for(m=0;m<g;m++){for(7&A&&(w=r[A>>3],w<<=7&A),f=0;f<T;f++)7&A||(w=r[A>>3]),128&w?(s&&(s[A]=1),o[A++]=S.encoding<2?x[b++]:E):(s&&(s[A]=0),o[A++]=i),w<<=1;A+=M}else if(S.encoding<2)for(m=0;m<g;m++){for(f=0;f<T;f++)o[A++]=x[b++];A+=M}else for(m=0;m<g;m++){for(f=0;f<T;f++)o[A++]=E;A+=M}if(1===S.encoding&&b!==S.numValidPixels)throw"Block and Mask do not match";l++}}}return{resultPixels:o,resultMask:s}},r=function(e){return{fileIdentifierString:e.fileIdentifierString,fileVersion:e.fileVersion,imageType:e.imageType,height:e.height,width:e.width,maxZError:e.maxZError,eofOffset:e.eofOffset,mask:e.mask?{numBlocksX:e.mask.numBlocksX,numBlocksY:e.mask.numBlocksY,numBytes:e.mask.numBytes,maxValue:e.mask.maxValue}:null,pixels:{numBlocksX:e.pixels.numBlocksX,numBlocksY:e.pixels.numBlocksY,numBytes:e.pixels.numBytes,maxValue:e.pixels.maxValue,minValue:e.pixels.minValue,noDataValue:this.noDataValue}}},i=function(e){for(var t=e.pixels.numBlocksX*e.pixels.numBlocksY,r={},i=0;i<t;i++){var n=e.pixels.blocks[i];0===n.encoding?r.float32=!0:1===n.encoding?r[n.bitsPerPixel]=!0:r[0]=!0}return Object.keys(r)},n=function(e,t,r){var i={},n=new Uint8Array(e,t,10);if(i.fileIdentifierString=String.fromCharCode.apply(null,n),"CntZImage"!=i.fileIdentifierString.trim())throw"Unexpected file identifier string: "+i.fileIdentifierString;t+=10;var a=new DataView(e,t,24);if(i.fileVersion=a.getInt32(0,!0),i.imageType=a.getInt32(4,!0),i.height=a.getUint32(8,!0),i.width=a.getUint32(12,!0),i.maxZError=a.getFloat64(16,!0),t+=24,!r)if(a=new DataView(e,t,16),i.mask={},i.mask.numBlocksY=a.getUint32(0,!0),i.mask.numBlocksX=a.getUint32(4,!0),i.mask.numBytes=a.getUint32(8,!0),i.mask.maxValue=a.getFloat32(12,!0),t+=16,i.mask.numBytes>0){var o=new Uint8Array(Math.ceil(i.width*i.height/8)),s=(a=new DataView(e,t,i.mask.numBytes)).getInt16(0,!0),l=2,c=0;do{if(s>0)for(;s--;)o[c++]=a.getUint8(l++);else{var u=a.getUint8(l++);for(s=-s;s--;)o[c++]=u}s=a.getInt16(l,!0),l+=2}while(l<i.mask.numBytes);if(-32768!==s||c<o.length)throw"Unexpected end of mask RLE encoding";i.mask.bitset=o,t+=i.mask.numBytes}else if(0==(i.mask.numBytes|i.mask.numBlocksY|i.mask.maxValue)){o=new Uint8Array(Math.ceil(i.width*i.height/8));i.mask.bitset=o}a=new DataView(e,t,16),i.pixels={},i.pixels.numBlocksY=a.getUint32(0,!0),i.pixels.numBlocksX=a.getUint32(4,!0),i.pixels.numBytes=a.getUint32(8,!0),i.pixels.maxValue=a.getFloat32(12,!0),t+=16;var h=i.pixels.numBlocksX,p=i.pixels.numBlocksY,d=h+(i.width%h>0?1:0),f=p+(i.height%p>0?1:0);i.pixels.blocks=new Array(d*f);for(var m=1e9,y=0,_=0;_<f;_++)for(var g=0;g<d;g++){var v=0,T=e.byteLength-t;a=new DataView(e,t,Math.min(10,T));var x={};i.pixels.blocks[y++]=x;var b=a.getUint8(0);if(v++,x.encoding=63&b,x.encoding>3)throw"Invalid block encoding ("+x.encoding+")";if(2!==x.encoding){if(0!==b&&2!==b){if(b>>=6,x.offsetType=b,2===b)x.offset=a.getInt8(1),v++;else if(1===b)x.offset=a.getInt16(1,!0),v+=2;else{if(0!==b)throw"Invalid block offset type";x.offset=a.getFloat32(1,!0),v+=4}if(m=Math.min(x.offset,m),1===x.encoding)if(b=a.getUint8(v),v++,x.bitsPerPixel=63&b,b>>=6,x.numValidPixelsType=b,2===b)x.numValidPixels=a.getUint8(v),v++;else if(1===b)x.numValidPixels=a.getUint16(v,!0),v+=2;else{if(0!==b)throw"Invalid valid pixel count type";x.numValidPixels=a.getUint32(v,!0),v+=4}}var E;if(t+=v,3!=x.encoding)if(0===x.encoding){var w=(i.pixels.numBytes-1)/4;if(w!==Math.floor(w))throw"uncompressed block has invalid length";E=new ArrayBuffer(4*w),new Uint8Array(E).set(new Uint8Array(e,t,4*w));for(var A=new Float32Array(E),M=0;M<A.length;M++)m=Math.min(m,A[M]);x.rawData=A,t+=4*w}else if(1===x.encoding){var S=Math.ceil(x.numValidPixels*x.bitsPerPixel/8),D=Math.ceil(S/4);E=new ArrayBuffer(4*D),new Uint8Array(E).set(new Uint8Array(e,t,S)),x.stuffedData=new Uint32Array(E),t+=S}}else t++,m=Math.min(m,0)}return i.pixels.minValue=m,i.eofOffset=t,i},a=function(e,t,r,i,n,a,o){var s,l,c,u=(1<<t)-1,h=0,p=0,d=Math.ceil((o-i)/n),f=4*e.length-Math.ceil(t*r/8);for(e[e.length-1]<<=8*f,s=0;s<r;s++){if(0===p&&(c=e[h++],p=32),p>=t)l=c>>>p-t&u,p-=t;else{var m=t-p;l=(c&u)<<m&u,l+=(c=e[h++])>>>(p=32-m)}a[s]=l<d?i+l*n:o}return a};return e}.apply(null,[]))||(e.exports=i)},1444:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(10)],void 0===(n=function(e,t,r){return function(){function e(t,i){this._context=t,this._desc=i,this._glName=null,this._id=-1;var n=this._context.gl;r("esri-webgl-debug")&&this._context.instanceCounter.incrementCount(5),this._id=++e._nextId,this._glName=n.createRenderbuffer(),this._context.bindRenderbuffer(this),n.renderbufferStorage(n.RENDERBUFFER,i.internalFormat,i.width,i.height)}return Object.defineProperty(e.prototype,"descriptor",{get:function(){return this._desc},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"glName",{get:function(){return this._glName},enumerable:!0,configurable:!0}),e.prototype.resize=function(e,t){var r=this._context.gl,i=this._desc;i.width===e&&i.height===t||(i.width=e,i.height=t,this._context.bindRenderbuffer(this),r.renderbufferStorage(r.RENDERBUFFER,i.internalFormat,i.width,i.height))},e.prototype.dispose=function(){this._glName&&(this._context.gl.deleteRenderbuffer(this._glName),this._glName=null),r("esri-webgl-debug")&&this._context.instanceCounter.decrementCount(5),this._context=null},e._nextId=0,e}()}.apply(null,i))||(e.exports=n)},1445:function(e,t,r){var i,n;i=[r(14),r(13),r(28),r(62),r(176)],void 0===(n=function(e){return e.getObject("xml.parser",!0,dojox),dojox.xml.parser.parse=function(t,r){var i,n=e.doc;if(r=r||"text/xml",t&&e.trim(t)&&"DOMParser"in e.global){var a=new DOMParser,o=(i=a.parseFromString(t,r)).documentElement,s="http://www.mozilla.org/newlayout/xml/parsererror.xml";if("parsererror"==o.nodeName&&o.namespaceURI==s){var l=o.getElementsByTagNameNS(s,"sourcetext")[0];throw l&&(l=l.firstChild.data),new Error("Error parsing text "+o.firstChild.data+" \n"+l)}return i}if("ActiveXObject"in e.global){var c=function(e){return"MSXML"+e+".DOMDocument"},u=["Microsoft.XMLDOM",c(6),c(4),c(3),c(2)];if(e.some(u,function(e){try{i=new ActiveXObject(e)}catch(e){return!1}return!0}),t&&i){i.async=!1,i.loadXML(t);var h=i.parseError;if(0!==h.errorCode)throw new Error("Line: "+h.line+"\nCol: "+h.linepos+"\nReason: "+h.reason+"\nError Code: "+h.errorCode+"\nSource: "+h.srcText)}if(i)return i}else if(n.implementation&&n.implementation.createDocument){if(t&&e.trim(t)&&n.createElement){var p=n.createElement("xml");p.innerHTML=t;var d=n.implementation.createDocument("foo","",null);return e.forEach(p.childNodes,function(e){d.importNode(e,!0)}),d}return n.implementation.createDocument("","",null)}return null},dojox.xml.parser.textContent=function(t,r){if(arguments.length>1){var i=t.ownerDocument||e.doc;return dojox.xml.parser.replaceChildren(t,i.createTextNode(r)),r}if(void 0!==t.textContent)return t.textContent;var n="";return t&&e.forEach(t.childNodes,function(e){switch(e.nodeType){case 1:case 5:n+=dojox.xml.parser.textContent(e);break;case 3:case 2:case 4:n+=e.nodeValue}}),n},dojox.xml.parser.replaceChildren=function(t,r){var i=[];e.isIE&&e.forEach(t.childNodes,function(e){i.push(e)}),dojox.xml.parser.removeChildren(t),e.forEach(i,e.destroy),e.isArray(r)?e.forEach(r,function(e){t.appendChild(e)}):t.appendChild(r)},dojox.xml.parser.removeChildren=function(e){for(var t=e.childNodes.length;e.hasChildNodes();)e.removeChild(e.firstChild);return t},dojox.xml.parser.innerXML=function(e){return e.innerXML?e.innerXML:e.xml?e.xml:"undefined"!=typeof XMLSerializer?(new XMLSerializer).serializeToString(e):null},dojox.xml.parser}.apply(null,i))||(e.exports=n)},2169:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(11),r(1),r(82),r(8),r(17),r(0),r(1588),r(1722),r(1745),r(1748)],void 0===(n=function(e,t,r,i,n,a,o,s,l,c,u,h){return function(e){function t(t){return e.call(this)||this}return r(t,e),t.prototype.initialize=function(){var e,t,r,i=this,s=this.layer.compatibleTileInfo256,l=this._getTileInfoSupportError(s,this.layer.fullExtent);l?this.addResolvingPromise(a.reject(l)):t=o.whenTrueOnce(this.view,"basemapTerrain.tilingSchemeLocked").then(function(){var e,t=i.view.basemapTerrain.tilingScheme,r=t.pixelSize[0];i.schemeHelper=new c(r,i.view.spatialReference.isWGS84),e=256===r?i.layer.compatibleTileInfo256:i.view.spatialReference.isWGS84?i.layer.compatibleTileInfo512:i.layer.tileInfo;var n=i._getTileInfoCompatibilityError(e,t);if(n)throw n;i.tileInfo=e,i._updateMinMaxDataLevel()}),e=this._initializeTileHandler(),this.tileHandler=e[0],this.renderer=e[1],r=e[2],this._tileHandlerPromise=r,this.watch("layer.currentStyleInfo",function(){var e,t,n,a;i._tileHandlerPromise.isFulfilled()||i._tileHandlerPromise.cancel(),e=i._initializeTileHandler(),t=e[0],n=e[1],a=e[2],i._tileHandlerPromise=r,a.then(function(){var e=i.tileHandler;i.renderer=n,i.tileHandler=t,i.emit("data-changed"),e.destroy()})});var u=n([t,r]);this.addResolvingPromise(u)},t.prototype.destroy=function(){this.renderer=null,this.tileHandler.destroy(),this.tileHandler=null},t.prototype._initializeTileHandler=function(){var e=new u(this.layer,function(){},1),t=new h,r=e.start();return r.then(function(){t.initialize(e.spriteMosaic,e.glyphMosaic,!1)}),[e,t,r]},i([s.property({aliasOf:"layer.fullExtent"})],t.prototype,"fullExtent",void 0),i([s.property()],t.prototype,"layer",void 0),i([s.property()],t.prototype,"updatingPercentageValue",void 0),i([s.subclass("esri.views.3d.layers.VectorTileLayerView3D")],t)}(s.declared(l))}.apply(null,i))||(e.exports=n)},458:function(e,t,r){var i,n;i=[r.dj.c(e.i),t,r(12),r(2),r(1),r(78),r(29),r(27),r(8),r(22),r(0),r(77),r(1341),r(476),r(132),r(130),r(240),r(169),r(1231),r(129)],void 0===(n=function(e,t,i,n,a,o,s,l,c,u,h,p,d,f,m,y,_,g,v,T){var x=["Canvas/World_Dark_Gray_Base","Canvas/World_Dark_Gray_Reference","Canvas/World_Light_Gray_Base","Canvas/World_Light_Gray_Reference","Elevation/World_Hillshade","Ocean/World_Ocean_Base","Ocean/World_Ocean_Reference","Ocean_Basemap","Reference/World_Boundaries_and_Places","Reference/World_Boundaries_and_Places_Alternate","Reference/World_Transportation","World_Imagery","World_Street_Map","World_Topo_Map"];return function(e){function t(t,r){var i=e.call(this)||this;return i.url=null,i.type="tile",i.spatialReference=null,i}return n(t,e),t.prototype.normalizeCtorArgs=function(e,t){return"string"==typeof e?i({url:e},t):e},t.prototype.load=function(){var e=this;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Image Service","Map Service"]}).always(function(){return e._fetchService()})),this.when()},Object.defineProperty(t.prototype,"operationalLayerType",{get:function(){if(this.capabilities)return this.capabilities.operations.supportsExportMap?"ArcGISTiledMapServiceLayer":"ArcGISTiledImageServiceLayer";var e=this.url||this.portalItem&&this.portalItem.url;return e&&/\/ImageServer(\/|\/?$)/i.test(e)?"ArcGISTiledImageServiceLayer":"ArcGISTiledMapServiceLayer"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"attributionDataUrl",{get:function(){return this._getDefaultAttribution(this._getMapName(this.parsedUrl.path.toLowerCase()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tileServers",{get:function(){return this._getDefaultTileServers(this.parsedUrl.path)},enumerable:!0,configurable:!0}),t.prototype.castTileServers=function(e){return Array.isArray(e)?e.map(function(e){return u.urlToObject(e).path}):null},t.prototype.readSpatialReference=function(e,t){return(e=e||t.tileInfo&&t.tileInfo.spatialReference)&&s.SpatialReference.fromJSON(e)},t.prototype.fetchTile=function(e,t,r,i){var n=this.getTileUrl(e,t,r),a={responseType:"image",allowImageDataAccess:i&&i.allowImageDataAccess||!1};return i&&i.timestamp&&(a.query={_ts:i.timestamp}),l(n,a).then(function(e){return e.data})},t.prototype.getTileUrl=function(e,t,r){var n=!this.tilemapCache&&this.supportsBlankTile,a=o.objectToQuery(i({},this.parsedUrl.query,{blankTile:!n&&null,token:this.token?encodeURIComponent(this.token):null})),s=this.tileServers;return(s&&s.length?s[t%s.length]:this.parsedUrl.path)+"/tile/"+e+"/"+t+"/"+r+(a?"?"+a:"")},t.prototype.importLayerViewModule=function(e){switch(e.type){case"2d":return c.create(function(e){return r.e(12).then(function(){var t=[r(1471)];e.apply(null,t)}.bind(this)).catch(r.oe)});case"3d":return c.create(function(e){return Promise.all([r.e(4),r.e(5),r.e(6),r.e(59)]).then(function(){var t=[r(1461)];e.apply(null,t)}.bind(this)).catch(r.oe)})}},t.prototype._fetchService=function(){var e=this;return c.create(function(t,r){e.resourceInfo?t({data:e.resourceInfo}):l(e.parsedUrl.path,{query:i({f:"json"},e.parsedUrl.query),responseType:"json",callbackParamName:"callback"}).then(t,r)}).then(function(t){if(t.ssl&&(e.url=e.url.replace(/^http:/i,"https:")),e.read(t.data,{origin:"service",url:e.parsedUrl}),10.1===e.version&&!T.isHostedAgolService(e.url))return v.fetchServerVersion(e.url).then(function(t){e.read({currentVersion:t})}).catch(function(){})})},t.prototype._getMapName=function(e){var t=e.match(/^(?:https?:)?\/\/(server|services)\.arcgisonline\.com\/arcgis\/rest\/services\/([^\/]+(\/[^\/]+)*)\/mapserver/i);return t&&t[2]},t.prototype._getDefaultAttribution=function(e){if(e){var t;e=e.toLowerCase();for(var r=0,i=x.length;r<i;r++)if((t=x[r]).toLowerCase().indexOf(e)>-1)return u.makeAbsolute("//static.arcgis.com/attribution/"+t)}},t.prototype._getDefaultTileServers=function(e){var t=-1!==e.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),r=-1!==e.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return t||r?[e,e.replace(t?/server\.arcgisonline/i:/services\.arcgisonline/i,t?"services.arcgisonline":"server.arcgisonline")]:[]},a([h.property({readOnly:!0})],t.prototype,"operationalLayerType",null),a([h.property({readOnly:!0,dependsOn:["parsedUrl"]})],t.prototype,"attributionDataUrl",null),a([h.property()],t.prototype,"popupTemplates",void 0),a([h.property()],t.prototype,"resourceInfo",void 0),a([h.property({dependsOn:["parsedUrl"]})],t.prototype,"tileServers",null),a([h.cast("tileServers")],t.prototype,"castTileServers",null),a([h.property({json:{origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writer:u.writeOperationalLayerUrl}}}}})],t.prototype,"url",void 0),a([h.property({readOnly:!0,json:{read:!1}})],t.prototype,"type",void 0),a([h.property({type:s.SpatialReference})],t.prototype,"spatialReference",void 0),a([h.reader("spatialReference",["spatialReference","tileInfo"])],t.prototype,"readSpatialReference",null),a([h.subclass("esri.layers.TileLayer")],t)}(h.declared(p,f,d,g,m,y,_))}.apply(null,i))||(e.exports=n)}}]);
(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/sources/support/CSVSourceWorker":560,"esri/views/3d/layers/SceneLayerWorker":1519,"esri/views/3d/layers/PointCloudWorker":1522,"esri/views/vectorTiles/WorkerTileHandler":1531,"esri/views/2d/layers/features/Pipeline":1532,"esri/views/webgl/Util":1569,"esri/views/3d/support/buffer/typedArrayUtil":1583,"esri/views/2d/engine/webgl/definitions":1606,"esri/views/3d/support/orientedBoundingBox":1629,"esri/views/3d/layers/i3s/I3SBinaryReader":1635,"esri/views/2d/engine/webgl/Rect":1726,"esri/views/2d/engine/webgl/Geometry":1729,"esri/views/2d/engine/webgl/GeometryUtils":1733,"esri/views/3d/layers/i3s/LEPCC":1742,"esri/views/2d/layers/features/support/Tile":1745,"esri/core/sql/WhereGrammar":1746,"esri/views/2d/engine/webgl/TileClipper":1748,"esri/views/2d/support/Evented":1750,"esri/views/3d/support/dito":1751,"esri/core/sql/WhereClause":1752,"esri/core/sql/AggregateFunctions":1753,"esri/core/sql/StandardizedFunctions":1754,"esri/core/sql/sql92grammar":1755,"esri/views/3d/layers/i3s/I3SProjectionUtil":1802,"esri/views/2d/layers/features/support/TileStore":1826,"esri/renderers/PointCloudRenderer":1827,"esri/views/2d/engine/webgl/TextShaping":1851,"esri/views/2d/engine/webgl/LineTess":1852,"esri/renderers/support/pointCloud/PointSizeAlgorithm":1858,"esri/views/3d/layers/i3s/I3SGeometryUtil":1859,"esri/layers/graphics/data/FeatureStore":1861,"esri/layers/graphics/data/attributeSupport":1862,"esri/layers/graphics/data/QueryEngine":1884,"esri/views/vectorTiles/Bucket":1903,"esri/renderers/PointCloudClassBreaksRenderer":1904,"esri/renderers/support/pointCloud/PointSizeFixedSizeAlgorithm":1905,"esri/renderers/support/pointCloud/PointSizeSplatAlgorithm":1906,"esri/renderers/PointCloudStretchRenderer":1907,"esri/renderers/PointCloudUniqueValueRenderer":1908,"esri/layers/graphics/data/utils":1909,"esri/views/vectorTiles/MemoryBuffer":1949,"esri/views/2d/layers/features/controllers":1950,"esri/views/3d/layers/i3s/PointCloudRendererUtil":1951,"esri/views/2d/tiling/enums":1979,"esri/renderers/support/pointCloud/ColorModulation":1980,"esri/renderers/support/pointCloud/pointSizeAlgorithmJSONUtils":1981,"esri/renderers/support/pointCloud/pointSizeAlgorithmTypeUtils":1982,"esri/renderers/support/pointCloud/ColorClassBreakInfo":1983,"esri/renderers/support/pointCloud/StopInfo":1984,"esri/renderers/support/pointCloud/ColorUniqueValueInfo":1985,"dstore/Csv":1989,"esri/layers/graphics/data/QueryEngineResult":1990,"esri/layers/graphics/data/AttributesBuilder":1991,"esri/layers/graphics/data/spatialQuerySupport":1992,"esri/views/vectorTiles/FillBucket":2028,"esri/core/executeAsync":2029,"esri/views/vectorTiles/BackgroundBucket":2030,"esri/views/vectorTiles/CircleBucket":2031,"esri/views/vectorTiles/LineBucket":2032,"esri/views/vectorTiles/Placement":2033,"esri/views/vectorTiles/SymbolBucket":2034,"esri/views/vectorTiles/WorkerTile":2142,"esri/views/vectorTiles/IndexMemoryBuffer":2143,"esri/views/vectorTiles/Conflict":2144,"esri/views/vectorTiles/TileParser":2145,"esri/views/vectorTiles/Feature":2146,"esri/views/vectorTiles/SourceLayerData":2147,"esri/views/vectorTiles/VertexMemoryBuffer":2148,"esri/views/2d/layers/features/processors":2149})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[36,7,10,46],{1519:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(38),r(20),r(1859),r(1802),r(1828),r(1629),r(93),r(1727),r(1559)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c,f){var h=function(){function e(){}return e.prototype.process=function(e){var t=[e.geometryBuffer];return r.resolve({result:this.transform(e,t),transferList:t})},e.prototype.transform=function(e,t){var r=i.fromJSON(e.indexSR),h=i.fromJSON(e.vertexSR),v=i.fromJSON(e.renderSR),y=!1,m=0,g=[],x=s.computeGlobalTransformation(e.mbs,e.elevationOffset,r,v),b=e.obb?null:u.create([0,0,0],[-1,-1,-1],[0,0,0,1]);n.vec3.copy(d,e.mbs),d[2]+=e.elevationOffset,n.vec3.copy(p,d);for(var _=0,I=e.geometryData;_<I.length;_++)for(var C=I[_],w=C.geometries,T=C.componentOffsets,P=0,S=w;P<S.length;P++){var A=S[P],M=e.layouts[m];++m;var E=[{name:f.VertexAttrConstants.COLOR,byteValue:255}],B=[f.VertexAttrConstants.NORMAL,f.VertexAttrConstants.NORMALCOMPRESSED,f.VertexAttrConstants.SYMBOLCOLOR,f.VertexAttrConstants.COMPONENTINDEX],D=o.interleaveGeometryBuffer(A,e.geometryBuffer,M,E,B),N=new c(new Float32Array(D),M,void 0,void 0,void 0,!0),V=N.getAttribute(f.VertexAttrConstants.POSITION);if(s.reprojectPoints(V,e.mbs,x,e.elevationOffset,r,h,v),b&&this._updateObb(b,V,x),e.needNormals){var F={normals:N.getAttribute(f.VertexAttrConstants.NORMALCOMPRESSED),positions:V,normalInd:N.getIndices(f.VertexAttrConstants.NORMALCOMPRESSED),positionInd:N.getIndices(f.VertexAttrConstants.POSITION)};o.processAndInterleaveNormals(e.normalReferenceFrame,A,e.geometryBuffer,x,F)}var O=N.getAttribute(f.VertexAttrConstants.COMPONENTINDEX);O&&this._createComponentNumbers(O,T);var z=N.getAttribute(f.VertexAttrConstants.COLOR);z&&!y&&(y=this._hasColors(z));var L={globalTrafo:x},j=M[0].stride,R=1-.8*j/(j+4),k=a.deduplicate(D,j/4,R);if(null!=k){var U=k.uniqueCount<65536?new Uint16Array(k.indices):k.indices,Y=o.extractPositionData(k.buffer,M,U);g.push({layout:M,interleavedVertexData:k.buffer,indices:U,corMatrices:L,hasColors:y,positionData:Y}),t&&(t.push(k.buffer),t.push(U.buffer),t.push(Y.data.buffer),t.push(Y.indices.buffer))}else{Y=o.extractPositionData(D,M);g.push({layout:M,interleavedVertexData:D,corMatrices:L,hasColors:y,positionData:Y}),t&&(t.push(D),t.push(Y.data.buffer),t.push(Y.indices.buffer))}}return b&&(n.vec3.transformMat4(b.center,b.center,x),l.vectorToVector(b.center,v,b.center,r),b.center[2]-=e.elevationOffset),{geometryBuffer:e.geometryBuffer,transformedGeometries:g,obb:b}},e.prototype._hasColors=function(e){for(var t=e.data,r=e.size,n=e.offsetIdx,i=e.strideIdx,o=n;o<t.length;o+=i)for(var s=0;s<r;s++)if(255!==t[o+s])return!0;return!1},e.prototype._createComponentNumbers=function(e,t){for(var r=e.data,n=e.offsetIdx,i=e.strideIdx,o=r.length/i,s=0,a=n,u=0;u<o;u++)u>=t[s+1]&&s++,r[a]=s,a+=i},e.prototype._updateObb=function(e,t,r){if(e.halfSize[0]>0){n.vec3.subtract(d,e.center,e.halfSize),n.vec3.add(p,e.center,e.halfSize);for(var i=t.offsetIdx;i<t.data.length;i+=t.strideIdx)d[0]=Math.min(d[0],t.data[i]),d[1]=Math.min(d[1],t.data[i+1]),d[2]=Math.min(d[2],t.data[i+2]),p[0]=Math.max(p[0],t.data[i]),p[1]=Math.max(p[1],t.data[i+1]),p[2]=Math.max(p[2],t.data[i+2]);n.vec3.subtract(e.halfSize,p,d),n.vec3.scale(e.halfSize,e.halfSize,.5),n.vec3.add(e.center,d,p),n.vec3.scale(e.center,e.center,.5)}else{u.compute(t,e);var o=2*Math.sqrt(1+r[0]+r[5]+r[10]);v[0]=(r[9]-r[6])/o,v[1]=(r[2]-r[8])/o,v[2]=(r[4]-r[1])/o,v[3]=.25*o,n.quat.conjugate(v,v),n.quat.multiply(e.quaternion,v,e.quaternion)}},e}(),d=n.vec3f64.create(),p=n.vec3f64.create(),v=n.quatf32.create();return h}.apply(null,n))||(e.exports=i)},1522:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(7),r(38),r(20),r(1635),r(1742),r(1951),r(93)],void 0===(i=function(e,t,r,n,i,o,s,a,u){var l=function(){function e(){}return e.prototype.transform=function(e,t){return this.thread?this.thread.invoke("_process",e,{transferList:t}):r.resolve(this._transform(e))},e.prototype._process=function(e){var t=this._transform(e);return r.resolve({result:t,transferList:[t.points.buffer,t.rgb.buffer]})},e.prototype._transform=function(e){var t=this.readGeometry(e.schema,e.geometryBuffer),r=t.length/3,n=a.evaluateRenderer(e.rendererInfo,e.primaryAttribute,e.modulationAttribute,t,r);e.filterInfo&&e.filterInfo.length>0&&(r=a.filterInPlace(t,n,e.filterInfo,e.filterAttributes)),3*r<n.length&&(n=new Uint8Array(n.buffer.slice(0,3*r))),this._applyElevationOffsetInPlace(t,r,e.elevationOffset);var o=this._transformCoordinates(t,r,e.obb,i.fromJSON(e.inSR),i.fromJSON(e.outSR));return{obb:e.obb,points:o,rgb:n}},e.prototype.readGeometry=function(e,t){if(null==e.encoding||""===e.encoding){for(var r=o.createGeometryDataIndex(t,e,!1),n=o.createTypedView(t,r.vertexAttributes.position),i=r.header.fields,a=[i.offsetX,i.offsetY,i.offsetZ],u=[i.scaleX,i.scaleY,i.scaleZ],l=n.length/3,c=new Float64Array(3*l),f=0;f<l;f++)c[3*f]=n[3*f]*u[0]+a[0],c[3*f+1]=n[3*f+1]*u[1]+a[1],c[3*f+2]=n[3*f+2]*u[2]+a[2];return c}if("lepcc-xyz"===e.encoding)return s.decodeXYZ(t).result},e.prototype._transformCoordinates=function(e,t,r,i,o){if(!u.bufferToBuffer(e,i,0,e,o,0,t))throw Error("Can't reproject");var s=n.vec3f32.fromValues(r.center[0],r.center[1],r.center[2]),a=n.vec3f32.create(),l=n.vec3f32.create();n.quat.conjugate(c,r.quaternion);for(var f=new Float32Array(3*t),h=0;h<t;h++)a[0]=e[3*h]-s[0],a[1]=e[3*h+1]-s[1],a[2]=e[3*h+2]-s[2],n.vec3.transformQuat(l,a,c),r.halfSize[0]=Math.max(r.halfSize[0],Math.abs(l[0])),r.halfSize[1]=Math.max(r.halfSize[1],Math.abs(l[1])),r.halfSize[2]=Math.max(r.halfSize[2],Math.abs(l[2])),f[3*h]=a[0],f[3*h+1]=a[1],f[3*h+2]=a[2];return f},e.prototype._applyElevationOffsetInPlace=function(e,t,r){if(0!==r)for(var n=0;n<t;n++)e[3*n+2]+=r},e}(),c=n.quatf32.create();return l}.apply(null,n))||(e.exports=i)},1531:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(21),r(7),r(1979),r(2142),r(574)],void 0===(i=function(e,t,r,n,i,o,s){return function(){function e(){this._tiles=new Map,this._spriteInfo={},this._glyphInfo={}}return e.prototype.reset=function(){this._spriteInfo={},this._glyphInfo={};var e=this._tiles;return e.forEach(function(e){return e.setObsolete()}),e.clear(),n.resolve()},e.prototype.getLayers=function(){return this._layers},e.prototype.setLayers=function(e){var t=new s(e);return this._layers=t.layers,n.resolve({data:""})},e.prototype.getTile=function(e,t){var s=this,a=e.key,u=e.cacheTile,l=o.pool.acquire();return l.initialize(e.key,e.refKey,this,e.rotation),r(e.url,{responseType:"array-buffer",signal:t&&t.signal}).then(function(e){return l.setDataAndParse(e.data,t)}).then(function(e){return u&&l.status!==i.TileStatus.INVALID&&s._tiles.set(a,l),e}).catch(function(e){return l.setObsolete(),o.pool.release(l),s._tiles.has(l.tileKey)&&s._tiles.delete(l.tileKey),n.reject(e)}).catch(function(e){return e}).then(function(e){return u||o.pool.release(l),e})},e.prototype.updateSymbols=function(e){var t=this._tiles.get(e.key);return t?t.updateSymbols(e.rotation):n.reject()},e.prototype.updateStyle=function(e,t){var r=new s(e);return this._layers=r.layers,this._tiles.forEach(function(e,r){e.reparse(t).then(function(r){t.client.invoke("updateTileData",{tileId:e.tileKey,tileData:r.result})})}),n.resolve({data:""})},e.prototype.destructTileData=function(e){return this._tiles.has(e)&&(o.pool.release(this._tiles.get(e)),this._tiles.delete(e)),n.resolve()},e.prototype.fetchSprites=function(e,t){var r=[],i=this._spriteInfo;return e.forEach(function(e){void 0===i[e]&&r.push(e)}),0===r.length?n.resolve():t.invoke("getSprites",r).then(function(e){for(var t in e){var r=e[t];i[t]=r}})},e.prototype.getSpriteItems=function(){return this._spriteInfo},e.prototype.fetchGlyphs=function(e,t,r,i){var o=[],s=this._glyphInfo[t];return s?r.forEach(function(e){s[e]||o.push(e)}):(s=this._glyphInfo[t]=[],r.forEach(function(e){return o.push(e)})),0===o.length?n.resolve():i.invoke("getGlyphs",{tileID:e,font:t,codePoints:o}).then(function(e){for(var t in e)s[t]=e[t]})},e.prototype.getGlyphItems=function(e){return this._glyphInfo[e]},e}()}.apply(null,n))||(e.exports=i)},1532:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(114),r(83),r(4),r(263),r(7),r(1),r(143),r(53),r(567),r(1950),r(2149),r(1826),r(537)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c,f,h,d,p,v,y){Object.defineProperty(t,"__esModule",{value:!0});var m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.controller=null,t.processor=null,t.remoteClient=null,t.serviceAndViewInfo=null,t.tileStore=null,t.viewState=null,t}return r(t,e),t.prototype.initialize=function(){var e=this;this.watch("updating",function(t){e.remoteClient.invoke("setUpdating",t)})},t.prototype.destroy=function(){this.controller&&this.controller.destroy(),this.processor&&this.processor.destroy()},Object.defineProperty(t.prototype,"updating",{get:function(){var e=this.controller,t=this.processor;return!e||!t||e.updating||t.updating||!1},enumerable:!0,configurable:!0}),t.prototype.startup=function(e){var t=new y(c.fromJSON(e.tileInfo));this.serviceAndViewInfo=e,this.tileStore=new v.default(t)},t.prototype.configure=function(e){return a.safeCast(this._configure(e))},t.prototype.setViewState=function(e){var t=h.fromJSON(e);this._set("viewState",t),this.tileStore.setViewState(t),this.controller&&this.controller.setViewState(t)},t.prototype._configure=function(e){return i(this,void 0,void 0,function(){var t,r,n;return o(this,function(i){switch(i.label){case 0:return[4,u.all([a.safeCast(this._handleControllerConfig(e.controller)),a.safeCast(this._handleProcessorConfig(e.processor))])];case 1:return t=i.sent(),r=t[0],n=t[1],(r||n)&&(this.controller.processor=this.processor),[2]}})})},t.prototype._handleControllerConfig=function(e){return i(this,void 0,void 0,function(){return o(this,function(t){return e?[2,this._createController(e)]:[2,null]})})},t.prototype._handleProcessorConfig=function(e){return i(this,void 0,void 0,function(){var t;return o(this,function(r){return e?(t=this._createProcessor(e),[2,"symbol"===e.type&&e.hasGeometryExpr?f.enableGeometryOperations().then(function(){return t}):t]):[2,null]})})},t.prototype._createController=function(e){return i(this,void 0,void 0,function(){var t,r,n,i,s,a;return o(this,function(o){switch(o.label){case 0:return r=(t=this).remoteClient,n=t.tileStore,i=t.serviceAndViewInfo,s={remoteClient:r,tileStore:n,serviceAndViewInfo:i},[4,d.createController(e.type,s)];case 1:return a=o.sent(),this.controller&&this.controller.destroy(),a.configuration=e,a.setViewState(this.viewState),this.controller=a,[2,a]}})})},t.prototype._createProcessor=function(e){return i(this,void 0,void 0,function(){var t,r,n,i,s,a;return o(this,function(o){switch(o.label){case 0:return r=(t=this).remoteClient,n=t.tileStore,i=t.serviceAndViewInfo,s={remoteClient:r,tileStore:n,serviceAndViewInfo:i},[4,p.createProcessor(e.type,s)];case 1:return a=o.sent(),this.processor&&this.processor.destroy(),a.configuration=e,this.processor=a,[2,a]}})})},n([l.property()],t.prototype,"controller",void 0),n([l.property()],t.prototype,"processor",void 0),n([l.property({dependsOn:["controller.updating","processor.updating"]})],t.prototype,"updating",null),n([l.property()],t.prototype,"viewState",void 0),n([l.subclass()],t)}(l.declared(s));t.default=m}.apply(null,n))||(e.exports=i)},1569:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(8)],void 0===(i=function(e,t,r,n){function i(e){return e[0].stride}function o(e){switch(e){case 5126:case 5124:case 5125:return 4;case 5122:case 5123:return 2;case 5120:case 5121:return 1;default:throw new Error("Unknown data type")}}Object.defineProperty(t,"__esModule",{value:!0}),t.vertexCount=function(e,t){return e.vertexBuffers[t].size/i(e.layout[t])},t.getStride=i,t.getBytesPerElement=o,t.addDescriptor=function(e,t,r,n,i,s){var a=o(n);if(e.length>0){var u=e[0].stride,l=u+a*r;e.forEach(function(e){return e.stride=l}),e.push({name:t,count:r,type:n,offset:u,stride:l,normalized:i,divisor:s})}else e.push({name:t,count:r,type:n,offset:0,stride:a*r,normalized:i,divisor:s})},t.assertCompatibleVertexAttributeLocations=function(e,t){var r=e.locations===t.locations;return r||console.error("VertexAttributeLocations are incompatible"),r},t.hasAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return!0;return!1},t.findAttribute=function(e,t){for(var r=0;r<e.length;r++)if(e[r].name===t)return e[r];return null},t.copyFramebufferToTexture=function(e,t,r,n,i){void 0===i&&(i=0);var o=e.getBoundFramebufferObject(),s=e.getBoundTexture(0);e.bindFramebuffer(t),e.bindTexture(r,0),e.gl.copyTexImage2D(e.gl.TEXTURE_2D,i,r.descriptor.pixelFormat,n[0],n[1],n[2],n[3],0),e.gl.flush(),e.bindFramebuffer(o),e.bindTexture(s,0)},t.assert=function(e,t){if(!e)throw new n(t)},t.setBaseInstanceOffset=function(e,t){var n={};for(var i in e)n[i]=e[i].map(function(e){return e.divisor?r({},e,{baseInstance:t}):e});return n},t.bindVertexBufferLayout=function(e,t,r,n,i){var o=e.gl,s=e.capabilities.instancing;e.bindBuffer(r),n.forEach(function(e){var r=t[e.name],n=(i||(0+e.baseInstance?e.baseInstance:0))*e.stride;if(void 0===r&&console.error("There is no location for vertex attribute '"+e.name+"' defined."),e.baseInstance&&!e.divisor&&console.error("Vertex attribute '"+e.name+"' uses baseInstanceOffset without divisor."),e.count<=4)o.vertexAttribPointer(r,e.count,e.type,e.normalized,e.stride,e.offset+n),o.enableVertexAttribArray(r),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(r,e.divisor);else if(9===e.count)for(var a=0;a<3;a++)o.vertexAttribPointer(r+a,3,e.type,e.normalized,e.stride,e.offset+12*a+n),o.enableVertexAttribArray(r+a),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(r+a,e.divisor);else if(16===e.count)for(a=0;a<4;a++)o.vertexAttribPointer(r+a,4,e.type,e.normalized,e.stride,e.offset+16*a+n),o.enableVertexAttribArray(r+a),e.divisor&&e.divisor>0&&s&&s.vertexAttribDivisor(r+a,e.divisor);else console.error("Unsupported vertex attribute element count: "+e.count)})},t.unbindVertexBufferLayout=function(e,t,r,n){var i=e.gl,o=e.capabilities.instancing;e.bindBuffer(r),n.forEach(function(e){var r=t[e.name];if(e.count<=4)i.disableVertexAttribArray(r),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(r,0);else if(9===e.count)for(var n=0;n<3;n++)i.disableVertexAttribArray(r+n),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(r+n,0);else if(16===e.count)for(n=0;n<4;n++)i.disableVertexAttribArray(r+n),e.divisor&&e.divisor>0&&o&&o.vertexAttribDivisor(r+n,0);else console.error("Unsupported vertex attribute element count: "+e.count)}),e.unbindBuffer(34962)}}.apply(null,n))||(e.exports=i)},1583:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.forEach=function(e,t){if(e.forEach)e.forEach(t);else for(var r=0;r<e.length;r++)t(e[r],r,e)},t.slice=function(e,t,r){if(e.slice)return e.slice(t,r);void 0===t?t=0:(t<0&&(t+=e.length),t=Math.min(e.length,Math.max(0,t))),void 0===r?r=e.length:(r<0&&(r+=e.length),r=Math.min(e.length,Math.max(0,r)));for(var n=Math.max(0,r-t),i=new(0,e.constructor)(n),o=0;o<n;o++)i[o]=e[t+o];return i},t.isArrayBuffer=function(e){return e instanceof ArrayBuffer||e&&e.constructor&&"ArrayBuffer"===e.constructor.name},t.isInt8Array=function(e){return e instanceof Int8Array||e&&e.constructor&&"Int8Array"===e.constructor.name},t.isUint8Array=function(e){return e instanceof Uint8Array||e&&e.constructor&&"Uint8Array"===e.constructor.name},t.isInt16Array=function(e){return e instanceof Int16Array||e&&e.constructor&&"Int16Array"===e.constructor.name},t.isUint16Array=function(e){return e instanceof Uint16Array||e&&e.constructor&&"Uint16Array"===e.constructor.name},t.isInt32Array=function(e){return e instanceof Int32Array||e&&e.constructor&&"Int32Array"===e.constructor.name},t.isUint32Array=function(e){return e instanceof Uint32Array||e&&e.constructor&&"Uint32Array"===e.constructor.name},t.isFloat32Array=function(e){return e instanceof Float32Array||e&&e.constructor&&"Float32Array"===e.constructor.name},t.isFloat64Array=function(e){return e instanceof Float64Array||e&&e.constructor&&"Float64Array"===e.constructor.name},t.toArray=function(e){for(var t=new Array(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}}.apply(null,n))||(e.exports=i)},1606:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EXTRUDE_SCALE=64,t.PICTURE_FILL_COLOR=4294967295,t.TILE_SIZE=512,t.ANGLE_FACTOR_256=256/360,t.DEBUG_LABELS=!1,t.COLLISION_BUCKET_SIZE=128,t.COLLISION_MAX_ZOOM_DELTA=3,t.COLLISION_EARLY_REJECT_BUCKET_SIZE=32,t.COLLISION_BOX_PADDING=8,t.COLLISION_TILE_BOX_SIZE=t.TILE_SIZE/t.COLLISION_BUCKET_SIZE,t.COLLISION_PLACEMENT_PADDING=8,t.HEURISTIC_GLYPHS_PER_LINE=50,t.HEURISTIC_GLYPHS_PER_FEATURE=10,t.GLYPH_SIZE=24,t.TEXT_LINE_HEIGHT=1.2*t.GLYPH_SIZE,t.TEXT_MAX_WIDTH=10*t.GLYPH_SIZE,t.TEXT_SPACING=0}.apply(null,n))||(e.exports=i)},1629:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(38),r(1563),r(1751),r(1571)],void 0===(i=function(e,t,r,n,i,o){function s(e,t,n){return{center:r.vec3f64.clone(e),halfSize:r.vec3f32.clone(t),quaternion:r.quatf32.clone(n)}}function a(e,t){var r=o.plane.signedDistance(t,e.center),n=u(e,t);return r>n?1:r<-n?-1:0}function u(e,t){r.quat.conjugate(l,e.quaternion),r.vec3.transformQuat(c,t,l);var n=e.halfSize;return Math.abs(c[0]*n[0])+Math.abs(c[1]*n[1])+Math.abs(c[2]*n[2])}Object.defineProperty(t,"__esModule",{value:!0});var l=r.quatf32.create(),c=r.vec3f32.create(),f=r.vec3f32.create(),h=r.mat3f32.create(),d=function(){return function(e){var t=56*e;this.buffer=new ArrayBuffer(t),this.obbs=new Array(e);for(var n=0;n<e;n++)this.obbs[n]={center:r.vec3f64.createView(this.buffer,56*n+0),halfSize:r.vec3f32.createView(this.buffer,56*n+24),quaternion:r.quatf32.createView(this.buffer,56*n+36)}}}();t.ObbArray=d,t.create=s,t.clone=function(e){return s(e.center,e.halfSize,e.quaternion)},t.set=function(e,t){r.vec3.copy(t.center,e.center),r.vec3.copy(t.halfSize,e.halfSize),r.quat.copy(t.quaternion,e.quaternion)},t.compute=function(e,t){return t||(t=s([0,0,0],[-1,-1,-1],[0,0,0,1])),i.computeOBB(e,t),t},t.intersectPlane=a,t.toAaBoundingBox=function(e,t){t||(t=n.create());var i=r.mat3.fromQuat(h,e.quaternion),o=e.halfSize[0]*Math.abs(i[0])+e.halfSize[1]*Math.abs(i[3])+e.halfSize[2]*Math.abs(i[6]),s=e.halfSize[0]*Math.abs(i[1])+e.halfSize[1]*Math.abs(i[4])+e.halfSize[2]*Math.abs(i[7]),a=e.halfSize[0]*Math.abs(i[2])+e.halfSize[1]*Math.abs(i[5])+e.halfSize[2]*Math.abs(i[8]);return t[0]=e.center[0]-o,t[1]=e.center[1]-s,t[2]=e.center[2]-a,t[3]=e.center[0]+o,t[4]=e.center[1]+s,t[5]=e.center[2]+a,t},t.minimumDistancePlane=function(e,t){return o.plane.signedDistance(t,e.center)-u(e,t)},t.maximumDistancePlane=function(e,t){return o.plane.signedDistance(t,e.center)+u(e,t)},t.isVisible=function(e,t){return a(e,t.planes[0])<=0&&a(e,t.planes[1])<=0&&a(e,t.planes[2])<=0&&a(e,t.planes[3])<=0&&a(e,t.planes[4])<=0&&a(e,t.planes[5])<=0},t.intersectLine=function(e,t,n,i){void 0===i&&(i=0),r.quat.conjugate(l,e.quaternion),r.vec3.subtract(c,t,e.center);for(var o=r.vec3.transformQuat(c,c,l),s=r.vec3.transformQuat(f,n,l),a=-1/0,u=1/0,h=0;h<3;h++)if(Math.abs(s[h])>1e-6){var d=(i+e.halfSize[h]-o[h])/s[h],p=(-i-e.halfSize[h]-o[h])/s[h];a=Math.max(a,Math.min(d,p)),u=Math.min(u,Math.max(d,p))}else if(o[h]>e.halfSize[h]+i||o[h]<-e.halfSize[h]-i)return!1;return a<=u}}.apply(null,n))||(e.exports=i)},1635:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(8),r(5),r(9),r(1742)],void 0===(i=function(e,t,r,n,i,o){function s(e,t,n){for(var i="",o=0;o<n;){var s=e[t+o];if(s<128)i+=String.fromCharCode(s),o++;else if(s>=192&&s<224){if(o+1>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Two byte character was truncated.");var a=(31&s)<<6|63&e[t+o+1];i+=String.fromCharCode(a),o+=2}else if(s>=224&&s<240){if(o+2>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");a=(15&s)<<12|(63&e[t+o+1])<<6|63&e[t+o+2];i+=String.fromCharCode(a),o+=3}else{if(!(s>=240&&s<248))throw new r("utf8-decode-error","UTF-8 Decode failed. Invalid multi byte sequence.");if(o+3>=n)throw new r("utf8-decode-error","UTF-8 Decode failed. Multi byte character was truncated.");if((a=(7&s)<<18|(63&e[t+o+1])<<12|(63&e[t+o+2])<<6|63&e[t+o+3])>=65536){var u=55296+(a-65536>>10),l=56320+(1023&a);i+=String.fromCharCode(u,l)}else i+=String.fromCharCode(a);o+=4}}return i}function a(e,r){for(var n={byteOffset:0,byteCount:0,fields:Object.create(null)},i=0,o=0;o<r.length;o++){var s=r[o],a=s.valueType||s.type,u=t.valueType2ArrayBufferReader[a];n.fields[s.property]=u(e,i),i+=t.valueType2TypedArrayClassMap[a].BYTES_PER_ELEMENT}return n.byteCount=i,n}function u(e,t,n){var i,o,a=[],u=0;for(o=0;o<e;o+=1){if((i=t[o])>0){if(a.push(s(n,u,i-1)),0!==n[u+i-1])throw new r("string-array-error","Invalid string array: missing null termination.")}else a.push(null);u+=i}return a}function l(e,r){return new(0,t.valueType2TypedArrayClassMap[r.valueType])(e,r.byteOffset,r.count*r.valuesPerElement)}function c(e,t){return new Uint8Array(e,t.byteOffset,t.byteCount)}function f(e,t,i){for(var o=null!=t.header?a(e,t.header):{byteOffset:0,byteCount:0,fields:{count:i}},s={header:o,byteOffset:o.byteCount,byteCount:0,entries:Object.create(null)},u=o.byteCount,l=0;l<t.ordering.length;l++){var c=t.ordering[l],f=n.clone(t[c]);if(f.count=o.fields.count,"String"===f.valueType){if(f.byteOffset=u,f.byteCount=o.fields[c+"ByteCount"],"UTF-8"!==f.encoding)throw new r("unsupported-encoding","Unsupported String encoding.",{encoding:f.encoding})}else{if(!d(f.valueType))throw new r("unsupported-value-type","Unsupported binary valueType",{valueType:f.valueType});var h=p(f.valueType);u+=u%h!=0?h-u%h:0,f.byteOffset=u,f.byteCount=h*f.valuesPerElement*f.count}u+=f.byteCount,s.entries[c]=f}return s.byteCount=u-s.byteOffset,s}function h(e,t,n){if(t!==e&&v.error("Invalid "+n+" buffer size\n expected: "+e+", actual: "+t+")"),t<e)throw new r("buffer-too-small","Binary buffer is too small",{expectedSize:e,actualSize:t})}function d(e){return t.valueType2TypedArrayClassMap.hasOwnProperty(e)}function p(e){return d(e)&&t.valueType2TypedArrayClassMap[e].BYTES_PER_ELEMENT}Object.defineProperty(t,"__esModule",{value:!0});var v=i.getLogger("esri.views.3d.layers.i3s.I3SBinaryReader");t.readHeader=a,t.readStringArray=u,t.createTypedView=l,t.createRawView=c,t.createAttributeDataIndex=f,t.createGeometryDataIndex=function(e,t,r){var i=a(e,t&&t.header),o=i.byteCount,s={header:i,byteOffset:i.byteCount,byteCount:0,vertexAttributes:n.clone(t.vertexAttributes)},u=s.vertexAttributes;r||null==u.region||delete u.region;for(var l=i.fields,c=null!=l.vertexCount?l.vertexCount:l.count,f=0;f<t.ordering.length;f++){var d=t.ordering[f];null!=u[d]&&(u[d].byteOffset=o,u[d].count=c,o+=p(u[d].valueType)*u[d].valuesPerElement*c)}var v=l.faceCount;if(t.faces&&v){s.faces=n.clone(t.faces);var y=s.faces;for(f=0;f<t.ordering.length;f++){var m=t.ordering[f];null!=y[m]&&(y[m].byteOffset=o,y[m].count=v,o+=p(y[m].valueType)*y[m].valuesPerElement*v)}}var g=l.featureCount;if(t.featureAttributes&&t.featureAttributeOrder&&g){s.featureAttributes=n.clone(t.featureAttributes);var x=s.featureAttributes;for(f=0;f<t.featureAttributeOrder.length;f++){var b=t.featureAttributeOrder[f];x[b].byteOffset=o,x[b].count=g;var _=p(x[b].valueType);"UInt64"===x[b].valueType&&(_=8),o+=_*x[b].valuesPerElement*g}}return h(o,e.byteLength,"geometry"),s.byteCount=o-s.byteOffset,s},t.readBinaryAttribute=function(e,t,n){if("lepcc-rgb"===e.encoding)return o.decodeRGB(t);if("lepcc-intensity"===e.encoding)return o.decodeIntensity(t);if(null!=e.encoding&&""!==e.encoding)throw new r("unknown-attribute-storage-info-encoding","Unknown Attribute Storage Info Encoding");e["attributeByteCounts "]&&!e.attributeByteCounts&&(v.warn("Warning: Trailing space in 'attributeByteCounts '."),e.attributeByteCounts=e["attributeByteCounts "]),"ObjectIds"===e.ordering[0]&&e.hasOwnProperty("objectIds")&&(v.warn("Warning: Case error in objectIds"),e.ordering[0]="objectIds");var i=f(t,e,n);h(i.byteOffset+i.byteCount,t.byteLength,"attribute");var s=i.entries.attributeValues||i.entries.objectIds;if(s){if("String"===s.valueType){var a=i.entries.attributeByteCounts,d=l(t,a),p=c(t,s);return u(a.count,d,p)}return l(t,s)}throw new r("bad-attribute-storage-info","Bad attributeStorageInfo specification.")},t.valueType2TypedArrayClassMap={Float32:Float32Array,Float64:Float64Array,UInt8:Uint8Array,Int8:Int8Array,UInt16:Uint16Array,Int16:Int16Array,UInt32:Uint32Array,Int32:Int32Array},t.valueType2ArrayBufferReader={Float32:function(e,t){return new DataView(e,0).getFloat32(t,!0)},Float64:function(e,t){return new DataView(e,0).getFloat64(t,!0)},UInt8:function(e,t){return new DataView(e,0).getUint8(t)},Int8:function(e,t){return new DataView(e,0).getInt8(t)},UInt16:function(e,t){return new DataView(e,0).getUint16(t,!0)},Int16:function(e,t){return new DataView(e,0).getInt16(t,!0)},UInt32:function(e,t){return new DataView(e,0).getUint32(t,!0)},Int32:function(e,t){return new DataView(e,0).getInt32(t,!0)}},t.isValueType=d,t.getBytesPerValue=p}.apply(null,n))||(e.exports=i)},1726:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e,t,r,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===r&&(r=0),void 0===n&&(n=0),this.x=e,this.y=t,this.width=r,this.height=n}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return this.width<=0||this.height<=0},enumerable:!0,configurable:!0}),e}()}.apply(null,n))||(e.exports=i)},1729:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){this.x=e,this.y=t}return e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.equals=function(e,t){return e===this.x&&t===this.y},e.prototype.isEqual=function(e){return e.x===this.x&&e.y===this.y},e.prototype.setCoords=function(e,t){this.x=e,this.y=t},e.prototype.normalize=function(){var e=this.x,t=this.y,r=Math.sqrt(e*e+t*t);this.x/=r,this.y/=r},e.prototype.rightPerpendicular=function(){var e=this.x;this.x=this.y,this.y=-e},e.prototype.move=function(e,t){this.x+=e,this.y+=t},e.prototype.assign=function(e){this.x=e.x,this.y=e.y},e.prototype.assignAdd=function(e,t){this.x=e.x+t.x,this.y=e.y+t.y},e.prototype.assignSub=function(e,t){this.x=e.x-t.x,this.y=e.y-t.y},e.prototype.rotate=function(e,t){var r=this.x,n=this.y;this.x=r*e-n*t,this.y=r*t+n*e},e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},e.distance=function(e,t){var r=t.x-e.x,n=t.y-e.y;return Math.sqrt(r*r+n*n)},e.add=function(t,r){return new e(t.x+r.x,t.y+r.y)},e.sub=function(t,r){return new e(t.x-r.x,t.y-r.y)},e}();t.Point=r}.apply(null,n))||(e.exports=i)},1733:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.C_INFINITY=Number.POSITIVE_INFINITY,t.C_PI=Math.PI,t.C_2PI=2*t.C_PI,t.C_PI_BY_2=t.C_PI/2,t.C_RAD_TO_256=128/t.C_PI,t.C_256_TO_RAD=t.C_PI/128,t.C_DEG_TO_256=256/360,t.C_DEG_TO_RAD=t.C_PI/180,t.C_SQRT2=1.414213562,t.C_SQRT2_INV=1/t.C_SQRT2;var r=1/Math.LN2;function n(e,t){return 0<=(e%=t)?e:e+t}t.positiveMod=n,t.radToByte=function(e){return n(e*t.C_RAD_TO_256,256)},t.degToByte=function(e){return n(e*t.C_DEG_TO_256,256)},t.log2=function(e){return Math.log(e)*r},t.sqr=function(e){return e*e},t.clamp=function(e,t,r){return Math.min(Math.max(e,t),r)},t.interpolate=function(e,t,r){return e*(1-r)+t*r},t.between=function(e,t,r){return t<=e&&e<=r||r<=e&&e<=t}}.apply(null,n))||(e.exports=i)},1742:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(8)],void 0===(i=function(e,t,r){function n(e,t,r){return{identifier:String.fromCharCode.apply(null,new Uint8Array(e,r+c.identifierOffset,c.identifierLength)),version:t.getUint16(r+c.versionOffset,l),checksum:t.getUint32(r+c.checksumOffset,l)}}function i(e,t){return{sizeLo:e.getUint32(t+f.sizeLo,l),sizeHi:e.getUint32(t+f.sizeHi,l),minX:e.getFloat64(t+f.minX,l),minY:e.getFloat64(t+f.minY,l),minZ:e.getFloat64(t+f.minZ,l),maxX:e.getFloat64(t+f.maxX,l),maxY:e.getFloat64(t+f.maxY,l),maxZ:e.getFloat64(t+f.maxZ,l),errorX:e.getFloat64(t+f.errorX,l),errorY:e.getFloat64(t+f.errorY,l),errorZ:e.getFloat64(t+f.errorZ,l),count:e.getUint32(t+f.count,l),reserved:e.getUint32(t+f.reserved,l)}}function o(e,t,r){var n=[];t=s(e,t,n);for(var i=[],o=0;o<n.length;o++){i.length=0,t=s(e,t,i);for(var a=0;a<i.length;a++)r.push(i[a]+n[o])}return t}function s(e,t,n){var i=new DataView(e,t),o=i.getUint8(0),s=31&o,a=!!(32&o),u=(192&o)>>6,c=0;if(0===u)c=i.getUint32(1,l),t+=5;else if(1===u)c=i.getUint16(1,l),t+=3;else{if(2!==u)throw new r("lepcc-decode-error","Bad count type");c=i.getUint8(1),t+=2}if(a)throw new r("lepcc-decode-error","LUT not implemented");for(var f=Math.ceil(c*s/8),h=new Uint8Array(e,t,f),d=0,p=0,v=0,y=-1>>>32-s,m=0;m<c;m++){for(;p<s;)d|=h[v]<<p,p+=8,v+=1;n[m]=d&y,d>>>=s,(p-=s)+s>32&&(d|=h[v-1]>>8-p)}return t+v}function a(e,t){return{sizeLo:e.getUint32(t+h.sizeLo,l),sizeHi:e.getUint32(t+h.sizeHi,l),count:e.getUint32(t+h.count,l),colorMapCount:e.getUint16(t+h.colorMapCount,l),lookupMethod:e.getUint8(t+h.lookupMethod),compressionMethod:e.getUint8(t+h.compressionMethod)}}function u(e,t){return{sizeLo:e.getUint32(t+d.sizeLo,l),sizeHi:e.getUint32(t+d.sizeHi,l),count:e.getUint32(t+d.count,l),scaleFactor:e.getUint16(t+d.scaleFactor,l),bitsPerPoint:e.getUint8(t+d.bitsPerPoint),reserved:e.getUint8(t+d.reserved)}}Object.defineProperty(t,"__esModule",{value:!0});var l=!0,c={identifierOffset:0,identifierLength:10,versionOffset:10,checksumOffset:12,byteCount:16},f={sizeLo:0,sizeHi:4,minX:8,minY:16,minZ:24,maxX:32,maxY:40,maxZ:48,errorX:56,errorY:64,errorZ:72,count:80,reserved:84,byteCount:88};t.decodeXYZ=function(e){var t=new DataView(e,0),s=0,a=n(e,t,s),u=a.identifier,l=a.version;if(s+=c.byteCount,"LEPCC     "!==u)throw new r("lepcc-decode-error","Bad identifier");if(l>1)throw new r("lepcc-decode-error","Unknown version");var h=i(t,s);if(s+=f.byteCount,h.sizeHi*Math.pow(2,32)+h.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var d=new Float64Array(3*h.count),p=[],v=[],y=[],m=[];if((s=o(e,s=o(e,s=o(e,s=o(e,s,p),v),y),m))!==e.byteLength)throw new r("lepcc-decode-error","Bad length");for(var g=0,x=0,b=0;b<p.length;b++){x+=p[b];for(var _=0,I=0;I<v[b];I++){_+=y[g];var C=m[g];d[3*g]=Math.min(h.maxX,h.minX+2*h.errorX*_),d[3*g+1]=Math.min(h.maxY,h.minY+2*h.errorY*x),d[3*g+2]=Math.min(h.maxZ,h.minZ+2*h.errorZ*C),g++}}return{errorX:h.errorX,errorY:h.errorY,errorZ:h.errorZ,result:d}};var h={sizeLo:0,sizeHi:4,count:8,colorMapCount:12,lookupMethod:14,compressionMethod:15,byteCount:16};t.decodeRGB=function(e){var t=new DataView(e,0),i=0,o=n(e,t,i),s=o.identifier,u=o.version;if(i+=c.byteCount,"ClusterRGB"!==s)throw new r("lepcc-decode-error","Bad identifier");if(u>1)throw new r("lepcc-decode-error","Unknown version");var l=a(t,i);if(i+=h.byteCount,l.sizeHi*Math.pow(2,32)+l.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");if(2!==l.lookupMethod&&1!==l.lookupMethod||0!==l.compressionMethod){if(0===l.lookupMethod&&0===l.compressionMethod){if(3*l.count+i!==e.byteLength||0!==l.colorMapCount)throw new r("lepcc-decode-error","Bad count");return new Uint8Array(e,i).slice()}if(l.lookupMethod<=2&&1===l.compressionMethod){if(i+3!==e.byteLength||1!==l.colorMapCount)throw new r("lepcc-decode-error","Bad count");for(var f=t.getUint8(i),d=t.getUint8(i+1),p=t.getUint8(i+2),v=new Uint8Array(3*l.count),y=0;y<l.count;y++)v[3*y]=f,v[3*y+1]=d,v[3*y+2]=p;return v}throw new r("lepcc-decode-error","Bad method "+l.lookupMethod+","+l.compressionMethod)}if(3*l.colorMapCount+l.count+i!==e.byteLength||l.colorMapCount>256)throw new r("lepcc-decode-error","Bad count");var m=new Uint8Array(e,i,3*l.colorMapCount),g=new Uint8Array(e,i+3*l.colorMapCount,l.count);for(v=new Uint8Array(3*l.count),y=0;y<l.count;y++){var x=g[y];v[3*y]=m[3*x],v[3*y+1]=m[3*x+1],v[3*y+2]=m[3*x+2]}return v};var d={sizeLo:0,sizeHi:4,count:8,scaleFactor:12,bitsPerPoint:14,reserved:15,byteCount:16};t.decodeIntensity=function(e){var t=new DataView(e,0),i=0,o=n(e,t,i),a=o.identifier,l=o.version;if(i+=c.byteCount,"Intensity "!==a)throw new r("lepcc-decode-error","Bad identifier");if(l>1)throw new r("lepcc-decode-error","Unknown version");var f=u(t,i);if(i+=d.byteCount,f.sizeHi*Math.pow(2,32)+f.sizeLo!==e.byteLength)throw new r("lepcc-decode-error","Bad size");var h=new Uint16Array(f.count);if(8===f.bitsPerPoint){if(f.count+i!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(var p=new Uint8Array(e,i,f.count),v=0;v<f.count;v++)h[v]=p[v]*f.scaleFactor}else if(16===f.bitsPerPoint){if(2*f.count+i!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(p=new Uint16Array(e,i,f.count),v=0;v<f.count;v++)h[v]=p[v]*f.scaleFactor}else{if(s(e,i,p=[])!==e.byteLength)throw new r("lepcc-decode-error","Bad size");for(v=0;v<f.count;v++)h[v]=p[v]*f.scaleFactor}return h}}.apply(null,n))||(e.exports=i)},1745:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(514),r(122),r(72),r(524),r(138)],void 0===(i=function(e,t,r,n,i,o,s){function a(e,t){var r=e.bounds,n=t.bounds;return e.key.id!==t.key.id&&e.key.world===t.key.world&&r[0]<=n[0]&&r[1]<=n[1]&&r[2]>=n[2]&&r[3]>=n[3]}Object.defineProperty(t,"__esModule",{value:!0}),t.isParentOf=a,t.isChildOf=function(e,t){return a(t,e)};var u=function(){function e(e,t){this.bounds=i.create(),this.key=new s(0,0,0,0),this.objectIds=new r.default,this.key.set(t);var n=e.getLODInfoAt(this.key);this.tileInfoView=e,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=n.resolution,this.scale=n.scale,this.level=n.level,this.needsClear=!0}return Object.defineProperty(e.prototype,"id",{get:function(){return this.key.id},enumerable:!0,configurable:!0}),e.prototype.clone=function(){return new e(this.tileInfoView,this.id)},e.prototype.createChildTiles=function(){for(var t=this.key.getChildKeys(),r=n.acquire(),i=0;i<t.length;i++)r[i]=new e(this.tileInfoView,t[i]);return r},e.prototype.getQuantizationParameters=function(){return o.default.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})},e}();t.Tile=u,t.default=u}.apply(null,n))||(e.exports=i)},1746:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1755)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.parse=function(e){return r.parse(e)},e}();t.WhereGrammar=n}.apply(null,n))||(e.exports=i)},1748:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1606),r(1729),r(1733)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t,r){this.ratio=e,this.x=t,this.y=r},s=function(){function e(e,t,n,i,o){void 0===i&&(i=8),void 0===o&&(o=8),this.lines=[],this.starts=[],this.pixelRatio=i,this.pixelMargin=o,this.tileSize=r.TILE_SIZE*i,this.dz=e,this.yPos=t,this.xPos=n}return e.prototype.setExtent=function(e){this.finalRatio=this.tileSize/e*(1<<this.dz);var t=this.pixelRatio*this.pixelMargin;t/=this.finalRatio;var r=e>>this.dz;r<t&&(t=r),this.margin=t,this.xmin=r*this.xPos-t,this.ymin=r*this.yPos-t,this.xmax=this.xmin+r+2*t,this.ymax=this.ymin+r+2*t},e.prototype.reset=function(e){this.type=e,this.lines=[],this.starts=[],this.line=null,this.start=0},e.prototype.moveTo=function(e,t){this._pushLine(),this._prevIsIn=this._isIn(e,t),this._moveTo(e,t,this._prevIsIn),this._prevPt=new n.Point(e,t),this._firstPt=new n.Point(e,t),this._dist=0},e.prototype.lineTo=function(e,t){var r,i,s,a,u,l,c,f,h=this._isIn(e,t),d=new n.Point(e,t),p=n.Point.distance(this._prevPt,d);if(h)this._prevIsIn?this._lineTo(e,t,!0):(r=this._prevPt,i=d,s=this._intersect(i,r),this.start=this._dist+p*(1-this._r),this._lineTo(s.x,s.y,!0),this._lineTo(i.x,i.y,!0));else if(this._prevIsIn)i=this._prevPt,r=d,s=this._intersect(i,r),this._lineTo(s.x,s.y,!0),this._lineTo(r.x,r.y,!1);else{var v=this._prevPt,y=d;if(v.x<=this.xmin&&y.x<=this.xmin||v.x>=this.xmax&&y.x>=this.xmax||v.y<=this.ymin&&y.y<=this.ymin||v.y>=this.ymax&&y.y>=this.ymax)this._lineTo(y.x,y.y,!1);else{var m=[];if((v.x<this.xmin&&y.x>this.xmin||v.x>this.xmin&&y.x<this.xmin)&&(a=(this.xmin-v.x)/(y.x-v.x),(f=v.y+a*(y.y-v.y))<=this.ymin?l=!1:f>=this.ymax?l=!0:m.push(new o(a,this.xmin,f))),(v.x<this.xmax&&y.x>this.xmax||v.x>this.xmax&&y.x<this.xmax)&&(a=(this.xmax-v.x)/(y.x-v.x),(f=v.y+a*(y.y-v.y))<=this.ymin?l=!1:f>=this.ymax?l=!0:m.push(new o(a,this.xmax,f))),(v.y<this.ymin&&y.y>this.ymin||v.y>this.ymin&&y.y<this.ymin)&&(a=(this.ymin-v.y)/(y.y-v.y),(c=v.x+a*(y.x-v.x))<=this.xmin?u=!1:c>=this.xmax?u=!0:m.push(new o(a,c,this.ymin))),(v.y<this.ymax&&y.y>this.ymax||v.y>this.ymax&&y.y<this.ymax)&&(a=(this.ymax-v.y)/(y.y-v.y),(c=v.x+a*(y.x-v.x))<=this.xmin?u=!1:c>=this.xmax?u=!0:m.push(new o(a,c,this.ymax))),0===m.length)u?l?this._lineTo(this.xmax,this.ymax,!0):this._lineTo(this.xmax,this.ymin,!0):l?this._lineTo(this.xmin,this.ymax,!0):this._lineTo(this.xmin,this.ymin,!0);else if(1<m.length&&m[0].ratio>m[1].ratio)this.start=this._dist+p*m[1].ratio,this._lineTo(m[1].x,m[1].y,!0),this._lineTo(m[0].x,m[0].y,!0);else{this.start=this._dist+p*m[0].ratio;for(var g=0;g<m.length;g++)this._lineTo(m[g].x,m[g].y,!0)}this._lineTo(y.x,y.y,!1)}}this._dist+=p,this._prevIsIn=h,this._prevPt=d},e.prototype.close=function(){if(2<this.line.length){var e=this._firstPt,t=this._prevPt;e.x===t.x&&e.y===t.y||this.lineTo(e.x,e.y);for(var r=this.line,n=r.length;4<=n&&(r[0].x===r[1].x&&r[0].x===r[n-2].x||r[0].y===r[1].y&&r[0].y===r[n-2].y);)r.pop(),r[0].x=r[n-2].x,r[0].y=r[n-2].y,--n}},e.prototype.result=function(e){return void 0===e&&(e=!0),this._pushLine(),0===this.lines.length?null:(3===this.type&&e&&u.simplify(this.tileSize,this.margin*this.finalRatio,this.lines),this.lines)},e.prototype.resultWithStarts=function(){if(2!==this.type)throw new Error("Only valid for lines");this._pushLine();var e=this.lines,t=e.length;if(0===t)return null;for(var r=[],n=0;n<t;n++)r.push({line:e[n],start:this.starts[n]||0});return r},e.prototype._isIn=function(e,t){return e>=this.xmin&&e<=this.xmax&&t>=this.ymin&&t<=this.ymax},e.prototype._intersect=function(e,t){var r,i,o;if(t.x>=this.xmin&&t.x<=this.xmax)o=((i=t.y<=this.ymin?this.ymin:this.ymax)-e.y)/(t.y-e.y),r=e.x+o*(t.x-e.x);else if(t.y>=this.ymin&&t.y<=this.ymax)o=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),i=e.y+o*(t.y-e.y);else{i=t.y<=this.ymin?this.ymin:this.ymax;var s=((r=t.x<=this.xmin?this.xmin:this.xmax)-e.x)/(t.x-e.x),a=(i-e.y)/(t.y-e.y);s<a?(o=s,i=e.y+s*(t.y-e.y)):(o=a,r=e.x+a*(t.x-e.x))}return this._r=o,new n.Point(r,i)},e.prototype._pushLine=function(){this.line&&(1===this.type?0<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):2===this.type?1<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start)):3===this.type&&3<this.line.length&&(this.lines.push(this.line),this.starts.push(this.start))),this.line=[],this.start=0},e.prototype._moveTo=function(e,t,r){3!==this.type?r&&(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n.Point(e,t))):(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line.push(new n.Point(e,t)),this._is_h=!1,this._is_v=!1)},e.prototype._lineTo=function(e,t,r){var i,o;if(3!==this.type)if(r){if(e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),0<this.line.length&&(i=this.line[this.line.length-1]).equals(e,t))return;this.line.push(new n.Point(e,t))}else this.line&&0<this.line.length&&this._pushLine();else if(r||(e<this.xmin&&(e=this.xmin),e>this.xmax&&(e=this.xmax),t<this.ymin&&(t=this.ymin),t>this.ymax&&(t=this.ymax)),e=Math.round((e-(this.xmin+this.margin))*this.finalRatio),t=Math.round((t-(this.ymin+this.margin))*this.finalRatio),this.line&&0<this.line.length){var s=(i=this.line[this.line.length-1]).x===e,a=i.y===t;if(s&&a)return;this._is_h&&s?(i.x=e,i.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):this._is_v&&a?(i.x=e,i.y=t,(o=this.line[this.line.length-2]).x===e&&o.y===t?(this.line.pop(),this.line.length<=1?(this._is_h=!1,this._is_v=!1):(o=this.line[this.line.length-2],this._is_h=o.x===e,this._is_v=o.y===t)):(this._is_h=o.x===e,this._is_v=o.y===t)):(this.line.push(new n.Point(e,t)),this._is_h=s,this._is_v=a)}else this.line.push(new n.Point(e,t))},e}();t.TileClipper=s;var a=function(){function e(){}return e.prototype.setExtent=function(e){this._ratio=4096===e?1:4096/e},e.prototype.reset=function(e){this.type=e,this.lines=[],this.line=null},e.prototype.moveTo=function(e,t){this.line&&this.lines.push(this.line),this.line=[];var r=this._ratio;this.line.push(new n.Point(Math.round(e*r),Math.round(t*r)))},e.prototype.lineTo=function(e,t){var r=this._ratio;this.line.push(new n.Point(Math.round(e*r),Math.round(t*r)))},e.prototype.close=function(){var e=this.line;e&&!e[0].isEqual(e[e.length-1])&&e.push(e[0])},e.prototype.result=function(){return this.line&&this.lines.push(this.line),0===this.lines.length?null:(3===this.type&&1!==this._ratio&&u.simplify(4096,64,this.lines),this.lines)},e}();t.SimpleBuilder=a;var u=function(){function e(){}return e.simplify=function(t,r,n){if(n){for(var i=-r,o=t+r,s=-r,a=t+r,u=[],l=[],c=n.length,f=0;f<c;++f){var h=n[f];if(h&&!(h.length<2))for(var d=h[0],p=void 0,v=h.length,y=1;y<v;++y)p=h[y],d.x===p.x&&(d.x<=i&&(d.y>p.y?(u.push(f),u.push(y),u.push(0),u.push(-1)):(l.push(f),l.push(y),l.push(0),l.push(-1))),d.x>=o&&(d.y<p.y?(u.push(f),u.push(y),u.push(1),u.push(-1)):(l.push(f),l.push(y),l.push(1),l.push(-1)))),d.y===p.y&&(d.y<=s&&(d.x<p.x?(u.push(f),u.push(y),u.push(2),u.push(-1)):(l.push(f),l.push(y),l.push(2),l.push(-1))),d.y>=a&&(d.x>p.x?(u.push(f),u.push(y),u.push(3),u.push(-1)):(l.push(f),l.push(y),l.push(3),l.push(-1)))),d=p}if(0!==u.length&&0!==l.length){e.fillParent(n,l,u),e.fillParent(n,u,l);var m=[];e.calcDeltas(m,l,u),e.calcDeltas(m,u,l),e.addDeltas(m,n)}}},e.fillParent=function(e,t,r){for(var n=r.length,o=t.length,s=0;s<o;s+=4){for(var a=t[s],u=t[s+1],l=t[s+2],c=e[a][u-1],f=e[a][u],h=8092,d=-1,p=0;p<n;p+=4)if(r[p+2]===l){var v=r[p],y=r[p+1],m=e[v][y-1],g=e[v][y];switch(l){case 0:case 1:i.between(c.y,m.y,g.y)&&i.between(f.y,m.y,g.y)&&(x=Math.abs(g.y-m.y))<h&&(h=x,d=p);break;case 2:case 3:var x;i.between(c.x,m.x,g.x)&&i.between(f.x,m.x,g.x)&&(x=Math.abs(g.x-m.x))<h&&(h=x,d=p)}}t[s+3]=d}},e.calcDeltas=function(t,r,n){for(var i=r.length,o=0;o<i;o+=4){var s=e.calcDelta(o,r,n,[]);t.push(r[o]),t.push(r[o+1]),t.push(r[o+2]),t.push(s)}},e.calcDelta=function(t,r,n,i){var o=r[t+3];if(-1===o)return 0;var s=i.length;return 1<s&&i[s-2]===o?0:(i.push(o),e.calcDelta(o,n,r,i)+1)},e.addDeltas=function(e,t){for(var r=e.length,n=0,i=0;i<r;i+=4)n<(a=e[i+3])&&(n=a);for(i=0;i<r;i+=4){var o=t[e[i]],s=e[i+1],a=n-e[i+3];switch(e[i+2]){case 0:o[s-1].x-=a,o[s].x-=a,1===s&&(o[o.length-1].x-=a),s===o.length-1&&(o[0].x-=a);break;case 1:o[s-1].x+=a,o[s].x+=a,1===s&&(o[o.length-1].x+=a),s===o.length-1&&(o[0].x+=a);break;case 2:o[s-1].y-=a,o[s].y-=a,1===s&&(o[o.length-1].y-=a),s===o.length-1&&(o[0].y-=a);break;case 3:o[s-1].y+=a,o[s].y+=a,1===s&&(o[o.length-1].y+=a),s===o.length-1&&(o[0].y+=a)}}},e}(),l=function(){function e(){this.linesIn=[],this.linesOut=[]}return e.prototype.cut=function(e,t){var r;if(this.xCut=t,e.rings)this.closed=!0,r=e.rings,this.minPts=4;else{if(!e.paths)return null;this.closed=!1,r=e.paths,this.minPts=2}for(var n=0,i=r;n<i.length;n++)if((p=i[n])&&!(p.length<this.minPts)){for(var o=!0,s=0,a=p;s<a.length;s++){var u=a[s];o?(this.moveTo(u),o=!1):this.lineTo(u)}this.closed&&this.close()}this._pushLineIn(),this._pushLineOut(),r=[];for(var l=0,c=this.linesIn;l<c.length;l++)(p=c[l])&&p.length>=this.minPts&&r.push(p);for(var f=-2*this.xCut,h=0,d=this.linesOut;h<d.length;h++){var p;if((p=d[h])&&p.length>=this.minPts){for(var v=0,y=p;v<y.length;v++)(u=y[v])[0]+=f;r.push(p)}}return this.closed?e.rings=r:e.paths=r,e},e.prototype.moveTo=function(e){this._pushLineIn(),this._pushLineOut(),this._prevSide=this._side(e[0]),this._moveTo(e[0],e[1],this._prevSide),this._prevPt=e,this._firstPt=e},e.prototype.lineTo=function(e){var t=this._side(e[0]);if(t*this._prevSide==-1){var r=this._intersect(this._prevPt,e);this._lineTo(this.xCut,r,0),this._prevSide=0,this._lineTo(e[0],e[1],t)}else this._lineTo(e[0],e[1],t);this._prevSide=t,this._prevPt=e},e.prototype.close=function(){var e=this._firstPt,t=this._prevPt;e[0]===t[0]&&e[1]===t[1]||this.lineTo(e),this._checkClosingPt(this.lineIn),this._checkClosingPt(this.lineOut)},e.prototype._moveTo=function(e,t,r){this.closed?(this.lineIn.push([r<=0?e:this.xCut,t]),this.lineOut.push([0<=r?e:this.xCut,t])):(r<=0&&this.lineIn.push([e,t]),0<=r&&this.lineOut.push([e,t]))},e.prototype._lineTo=function(e,t,r){this.closed?(this._addPolyVertex(this.lineIn,r<=0?e:this.xCut,t),this._addPolyVertex(this.lineOut,0<=r?e:this.xCut,t)):r<0?(0===this._prevSide&&this._pushLineOut(),this.lineIn.push([e,t])):0<r?(0===this._prevSide&&this._pushLineIn(),this.lineOut.push([e,t])):this._prevSide<0?(this.lineIn.push([e,t]),this.lineOut.push([e,t])):0<this._prevSide&&(this.lineOut.push([e,t]),this.lineIn.push([e,t]))},e.prototype._addPolyVertex=function(e,t,r){var n=e.length;1<n&&e[n-1][0]===t&&e[n-2][0]===t?e[n-1][1]=r:e.push([t,r])},e.prototype._checkClosingPt=function(e){var t=e.length;3<t&&e[0][0]===this.xCut&&e[t-2][0]===this.xCut&&e[1][0]===this.xCut&&(e[0][1]=e[t-2][1],e.pop())},e.prototype._side=function(e){return e<this.xCut?-1:e>this.xCut?1:0},e.prototype._intersect=function(e,t){var r=(this.xCut-e[0])/(t[0]-e[0]);return e[1]+r*(t[1]-e[1])},e.prototype._pushLineIn=function(){this.lineIn&&this.lineIn.length>=this.minPts&&this.linesIn.push(this.lineIn),this.lineIn=[]},e.prototype._pushLineOut=function(){this.lineOut&&this.lineOut.length>=this.minPts&&this.linesOut.push(this.lineOut),this.lineOut=[]},e}();t.CutVertical=l}.apply(null,n))||(e.exports=i)},1750:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){this._listeners={}}return e.prototype.on=function(e,t){var r=this;null==this._listeners[e]&&(this._listeners[e]=new Map);var n={};return this._listeners[e].set(n,t),{remove:function(){return r._listeners[e].delete(n)}}},e.prototype.once=function(e,t){var r=this.on(e,function(e){r.remove(),t(e)});return r},e.prototype.emit=function(e,t){this.hasEventListener(e)&&this._listeners[e].forEach(function(e){return e(t)})},e.prototype.hasEventListener=function(e){return null!=this._listeners[e]&&this._listeners[e].size>0},e}();t.default=r}.apply(null,n))||(e.exports=i)},1751:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(38)],void 0===(i=function(e,t,r){function n(e,t,n,i,o,a,u,l,c,f,h){return function(e,t,n){for(var i=r.vec3.squaredDistance(e.maxVert[0],e.minVert[0]),o=0,s=1;s<7;++s){var a=r.vec3.squaredDistance(e.maxVert[s],e.minVert[s]);a>i&&(i=a,o=s)}r.vec3.copy(t,e.minVert[o]),r.vec3.copy(n,e.maxVert[o])}(e,i,o),r.vec3.squaredDistance(i,o)<d?1:(r.vec3.subtract(u,i,o),r.vec3.normalize(u,u),function(e,t,n,i){for(var o=e.data,s=e.offsetIdx,a=e.strideIdx,u=Number.NEGATIVE_INFINITY,l=0,c=s;c<o.length;c+=a){r.vec3.set(w,o[c]-t[0],o[c+1]-t[1],o[c+2]-t[2]);var f=n[0]*w[0]+n[1]*w[1]+n[2]*w[2],h=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],d=w[0]*w[0]+w[1]*w[1]+w[2]*w[2],p=d-f*f/h;p>u&&(u=p,l=c)}return r.vec3.set(i,o[l],o[l+1],o[l+2]),u}(t,i,u,a)<d?2:(r.vec3.subtract(l,o,a),r.vec3.normalize(l,l),r.vec3.subtract(c,a,i),r.vec3.normalize(c,c),r.vec3.cross(n,l,u),r.vec3.normalize(n,n),s(t,n,u,l,c,f),0))}function i(e,t,n,i,a,u,l,c,f,h){o(e,t,n,i,a,y,m),void 0!==y[0]&&(r.vec3.subtract(g,y,n),r.vec3.normalize(g,g),r.vec3.subtract(x,y,i),r.vec3.normalize(x,x),r.vec3.subtract(b,y,a),r.vec3.normalize(b,b),r.vec3.cross(_,x,u),r.vec3.normalize(_,_),r.vec3.cross(I,b,l),r.vec3.normalize(I,I),r.vec3.cross(C,g,c),r.vec3.normalize(C,C),s(e,_,u,x,g,f),s(e,I,l,b,x,f),s(e,C,c,g,b,f)),void 0!==m[0]&&(r.vec3.subtract(g,m,n),r.vec3.normalize(g,g),r.vec3.subtract(x,m,i),r.vec3.normalize(x,x),r.vec3.subtract(b,m,a),r.vec3.normalize(b,b),r.vec3.cross(_,x,u),r.vec3.normalize(_,_),r.vec3.cross(I,b,l),r.vec3.normalize(I,I),r.vec3.cross(C,g,c),r.vec3.normalize(C,C),s(e,_,u,x,g,f),s(e,I,l,b,x,f),s(e,C,c,g,b,f))}function o(e,t,n,i,o,s,a){!function(e,t,n,i,o){var s=e.data,a=e.offsetIdx,u=e.strideIdx;r.vec3.set(i,s[a],s[a+1],s[a+2]),r.vec3.copy(o,i),n[0]=r.vec3.dot(D,t),n[1]=n[0];for(var l=a+u;l<s.length;l+=u){var c=s[l]*t[0]+s[l+1]*t[1]+s[l+2]*t[2];c<n[0]&&(n[0]=c,r.vec3.set(i,s[l],s[l+1],s[l+2])),c>n[1]&&(n[1]=c,r.vec3.set(o,s[l],s[l+1],s[l+2]))}}(e,t,T,a,s);var u=r.vec3.dot(n,t);T[1]-d<=u&&(s[0]=void 0),T[0]+d>=u&&(a[0]=void 0)}function s(e,t,n,i,o,s){if(!(r.vec3.squaredLength(t)<d)){r.vec3.cross(P,n,t),r.vec3.cross(S,i,t),r.vec3.cross(A,o,t),a(e,t,T),E[1]=T[0],M[1]=T[1],B[1]=M[1]-E[1];for(var u=[n,i,o],l=[P,S,A],c=0;c<3;++c){a(e,u[c],T),E[0]=T[0],M[0]=T[1],a(e,l[c],T),E[2]=T[0],M[2]=T[1],B[0]=M[0]-E[0],B[2]=M[2]-E[2];var f=h(B);f<s.quality&&(r.vec3.copy(s.b0,u[c]),r.vec3.copy(s.b1,t),r.vec3.copy(s.b2,l[c]),s.quality=f)}}}function a(e,t,r){var n=e.data,i=e.offsetIdx,o=e.strideIdx;r[0]=Number.POSITIVE_INFINITY,r[1]=Number.NEGATIVE_INFINITY;for(var s=i;s<n.length;s+=o){var a=n[s]*t[0]+n[s+1]*t[1]+n[s+2]*t[2];r[0]=Math.min(r[0],a),r[1]=Math.max(r[1],a)}}function u(e,t,n){r.vec3.copy(n.center,e),r.vec3.scale(n.halfSize,t,.5),r.quat.identity(n.quaternion)}function l(e,t,n){r.vec3.copy(N,t),Math.abs(t[0])>Math.abs(t[1])&&Math.abs(t[0])>Math.abs(t[2])?N[0]=0:Math.abs(t[1])>Math.abs(t[2])?N[1]=0:N[2]=0,r.vec3.squaredLength(N)<d&&(N[0]=N[1]=N[2]=1),r.vec3.cross(V,t,N),r.vec3.normalize(V,V),r.vec3.cross(F,t,V),r.vec3.normalize(F,F),c(e,t,V,F,O,z),r.vec3.subtract(L,z,O),f(t,V,F,O,z,L,n)}function c(e,t,r,n,i,o){a(e,t,T),i[0]=T[0],o[0]=T[1],a(e,r,T),i[1]=T[0],o[1]=T[1],a(e,n,T),i[2]=T[0],o[2]=T[1]}function f(e,t,n,i,o,s,a){R[0]=e[0],R[1]=e[1],R[2]=e[2],R[3]=t[0],R[4]=t[1],R[5]=t[2],R[6]=n[0],R[7]=n[1],R[8]=n[2],r.quat.fromMat3(a.quaternion,R),r.vec3.add(k,i,o),r.vec3.scale(k,k,.5),r.vec3.scale(a.center,e,k[0]),r.vec3.scale(j,t,k[1]),r.vec3.add(a.center,a.center,j),r.vec3.scale(j,n,k[2]),r.vec3.add(a.center,a.center,j),r.vec3.scale(a.halfSize,s,.5)}function h(e){return e[0]*e[1]+e[0]*e[2]+e[1]*e[2]}Object.defineProperty(t,"__esModule",{value:!0});var d=1e-6,p=r.vec3f64.create(),v=r.vec3f64.create();t.computeOBB=function(e,t){var o=e.data,s=e.strideIdx,a=o.length/s;if(!(a<=0)){var d=new Y(e);r.vec3.add(p,d.minProj,d.maxProj),r.vec3.scale(p,p,.5),r.vec3.subtract(v,d.maxProj,d.minProj);var y=h(v),m=new G;m.quality=y,a<14&&(e={data:new Float64Array(d.buffer,112,42),size:3,offsetIdx:0,strideIdx:3});var g=r.vec3f64.create(),x=r.vec3f64.create(),b=r.vec3f64.create(),_=r.vec3f64.create(),I=r.vec3f64.create(),C=r.vec3f64.create(),w=r.vec3f64.create();switch(n(d,e,w,g,x,b,_,I,C,m)){case 1:return void u(p,v,t);case 2:return void l(e,_,t)}i(e,w,g,x,b,_,I,C,m),c(e,m.b0,m.b1,m.b2,O,z);var T=r.vec3f64.create();r.vec3.subtract(T,z,O),m.quality=h(T),m.quality<y?f(m.b0,m.b1,m.b2,O,z,T,t):u(p,v,t)}};var y=r.vec3f64.create(),m=r.vec3f64.create(),g=r.vec3f64.create(),x=r.vec3f64.create(),b=r.vec3f64.create(),_=r.vec3f64.create(),I=r.vec3f64.create(),C=r.vec3f64.create(),w=r.vec3f64.create(),T=r.vec2f64.create(),P=r.vec3f64.create(),S=r.vec3f64.create(),A=r.vec3f64.create(),M=r.vec3f64.create(),E=r.vec3f64.create(),B=r.vec3f64.create(),D=r.vec3f64.create(),N=r.vec3f64.create(),V=r.vec3f64.create(),F=r.vec3f64.create(),O=r.vec3f64.create(),z=r.vec3f64.create(),L=r.vec3f64.create(),j=r.vec3f64.create(),R=r.mat3f32.create(),k=r.vec3f64.create(),U=7,Y=function(){return function(e){this.minVert=new Array(U),this.maxVert=new Array(U);var t=64*U;this.buffer=new ArrayBuffer(t);var n=0;this.minProj=new Float64Array(this.buffer,n,U),n+=8*U,this.maxProj=new Float64Array(this.buffer,n,U),n+=8*U;for(var i=0;i<U;++i)this.minVert[i]=r.vec3f64.createView(this.buffer,n),n+=24;for(i=0;i<U;++i)this.maxVert[i]=r.vec3f64.createView(this.buffer,n),n+=24;for(i=0;i<U;++i)this.minProj[i]=Number.POSITIVE_INFINITY,this.maxProj[i]=Number.NEGATIVE_INFINITY;var o=new Array(U),s=new Array(U),a=e.data,u=e.offsetIdx,l=e.strideIdx;for(i=u;i<a.length;i+=l){var c=a[i];c<this.minProj[0]&&(this.minProj[0]=c,o[0]=i),c>this.maxProj[0]&&(this.maxProj[0]=c,s[0]=i),(c=a[i+1])<this.minProj[1]&&(this.minProj[1]=c,o[1]=i),c>this.maxProj[1]&&(this.maxProj[1]=c,s[1]=i),(c=a[i+2])<this.minProj[2]&&(this.minProj[2]=c,o[2]=i),c>this.maxProj[2]&&(this.maxProj[2]=c,s[2]=i),(c=a[i]+a[i+1]+a[i+2])<this.minProj[3]&&(this.minProj[3]=c,o[3]=i),c>this.maxProj[3]&&(this.maxProj[3]=c,s[3]=i),(c=a[i]+a[i+1]-a[i+2])<this.minProj[4]&&(this.minProj[4]=c,o[4]=i),c>this.maxProj[4]&&(this.maxProj[4]=c,s[4]=i),(c=a[i]-a[i+1]+a[i+2])<this.minProj[5]&&(this.minProj[5]=c,o[5]=i),c>this.maxProj[5]&&(this.maxProj[5]=c,s[5]=i),(c=a[i]-a[i+1]-a[i+2])<this.minProj[6]&&(this.minProj[6]=c,o[6]=i),c>this.maxProj[6]&&(this.maxProj[6]=c,s[6]=i)}for(i=0;i<U;++i){var f=o[i];r.vec3.set(this.minVert[i],a[f],a[f+1],a[f+2]),f=s[i],r.vec3.set(this.maxVert[i],a[f],a[f+1],a[f+2])}}}(),G=function(){return function(){this.b0=r.vec3f64.fromValues(1,0,0),this.b1=r.vec3f64.fromValues(0,1,0),this.b2=r.vec3f64.fromValues(0,0,1),this.quality=0}}()}.apply(null,n))||(e.exports=i)},1752:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(190),r(1628),r(269),r(1753),r(1754),r(1746)],void 0===(i=function(e,t,r,n,i,o,s,a){function u(e){return i(e,["YYYY-M-D H:m:s","YYYY-M-D H:mZ","YYYY-M-D H:m:sZ","YYYY-M-D H:m","YYYY-m-d"]).toDate()}function l(e){return i(e,["YYYY-M-D"]).toDate()}function c(e){return!0===e}function f(e){return Array.isArray(e)?e:[e]}function h(e){return null!==e?!0!==e:null}function d(e,t){if(null==e)return null;for(var r=!1,n=0,i=t;n<i.length;n++){var o=i[n];if(null==o)r=null;else if(e===o){r=!0;break}}return r}function p(e,t,r){if(null==e)return null;for(var n=t,i=r,o="",s="-[]/{}()*+?.\\^$|",a=0,u=0;u<n.length;u++){var l=n.charAt(u);switch(a){case 0:l===i?a=1:s.indexOf(l)>=0?o+="\\"+l:o+="%"===l?".*":"_"===l?".":l;break;case 1:s.indexOf(l)>=0?o+="\\"+l:o+=l,a=0}}return new RegExp("^"+o+"$").test(e)}function v(e){return e instanceof Date?e.valueOf():e}function y(e){for(var t=[],r={},n=0,i=e;n<i.length;n++){var o=i[n],s=o.toLowerCase();void 0===r[s]&&(t.push(o),r[s]=1)}return t}return function(){function e(){this.parseTree=null,this.parameters=null,this._hasStandardizedFunctions=null,this._hasAggregateFunctions=null}return e.create=function(t){var r=new e;r.parseTree=a.WhereGrammar.parse(t);var n=!0,i=!0;return r.visitAll(r.parseTree,function(e){if("function"===e.type){var t=e.name,r=e.args.value.length;n&&(n=s.isStandardized(t,r)),i&&(i=o.isAggregate(t,r))}}),r._hasStandardizedFunctions=n,r._hasAggregateFunctions=i,r},e.prototype.isStandardized=function(){return this._hasStandardizedFunctions},e.prototype.isAggregate=function(){return this._hasAggregateFunctions},e.prototype.setVariablesDictionary=function(e){this.parameters=e},e.prototype.testFeature=function(e){return!!this.evaluateNode(this.parseTree,e)},e.prototype.testSet=function(e){var t=this,r=new n.default;this.visitAll(this.parseTree,function(e){"column_ref"!==e.type||r.has(e.column)||r.set(e.column,e)});for(var i={},o=0,s=e;o<s.length;o++){!function(e){r.forEach(function(r,n){var o=t.featureValue(e,n,r);i[n]?i[n].push(o):i[n]=[o]})}(s[o])}return!!this.evaluateNode(this.parseTree,{attributes:i})},e.prototype.calculateValue=function(e){return this.evaluateNode(this.parseTree,e)},e.prototype.getFunctions=function(){var e=[];return this.visitAll(this.parseTree,function(t){"function"===t.type&&e.push(t.name.toLowerCase())}),y(e)},e.prototype.getExpressions=function(){var e=new n.default;return this.visitAll(this.parseTree,function(t){if("function"===t.type){var r=t.name.toLowerCase(),n=t.args.value[0];if("column_ref"===n.type){var i=n.column,o=r+"-"+i;e.has(o)||e.set(o,{aggregateType:r,field:i})}}}),r.from(e.values())},e.prototype.getFields=function(){var e=[];return this.visitAll(this.parseTree,function(t){"column_ref"===t.type&&e.push(t.column)}),y(e)},e.prototype.getVariables=function(){var e=[];return this.visitAll(this.parseTree,function(t){"param"===t.type&&e.push(t.value.toLowerCase())}),y(e)},e.prototype.featureValue=function(e,t,r){var n=function(e){return e&&"object"==typeof e.attributes}(e)?e.attributes:e,i=n[t];if(void 0!==i)return i;for(var o in n)if(t.toLowerCase()===o.toLowerCase())return r.column=o,n[o];return null},e.prototype.visitAll=function(e,t){if(null!=e)switch(t(e),e.type){case"when_clause":this.visitAll(e.operand,t),this.visitAll(e.value,t);break;case"case_expression":for(var r=0,n=e.clauses;r<n.length;r++){var i=n[r];this.visitAll(i,t)}"simple"===e.format&&this.visitAll(e.operand,t),null!==e.else&&this.visitAll(e.else,t);break;case"expr_list":for(var o=0,s=e.value;o<s.length;o++){i=s[o];this.visitAll(i,t)}break;case"unary_expr":this.visitAll(e.expr,t);break;case"binary_expr":this.visitAll(e.left,t),this.visitAll(e.right,t);break;case"function":this.visitAll(e.args,t)}},e.prototype.evaluateNode=function(e,t){switch(e.type){case"case_expression":if("simple"===e.format){for(var r=v(this.evaluateNode(e.operand,t)),n=0;n<e.clauses.length;n++)if(r===v(this.evaluateNode(e.clauses[n].operand,t)))return this.evaluateNode(e.clauses[n].value,t);if(null!==e.else)return this.evaluateNode(e.else,t)}else{for(n=0;n<e.clauses.length;n++)if(c(this.evaluateNode(e.clauses[n].operand,t)))return this.evaluateNode(e.clauses[n].value,t);if(null!==e.else)return this.evaluateNode(e.else,t)}return null;case"param":return this.parameters[e.value.toLowerCase()];case"expr_list":for(var i=[],a=0,y=e.value;a<y.length;a++){var m=y[a];i.push(this.evaluateNode(m,t))}return i;case"unary_expr":return h(this.evaluateNode(e.expr,t));case"binary_expr":switch(e.operator){case"AND":return function(e,t){return null!=e&&null!=t?!0===e&&!0===t:!1!==e&&!1!==t&&null}(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t));case"OR":return function(e,t){return null!=e&&null!=t?!0===e||!0===t:!0===e||!0===t||null}(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t));case"IS":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null===this.evaluateNode(e.left,t);case"ISNOT":if("null"!==e.right.type)throw new Error("Unsupported RHS for IS");return null!==this.evaluateNode(e.left,t);case"IN":var g=f(this.evaluateNode(e.right,t));return d(this.evaluateNode(e.left,t),g);case"NOT IN":g=f(this.evaluateNode(e.right,t));return h(d(this.evaluateNode(e.left,t),g));case"BETWEEN":var x=this.evaluateNode(e.left,t),b=this.evaluateNode(e.right,t);return null==x||null==b[0]||null==b[1]?null:x>=b[0]&&x<=b[1];case"NOTBETWEEN":x=this.evaluateNode(e.left,t),b=this.evaluateNode(e.right,t);return null==x||null==b[0]||null==b[1]?null:x<b[0]||x>b[1];case"LIKE":return p(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t),e.escape);case"NOT LIKE":return h(p(this.evaluateNode(e.left,t),this.evaluateNode(e.right,t),e.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return function(e,t,r){if(null==t||null==r)return null;var n=v(t),i=v(r);switch(e){case"<>":return n!==i;case"=":return n===i;case">":return n>i;case"<":return n<i;case">=":return n>=i;case"<=":return n<=i}}(e.operator,this.evaluateNode(e.left,t),this.evaluateNode(e.right,t));case"*":return this.evaluateNode(e.left,t)*this.evaluateNode(e.right,t);case"-":return this.evaluateNode(e.left,t)-this.evaluateNode(e.right,t);case"+":return this.evaluateNode(e.left,t)+this.evaluateNode(e.right,t);case"/":return this.evaluateNode(e.left,t)/this.evaluateNode(e.right,t)}throw new Error("Not Supported Operator "+e.operator);case"null":case"bool":case"string":case"number":return e.value;case"date":return l(e.value);case"timestamp":return u(e.value);case"column_ref":return"CURRENT_DATE"===e.column.toUpperCase()?((m=new Date).setHours(0,0,0,0),m):"CURRENT_TIMESTAMP"===e.column.toUpperCase()?new Date:this.featureValue(t,e.column,e);case"function":var _=this.evaluateNode(e.args,t);return this.isAggregate()?o.aggregateFunction(e.name,_):s.evaluateFunction(e.name,_)}throw new Error("Unsupported sql syntax "+e.type)},e}()}.apply(null,n))||(e.exports=i)},1753:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){function r(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t/e.length}function n(e){for(var t=r(e),n=e.length,i=0,o=0,s=e;o<s.length;o++){var a=s[o];i+=Math.pow(a-t,2)}return n>1?i/(n-1):0}Object.defineProperty(t,"__esModule",{value:!0}),t.aggregateFunction=function(e,t){var r=i[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isAggregate=function(e,t){var r=i[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var i={min:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.min.apply(Math,e[0])}},max:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.max.apply(Math,e[0])}},avg:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:r(e[0])}},sum:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r];return t}(e[0])}},stddev:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sqrt(n(e[0]))}},count:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].length}},var:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:n(e[0])}}}}.apply(null,n))||(e.exports=i)},1754:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(187)],void 0===(i=function(e,t,r){Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateFunction=function(e,t){var r=n[e.toLowerCase()];if(null==r)throw new Error("Function Not Recognised");if(t.length<r.minParams||t.length>r.maxParams)throw new Error("Invalid Parameter count for call to "+e.toUpperCase());return r.evaluate(t)},t.isStandardized=function(e,t){var r=n[e.toLowerCase()];return null!=r&&t>=r.minParams&&t<=r.maxParams};var n={extract:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];if(null==r)return null;if(r instanceof Date)switch(t.toUpperCase()){case"SECOND":return r.getSeconds();case"MINUTE":return r.getMinutes();case"HOUR":return r.getHours();case"DAY":return r.getDate();case"MONTH":return r.getMonth()+1;case"YEAR":return r.getFullYear()}throw new Error("Invalid Parameter for call to EXTRACT")}},substring:{minParams:2,maxParams:3,evaluate:function(e){if(2===e.length){var t=e[0],r=e[1];return null==t||null==r?null:t.toString().substring(r-1)}if(3===e.length){t=e[0],r=e[1];var n=e[2];return null==t||null==r||null==n?null:n<=0?"":t.toString().substring(r-1,r+n-1)}}},position:{minParams:2,maxParams:2,evaluate:function(e){var t=e[0],r=e[1];return null==t||null==r?null:r.indexOf(t)+1}},trim:{minParams:2,maxParams:3,evaluate:function(e){var t=3===e.length,n=t?e[1]:" ",i=t?e[2]:e[1];if(null==n||null==i)return null;var o="("+r.escapeString(n)+")";switch(e[0]){case"BOTH":return i.replace(new RegExp("^"+o+"*|"+o+"*$","g"),"");case"LEADING":return i.replace(new RegExp("^"+o+"*","g"),"");case"TRAILING":return i.replace(new RegExp(o+"*$","g"),"")}throw new Error("Invalid Parameter for call to TRIM")}},abs:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.abs(e[0])}},ceiling:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.ceil(e[0])}},floor:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.floor(e[0])}},log:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])}},log10:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.log(e[0])*Math.LOG10E}},sin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.sin(e[0])}},cos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.cos(e[0])}},tan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.tan(e[0])}},asin:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.asin(e[0])}},acos:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.acos(e[0])}},atan:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:Math.atan(e[0])}},sign:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0]>0?1:e[1]<0?-1:0}},power:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:Math.pow(e[0],e[1])}},mod:{minParams:2,maxParams:2,evaluate:function(e){return null==e[0]||null==e[1]?null:e[0]%e[1]}},round:{minParams:1,maxParams:2,evaluate:function(e){var t=e[0],r=2===e.length?Math.pow(10,e[1]):1;return null==t?null:Math.round(t*r)/r}},truncate:{minParams:1,maxParams:2,evaluate:function(e){return null==e[0]?null:1===e.length?parseInt(e[0].toFixed(0),10):parseFloat(e[0].toFixed(e[1]))}},char_length:{minParams:1,maxParams:1,evaluate:function(e){return"string"==typeof e[0]||e[0]instanceof String?e[0].length:0}},concat:{minParams:1,maxParams:1/0,evaluate:function(e){for(var t="",r=0;r<e.length;r++){if(null==e[r])return null;t+=e[r].toString()}return t}},lower:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toLowerCase()}},upper:{minParams:1,maxParams:1,evaluate:function(e){return null==e[0]?null:e[0].toString().toUpperCase()}}}}.apply(null,n))||(e.exports=i)},1755:function(e,t,r){var n;void 0===(n=function(){"use strict";function e(t,r,n,i){this.message=t,this.expected=r,this.found=n,this.location=i,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,e)}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(e,Error),e.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function i(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function o(e){return s[e.type](e)}var s={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?i(e.parts[t][0])+"-"+i(e.parts[t][1]):i(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+function(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=o(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(e)+" but "+(t?'"'+n(t)+'"':"end of input")+" found."},{SyntaxError:e,parse:function(t,r){function n(e,t){return{type:"literal",text:e,ignoreCase:t}}function i(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function o(e){var r,n=pi[e];if(n)return n;for(r=e-1;!pi[r];)r--;for(n={line:(n=pi[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return pi[e]=n,n}function s(e,t){var r=o(e),n=o(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function a(e){di<vi||(di>vi&&(vi=di,yi=[]),yi.push(e))}function u(){var e,t;return e=di,fe()!==me&&(t=c())!==me&&fe()!==me?e=be(t):(di=e,e=me),e}function l(){var e,t,r,n,i,o,s,a;if(e=di,(t=c())!==me){for(r=[],n=di,(i=fe())!==me&&(o=ue())!==me&&(s=fe())!==me&&(a=c())!==me?n=i=[i,o,s,a]:(di=n,n=me);n!==me;)r.push(n),n=di,(i=fe())!==me&&(o=ue())!==me&&(s=fe())!==me&&(a=c())!==me?n=i=[i,o,s,a]:(di=n,n=me);r!==me?e=t=_e(t,r):(di=e,e=me)}else di=e,e=me;return e}function c(){var e,t,r,n,i,o,s,a;if(e=di,(t=f())!==me){for(r=[],n=di,(i=fe())!==me&&(o=Z())!==me&&(s=fe())!==me&&(a=f())!==me?n=i=[i,o,s,a]:(di=n,n=me);n!==me;)r.push(n),n=di,(i=fe())!==me&&(o=Z())!==me&&(s=fe())!==me&&(a=f())!==me?n=i=[i,o,s,a]:(di=n,n=me);r!==me?e=t=Ie(t,r):(di=e,e=me)}else di=e,e=me;return e}function f(){var e,t,r,n,i,o,s,a;if(e=di,(t=h())!==me){for(r=[],n=di,(i=fe())!==me&&(o=Q())!==me&&(s=fe())!==me&&(a=h())!==me?n=i=[i,o,s,a]:(di=n,n=me);n!==me;)r.push(n),n=di,(i=fe())!==me&&(o=Q())!==me&&(s=fe())!==me&&(a=h())!==me?n=i=[i,o,s,a]:(di=n,n=me);r!==me?e=t=Ie(t,r):(di=e,e=me)}else di=e,e=me;return e}function h(){var e,r,n,i,o;return e=di,(r=q())===me&&(r=di,33===t.charCodeAt(di)?(n=Ce,di++):(n=me,0===mi&&a(we)),n!==me?(i=di,mi++,61===t.charCodeAt(di)?(o=Te,di++):(o=me,0===mi&&a(Pe)),mi--,o===me?i=void 0:(di=i,i=me),i!==me?r=n=[n,i]:(di=r,r=me)):(di=r,r=me)),r!==me&&(n=fe())!==me&&(i=h())!==me?e=r=Se(i):(di=e,e=me),e===me&&(e=function(){var e,t,r;return e=di,(t=y())!==me&&fe()!==me?((r=function(){var e;return(e=function(){var e,t,r,n,i,o;if(di,e=[],t=di,(r=fe())!==me&&(n=d())!==me&&(i=fe())!==me&&(o=y())!==me?t=r=[r,n,i,o]:(di=t,t=me),t!==me)for(;t!==me;)e.push(t),t=di,(r=fe())!==me&&(n=d())!==me&&(i=fe())!==me&&(o=y())!==me?t=r=[r,n,i,o]:(di=t,t=me);else e=me;return e!==me&&(e=Me(e)),e}())===me&&(e=function(){var e,t,r,n;return e=di,(t=v())!==me&&fe()!==me&&(r=le())!==me&&fe()!==me&&(n=l())!==me&&fe()!==me&&ce()!==me?(t=Je(t,n),e=t):(di=e,e=me),e===me&&(e=di,(t=v())!==me&&fe()!==me&&(r=le())!==me&&fe()!==me&&(n=ce())!==me?(t=He(t),e=t):(di=e,e=me),e===me&&(e=di,(t=v())!==me&&fe()!==me&&(r=T())!==me?(t=We(t,r),e=t):(di=e,e=me))),e}())===me&&(e=function(){var e,t,r,n,i,o;return e=di,(t=q())!==me&&fe()!==me&&(r=X())!==me&&fe()!==me&&(n=y())!==me&&fe()!==me&&(i=Q())!==me&&fe()!==me&&(o=y())!==me?(t=Ge(r,n,o),e=t):(di=e,e=me),e===me&&(e=di,(t=X())!==me&&fe()!==me&&(r=y())!==me&&fe()!==me&&(n=Q())!==me&&fe()!==me&&(i=y())!==me?(t=qe(t,r,i),e=t):(di=e,e=me)),e}())===me&&(e=function(){var e,t,r,n;return e=di,(t=U())!==me&&fe()!==me&&(r=q())!==me&&fe()!==me&&(n=y())!==me?(t=Ue(t,n),e=t):(di=e,e=me),e===me&&(e=di,(t=U())!==me&&fe()!==me&&(r=y())!==me?(t=Ye(t,r),e=t):(di=e,e=me)),e}())===me&&(e=function(){var e,t,r,n;return e=di,(t=p())!==me&&fe()!==me&&(r=S())!==me&&fe()!==me&&G()!==me&&fe()!==me&&(n=A())!==me?(t=Ze(t,r,n),e=t):(di=e,e=me),e===me&&(e=di,(t=p())!==me&&fe()!==me&&(r=S())!==me?(t=Xe(t,r),e=t):(di=e,e=me)),e}()),e}())===me&&(r=null),r!==me?(t=Ae(t,r),e=t):(di=e,e=me)):(di=e,e=me),e}()),e}function d(){var e;return t.substr(di,2)===Ee?(e=Ee,di+=2):(e=me,0===mi&&a(Be)),e===me&&(62===t.charCodeAt(di)?(e=De,di++):(e=me,0===mi&&a(Ne)),e===me&&(t.substr(di,2)===Ve?(e=Ve,di+=2):(e=me,0===mi&&a(Fe)),e===me&&(t.substr(di,2)===Oe?(e=Oe,di+=2):(e=me,0===mi&&a(ze)),e===me&&(60===t.charCodeAt(di)?(e=Le,di++):(e=me,0===mi&&a(je)),e===me&&(61===t.charCodeAt(di)?(e=Te,di++):(e=me,0===mi&&a(Pe)),e===me&&(t.substr(di,2)===Re?(e=Re,di+=2):(e=me,0===mi&&a(ke)))))))),e}function p(){var e,t,r,n,i;return e=di,t=di,(r=q())!==me&&(n=fe())!==me&&(i=Y())!==me?t=r=[r,n,i]:(di=t,t=me),t!==me&&(t=Qe(t)),(e=t)===me&&(e=Y()),e}function v(){var e,t,r,n,i;return e=di,t=di,(r=q())!==me&&(n=fe())!==me&&(i=k())!==me?t=r=[r,n,i]:(di=t,t=me),t!==me&&(t=Qe(t)),(e=t)===me&&(e=k()),e}function y(){var e,t,r,n,i,o,s,a;if(e=di,(t=g())!==me){for(r=[],n=di,(i=fe())!==me&&(o=m())!==me&&(s=fe())!==me&&(a=g())!==me?n=i=[i,o,s,a]:(di=n,n=me);n!==me;)r.push(n),n=di,(i=fe())!==me&&(o=m())!==me&&(s=fe())!==me&&(a=g())!==me?n=i=[i,o,s,a]:(di=n,n=me);r!==me?e=t=Ie(t,r):(di=e,e=me)}else di=e,e=me;return e}function m(){var e;return 43===t.charCodeAt(di)?(e=Ke,di++):(e=me,0===mi&&a($e)),e===me&&(45===t.charCodeAt(di)?(e=et,di++):(e=me,0===mi&&a(tt))),e}function g(){var e,t,r,n,i,o,s,a;if(e=di,(t=b())!==me){for(r=[],n=di,(i=fe())!==me&&(o=x())!==me&&(s=fe())!==me&&(a=b())!==me?n=i=[i,o,s,a]:(di=n,n=me);n!==me;)r.push(n),n=di,(i=fe())!==me&&(o=x())!==me&&(s=fe())!==me&&(a=b())!==me?n=i=[i,o,s,a]:(di=n,n=me);r!==me?e=t=rt(t,r):(di=e,e=me)}else di=e,e=me;return e}function x(){var e;return 42===t.charCodeAt(di)?(e=nt,di++):(e=me,0===mi&&a(it)),e===me&&(47===t.charCodeAt(di)?(e=ot,di++):(e=me,0===mi&&a(st))),e}function b(){var e,t;return(e=function(){var e;return(e=A())===me&&(e=function(){var e,t,r,n;return e=di,(t=function(){var e,t,r,n;return e=di,(t=D())!==me&&(r=N())!==me&&(n=V())!==me?(t=Xt(t,r,n),e=t):(di=e,e=me),e===me&&(e=di,(t=D())!==me&&(r=N())!==me?(t=Jt(t,r),e=t):(di=e,e=me),e===me&&(e=di,(t=D())!==me&&(r=V())!==me?(t=Ht(t,r),e=t):(di=e,e=me),e===me&&(e=di,(t=D())!==me&&(t=Wt(t)),e=t))),e}())!==me?(r=di,mi++,n=I(),mi--,n===me?r=void 0:(di=r,r=me),r!==me?(t=Zt(t),e=t):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,t;return e=di,(t=j())!==me&&(t=Mt()),(e=t)===me&&(e=di,(t=R())!==me&&(t=Et()),e=t),e}())===me&&(e=function(){var e;return di,(e=L())!==me&&(e=At()),e}())===me&&(e=function(){var e,t,r;return e=di,(t=re())!==me&&fe()!==me&&(r=S())!==me?(t=St(r),e=t):(di=e,e=me),e}())===me&&(e=function(){var e,t,r;return e=di,(t=te())!==me&&fe()!==me&&(r=S())!==me?(t=Pt(r),e=t):(di=e,e=me),e}()),e}())===me&&(e=function(){var e,t,r,n;return e=di,(t=K())!==me&&fe()!==me&&le()!==me&&fe()!==me&&(r=function(){var e;return(e=function(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===_n?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(In)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=Cn(),e=r):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=di,t.substr(di,5).toLowerCase()===wn?(r=t.substr(di,5),di+=5):(r=me,0===mi&&a(Tn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=Pn(),e=r):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=di,t.substr(di,3).toLowerCase()===Sn?(r=t.substr(di,3),di+=3):(r=me,0===mi&&a(An)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=Mn(),e=r):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===En?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(Bn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=Dn(),e=r):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=di,t.substr(di,6).toLowerCase()===Nn?(r=t.substr(di,6),di+=6):(r=me,0===mi&&a(Vn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=Fn(),e=r):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=di,t.substr(di,6).toLowerCase()===On?(r=t.substr(di,6),di+=6):(r=me,0===mi&&a(zn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=Ln(),e=r):(di=e,e=me)):(di=e,e=me),e}()),e}())!==me&&fe()!==me&&J()!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&ce()!==me?(t=bt(r,n),e=t):(di=e,e=me),e}())===me&&(e=function(){var e,t,r,n,i,o,s,a,u;return e=di,(t=W())!==me&&fe()!==me&&le()!==me&&fe()!==me&&(r=c())!==me&&fe()!==me&&J()!==me&&fe()!==me&&(n=c())!==me&&fe()!==me?(i=di,(o=H())!==me&&(s=fe())!==me&&(a=c())!==me&&(u=fe())!==me?i=o=[o,s,a,u]:(di=i,i=me),i===me&&(i=null),i!==me&&(o=ce())!==me?(t=_t(r,n,i),e=t):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,t,r,n,i;return e=di,(t=$())!==me&&fe()!==me&&le()!==me&&fe()!==me?((r=P())===me&&(r=null),r!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&J()!==me&&fe()!==me&&(i=c())!==me&&fe()!==me&&ce()!==me?(t=It(r,n,i),e=t):(di=e,e=me)):(di=e,e=me),e===me&&(e=di,(t=$())!==me&&fe()!==me&&le()!==me&&fe()!==me?((r=P())===me&&(r=null),r!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&ce()!==me?(t=Ct(r,n),e=t):(di=e,e=me)):(di=e,e=me)),e}())===me&&(e=function(){var e,t,r,n;return e=di,(t=ee())!==me&&fe()!==me&&le()!==me&&fe()!==me&&(r=c())!==me&&fe()!==me&&k()!==me&&fe()!==me&&(n=c())!==me&&fe()!==me&&ce()!==me?(t=wt(r,n),e=t):(di=e,e=me),e}())===me&&(e=function(){var e,t,r;return e=di,(t=de())!==me&&fe()!==me&&le()!==me&&fe()!==me?((r=l())===me&&(r=null),r!==me&&fe()!==me&&ce()!==me?(t=Tt(t,r),e=t):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e;return(e=function(){var e,t,r,n,i,o;if(e=di,(t=ne())!==me)if(fe()!==me)if((r=c())!==me)if(fe()!==me){for(n=[],i=E();i!==me;)n.push(i),i=E();n!==me&&(i=fe())!==me&&(o=ie())!==me?(t=kt(r,n),e=t):(di=e,e=me)}else di=e,e=me;else di=e,e=me;else di=e,e=me;else di=e,e=me;if(e===me)if(e=di,(t=ne())!==me)if(fe()!==me)if((r=c())!==me)if(fe()!==me){for(n=[],i=E();i!==me;)n.push(i),i=E();n!==me&&(i=fe())!==me&&(o=B())!==me&&fe()!==me&&ie()!==me?(t=Ut(r,n,o),e=t):(di=e,e=me)}else di=e,e=me;else di=e,e=me;else di=e,e=me;else di=e,e=me;return e}())===me&&(e=function(){var e,t,r,n,i;if(e=di,(t=ne())!==me)if(fe()!==me){for(r=[],n=M();n!==me;)r.push(n),n=M();r!==me&&(n=fe())!==me&&(i=ie())!==me?(t=Yt(r),e=t):(di=e,e=me)}else di=e,e=me;else di=e,e=me;if(e===me)if(e=di,(t=ne())!==me)if(fe()!==me){for(r=[],n=M();n!==me;)r.push(n),n=M();r!==me&&(n=fe())!==me&&(i=B())!==me&&fe()!==me&&ie()!==me?(t=Gt(r,i),e=t):(di=e,e=me)}else di=e,e=me;else di=e,e=me;return e}()),e}())===me&&(e=function(){var e;return di,(e=function(){var e;return di,(e=function(){var e,t,r,n;if(e=di,(t=I())!==me){for(r=[],n=w();n!==me;)r.push(n),n=w();r!==me?(t=ct(t,r),e=t):(di=e,e=me)}else di=e,e=me;return e}())!==me&&(e=lt(e)),e}())!==me&&(e=ut(e)),e}())===me&&(e=T())===me&&(e=di,le()!==me&&fe()!==me&&(t=c())!==me&&fe()!==me&&ce()!==me?e=at(t):(di=e,e=me)),e}function _(){var e,t,r,n;if(e=di,(t=I())!==me){for(r=[],n=C();n!==me;)r.push(n),n=C();r!==me?e=t=ct(t,r):(di=e,e=me)}else di=e,e=me;return e}function I(){var e;return ft.test(t.charAt(di))?(e=t.charAt(di),di++):(e=me,0===mi&&a(ht)),e}function C(){var e;return dt.test(t.charAt(di))?(e=t.charAt(di),di++):(e=me,0===mi&&a(pt)),e}function w(){var e;return vt.test(t.charAt(di))?(e=t.charAt(di),di++):(e=me,0===mi&&a(yt)),e}function T(){var e,r,n;return di,e=di,64===t.charCodeAt(di)?(r=mt,di++):(r=me,0===mi&&a(gt)),r!==me&&(n=_())!==me?e=r=[r,n]:(di=e,e=me),e!==me&&(e=xt(e)),e}function P(){var e;return(e=function(){var e,r,n,i;return e=di,t.substr(di,7).toLowerCase()===hn?(r=t.substr(di,7),di+=7):(r=me,0===mi&&a(dn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=pn(),e=r):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=di,t.substr(di,8).toLowerCase()===vn?(r=t.substr(di,8),di+=8):(r=me,0===mi&&a(yn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=mn(),e=r):(di=e,e=me)):(di=e,e=me),e}())===me&&(e=function(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===gn?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(xn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?(r=bn(),e=r):(di=e,e=me)):(di=e,e=me),e}()),e}function S(){var e;return(e=A())===me&&(e=T()),e}function A(){var e,r,n,i,o;if(e=di,39===t.charCodeAt(di)?(r=Bt,di++):(r=me,0===mi&&a(Dt)),r===me&&(t.substr(di,2)===Nt?(r=Nt,di+=2):(r=me,0===mi&&a(Vt))),r!==me){for(n=[],i=di,t.substr(di,2)===Ft?(o=Ft,di+=2):(o=me,0===mi&&a(Ot)),o!==me&&(o=zt()),(i=o)===me&&(Lt.test(t.charAt(di))?(i=t.charAt(di),di++):(i=me,0===mi&&a(jt)));i!==me;)n.push(i),i=di,t.substr(di,2)===Ft?(o=Ft,di+=2):(o=me,0===mi&&a(Ot)),o!==me&&(o=zt()),(i=o)===me&&(Lt.test(t.charAt(di))?(i=t.charAt(di),di++):(i=me,0===mi&&a(jt)));n!==me?(39===t.charCodeAt(di)?(i=Bt,di++):(i=me,0===mi&&a(Dt)),i!==me?e=r=Rt(n):(di=e,e=me)):(di=e,e=me)}else di=e,e=me;return e}function M(){var e,t,r;return e=di,oe()!==me&&fe()!==me&&(t=c())!==me&&fe()!==me&&se()!==me&&fe()!==me&&(r=c())!==me?e=qt(t,r):(di=e,e=me),e}function E(){var e,t,r;return e=di,oe()!==me&&fe()!==me&&(t=c())!==me&&fe()!==me&&se()!==me&&fe()!==me&&(r=c())!==me?e=qt(t,r):(di=e,e=me),e}function B(){var e,t;return e=di,ae()!==me&&fe()!==me&&(t=c())!==me?e=Qt(t):(di=e,e=me),e}function D(){var e,r,n;return(e=F())===me&&(e=di,45===t.charCodeAt(di)?(r=et,di++):(r=me,0===mi&&a(tt)),r===me&&(43===t.charCodeAt(di)?(r=Ke,di++):(r=me,0===mi&&a($e))),r!==me&&(n=F())!==me?e=r=Kt(r,n):(di=e,e=me)),e}function N(){var e,r,n;return e=di,46===t.charCodeAt(di)?(r=$t,di++):(r=me,0===mi&&a(er)),r!==me?((n=F())===me&&(n=null),n!==me?e=r=tr(n):(di=e,e=me)):(di=e,e=me),e}function V(){var e,t,r;return e=di,(t=z())!==me&&(r=F())!==me?e=t=rr(t,r):(di=e,e=me),e}function F(){var e,t;if(di,e=[],(t=O())!==me)for(;t!==me;)e.push(t),t=O();else e=me;return e!==me&&(e=nr(e)),e}function O(){var e;return ir.test(t.charAt(di))?(e=t.charAt(di),di++):(e=me,0===mi&&a(or)),e}function z(){var e,r,n;return e=di,sr.test(t.charAt(di))?(r=t.charAt(di),di++):(r=me,0===mi&&a(ar)),r!==me?(ur.test(t.charAt(di))?(n=t.charAt(di),di++):(n=me,0===mi&&a(lr)),n===me&&(n=null),n!==me?e=r=cr(r,n):(di=e,e=me)):(di=e,e=me),e}function L(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===fr?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(hr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=[r,n]:(di=e,e=me)):(di=e,e=me),e}function j(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===dr?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(pr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=[r,n]:(di=e,e=me)):(di=e,e=me),e}function R(){var e,r,n,i;return e=di,t.substr(di,5).toLowerCase()===vr?(r=t.substr(di,5),di+=5):(r=me,0===mi&&a(yr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=[r,n]:(di=e,e=me)):(di=e,e=me),e}function k(){var e,r,n,i;return e=di,t.substr(di,2).toLowerCase()===mr?(r=t.substr(di,2),di+=2):(r=me,0===mi&&a(gr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=xr():(di=e,e=me)):(di=e,e=me),e}function U(){var e,r,n,i;return e=di,t.substr(di,2).toLowerCase()===br?(r=t.substr(di,2),di+=2):(r=me,0===mi&&a(_r)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Ir():(di=e,e=me)):(di=e,e=me),e}function Y(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===Cr?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(wr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Tr():(di=e,e=me)):(di=e,e=me),e}function G(){var e,r,n,i;return e=di,t.substr(di,6).toLowerCase()===Pr?(r=t.substr(di,6),di+=6):(r=me,0===mi&&a(Sr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Ar():(di=e,e=me)):(di=e,e=me),e}function q(){var e,r,n,i;return e=di,t.substr(di,3).toLowerCase()===Mr?(r=t.substr(di,3),di+=3):(r=me,0===mi&&a(Er)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Br():(di=e,e=me)):(di=e,e=me),e}function Q(){var e,r,n,i;return e=di,t.substr(di,3).toLowerCase()===Dr?(r=t.substr(di,3),di+=3):(r=me,0===mi&&a(Nr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Vr():(di=e,e=me)):(di=e,e=me),e}function Z(){var e,r,n,i;return e=di,t.substr(di,2).toLowerCase()===Fr?(r=t.substr(di,2),di+=2):(r=me,0===mi&&a(Or)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=zr():(di=e,e=me)):(di=e,e=me),e}function X(){var e,r,n,i;return e=di,t.substr(di,7).toLowerCase()===Lr?(r=t.substr(di,7),di+=7):(r=me,0===mi&&a(jr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Rr():(di=e,e=me)):(di=e,e=me),e}function J(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===kr?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(Ur)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Yr():(di=e,e=me)):(di=e,e=me),e}function H(){var e,r,n,i;return e=di,t.substr(di,3).toLowerCase()===Gr?(r=t.substr(di,3),di+=3):(r=me,0===mi&&a(qr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Qr():(di=e,e=me)):(di=e,e=me),e}function W(){var e,r,n,i;return e=di,t.substr(di,9).toLowerCase()===Zr?(r=t.substr(di,9),di+=9):(r=me,0===mi&&a(Xr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Jr():(di=e,e=me)):(di=e,e=me),e}function K(){var e,r,n,i;return e=di,t.substr(di,7).toLowerCase()===Hr?(r=t.substr(di,7),di+=7):(r=me,0===mi&&a(Wr)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Kr():(di=e,e=me)):(di=e,e=me),e}function $(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===$r?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(en)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=tn():(di=e,e=me)):(di=e,e=me),e}function ee(){var e,r,n,i;return e=di,t.substr(di,8).toLowerCase()===rn?(r=t.substr(di,8),di+=8):(r=me,0===mi&&a(nn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=on():(di=e,e=me)):(di=e,e=me),e}function te(){var e,r,n,i;return e=di,t.substr(di,9).toLowerCase()===sn?(r=t.substr(di,9),di+=9):(r=me,0===mi&&a(an)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=un():(di=e,e=me)):(di=e,e=me),e}function re(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===ln?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(cn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=fn():(di=e,e=me)):(di=e,e=me),e}function ne(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===jn?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(Rn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=kn():(di=e,e=me)):(di=e,e=me),e}function ie(){var e,r,n,i;return e=di,t.substr(di,3).toLowerCase()===Un?(r=t.substr(di,3),di+=3):(r=me,0===mi&&a(Yn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Gn():(di=e,e=me)):(di=e,e=me),e}function oe(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===qn?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(Qn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Zn():(di=e,e=me)):(di=e,e=me),e}function se(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===Xn?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(Jn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=Hn():(di=e,e=me)):(di=e,e=me),e}function ae(){var e,r,n,i;return e=di,t.substr(di,4).toLowerCase()===Wn?(r=t.substr(di,4),di+=4):(r=me,0===mi&&a(Kn)),r!==me?(n=di,mi++,i=C(),mi--,i===me?n=void 0:(di=n,n=me),n!==me?e=r=$n():(di=e,e=me)):(di=e,e=me),e}function ue(){var e;return 44===t.charCodeAt(di)?(e=ei,di++):(e=me,0===mi&&a(ti)),e}function le(){var e;return 40===t.charCodeAt(di)?(e=ri,di++):(e=me,0===mi&&a(ni)),e}function ce(){var e;return 41===t.charCodeAt(di)?(e=ii,di++):(e=me,0===mi&&a(oi)),e}function fe(){var e,t;for(e=[],t=he();t!==me;)e.push(t),t=he();return e}function he(){var e;return si.test(t.charAt(di))?(e=t.charAt(di),di++):(e=me,0===mi&&a(ai)),e}function de(){var e,r,n,i;if(e=di,(r=_())!==me&&(r=lt(r)),(e=r)===me)if(e=di,96===t.charCodeAt(di)?(r=ui,di++):(r=me,0===mi&&a(li)),r!==me){if(n=[],ci.test(t.charAt(di))?(i=t.charAt(di),di++):(i=me,0===mi&&a(fi)),i!==me)for(;i!==me;)n.push(i),ci.test(t.charAt(di))?(i=t.charAt(di),di++):(i=me,0===mi&&a(fi));else n=me;n!==me?(96===t.charCodeAt(di)?(i=ui,di++):(i=me,0===mi&&a(li)),i!==me?e=r=hi(n):(di=e,e=me)):(di=e,e=me)}else di=e,e=me;return e}function pe(e,t,r,n){var i={type:"binary_expr",operator:e,left:t,right:r};return void 0!==n&&(i.escape=n),i}function ve(e,t){for(var r=e,n=0;n<t.length;n++)r=pe(t[n][1],r,t[n][3]);return r}r=void 0!==r?r:{};var ye,me={},ge={start:u},xe=u,be=function(e){return e},_e=function(e,t){var r={type:"expr_list"},n=function(e,t,r){return function(e,t){for(var r=[e],n=0;n<t.length;n++)r.push(t[n][3]);return r}(e,t)}(e,t);return r.value=n,r},Ie=function(e,t){return ve(e,t)},Ce="!",we=n("!",!1),Te="=",Pe=n("=",!1),Se=function(e){return function(e,t){return{type:"unary_expr",operator:e,expr:t}}("NOT",e)},Ae=function(e,t){return""==t||void 0==t||null==t?e:"arithmetic"==t.type?ve(e,t.tail):pe(t.op,e,t.right,t.escape)},Me=function(e){return{type:"arithmetic",tail:e}},Ee=">=",Be=n(">=",!1),De=">",Ne=n(">",!1),Ve="<=",Fe=n("<=",!1),Oe="<>",ze=n("<>",!1),Le="<",je=n("<",!1),Re="!=",ke=n("!=",!1),Ue=function(e,t){return{op:e+"NOT",right:t}},Ye=function(e,t){return{op:e,right:t}},Ge=function(e,t,r){return{op:"NOT"+e,right:{type:"expr_list",value:[t,r]}}},qe=function(e,t,r){return{op:e,right:{type:"expr_list",value:[t,r]}}},Qe=function(e){return e[0]+" "+e[2]},Ze=function(e,t,r){return{op:e,right:t,escape:r.value}},Xe=function(e,t){return{op:e,right:t,escape:""}},Je=function(e,t){return{op:e,right:t}},He=function(e){return{op:e,right:{type:"expr_list",value:[]}}},We=function(e,t){return{op:e,right:t}},Ke="+",$e=n("+",!1),et="-",tt=n("-",!1),rt=function(e,t){return ve(e,t)},nt="*",it=n("*",!1),ot="/",st=n("/",!1),at=function(e){return e.paren=!0,e},ut=function(e){return{type:"column_ref",table:"",column:e}},lt=function(e){return e},ct=function(e,t){return e+t.join("")},ft=/^[A-Za-z_\x80-\uFFFF]/,ht=i([["A","Z"],["a","z"],"_",["","￿"]],!1,!1),dt=/^[A-Za-z0-9_]/,pt=i([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),vt=/^[A-Za-z0-9_.\x80-\uFFFF]/,yt=i([["A","Z"],["a","z"],["0","9"],"_",".",["","￿"]],!1,!1),mt="@",gt=n("@",!1),xt=function(e){return{type:"param",value:e[1]}},bt=function(e,t){return{type:"function",name:"extract",args:{type:"expr_list",value:[{type:"string",value:e},t]}}},_t=function(e,t,r){return{type:"function",name:"substring",args:{type:"expr_list",value:r?[e,t,r[2]]:[e,t]}}},It=function(e,t,r){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t,r]}}},Ct=function(e,t){return{type:"function",name:"trim",args:{type:"expr_list",value:[{type:"string",value:null==e?"BOTH":e},t]}}},wt=function(e,t){return{type:"function",name:"position",args:{type:"expr_list",value:[e,t]}}},Tt=function(e,t){return{type:"function",name:e,args:t||{type:"expr_list",value:[]}}},Pt=function(e){return{type:"timestamp",value:e.value}},St=function(e){return{type:"date",value:e.value}},At=function(){return{type:"null",value:null}},Mt=function(){return{type:"bool",value:!0}},Et=function(){return{type:"bool",value:!1}},Bt="'",Dt=n("'",!1),Nt="N'",Vt=n("N'",!1),Ft="''",Ot=n("''",!1),zt=function(){return"'"},Lt=/^[^']/,jt=i(["'"],!0,!1),Rt=function(e){return{type:"string",value:e.join("")}},kt=function(e,t){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:null}},Ut=function(e,t,r){return{type:"case_expression",format:"simple",operand:e,clauses:t,else:r.value}},Yt=function(e){return{type:"case_expression",format:"searched",clauses:e,else:null}},Gt=function(e,t){return{type:"case_expression",format:"searched",clauses:e,else:t.value}},qt=function(e,t){return{type:"when_clause",operand:e,value:t}},Qt=function(e){return{type:"else_clause",value:e}},Zt=function(e){return{type:"number",value:e}},Xt=function(e,t,r){return parseFloat(e+t+r)},Jt=function(e,t){return parseFloat(e+t)},Ht=function(e,t){return parseFloat(e+t)},Wt=function(e){return parseFloat(e)},Kt=function(e,t){return e[0]+t},$t=".",er=n(".",!1),tr=function(e){return"."+(null!=e?e:"")},rr=function(e,t){return e+t},nr=function(e){return e.join("")},ir=/^[0-9]/,or=i([["0","9"]],!1,!1),sr=/^[eE]/,ar=i(["e","E"],!1,!1),ur=/^[+\-]/,lr=i(["+","-"],!1,!1),cr=function(e,t){return"e"+(null===t?"":t)},fr="null",hr=n("NULL",!0),dr="true",pr=n("TRUE",!0),vr="false",yr=n("FALSE",!0),mr="in",gr=n("IN",!0),xr=function(){return"IN"},br="is",_r=n("IS",!0),Ir=function(){return"IS"},Cr="like",wr=n("LIKE",!0),Tr=function(){return"LIKE"},Pr="escape",Sr=n("ESCAPE",!0),Ar=function(){return"ESCAPE"},Mr="not",Er=n("NOT",!0),Br=function(){return"NOT"},Dr="and",Nr=n("AND",!0),Vr=function(){return"AND"},Fr="or",Or=n("OR",!0),zr=function(){return"OR"},Lr="between",jr=n("BETWEEN",!0),Rr=function(){return"BETWEEN"},kr="from",Ur=n("FROM",!0),Yr=function(){return"FROM"},Gr="for",qr=n("FOR",!0),Qr=function(){return"FOR"},Zr="substring",Xr=n("SUBSTRING",!0),Jr=function(){return"SUBSTRING"},Hr="extract",Wr=n("EXTRACT",!0),Kr=function(){return"EXTRACT"},$r="trim",en=n("TRIM",!0),tn=function(){return"TRIM"},rn="position",nn=n("POSITION",!0),on=function(){return"POSITION"},sn="timestamp",an=n("TIMESTAMP",!0),un=function(){return"TIMESTAMP"},ln="date",cn=n("DATE",!0),fn=function(){return"DATE"},hn="leading",dn=n("LEADING",!0),pn=function(){return"LEADING"},vn="trailing",yn=n("TRAILING",!0),mn=function(){return"TRAILING"},gn="both",xn=n("BOTH",!0),bn=function(){return"BOTH"},_n="year",In=n("YEAR",!0),Cn=function(){return"YEAR"},wn="month",Tn=n("MONTH",!0),Pn=function(){return"MONTH"},Sn="day",An=n("DAY",!0),Mn=function(){return"DAY"},En="hour",Bn=n("HOUR",!0),Dn=function(){return"HOUR"},Nn="minute",Vn=n("MINUTE",!0),Fn=function(){return"MINUTE"},On="second",zn=n("SECOND",!0),Ln=function(){return"SECOND"},jn="case",Rn=n("CASE",!0),kn=function(){return"CASE"},Un="end",Yn=n("END",!0),Gn=function(){return"END"},qn="when",Qn=n("WHEN",!0),Zn=function(){return"WHEN"},Xn="then",Jn=n("THEN",!0),Hn=function(){return"THEN"},Wn="else",Kn=n("ELSE",!0),$n=function(){return"ELSE"},ei=",",ti=n(",",!1),ri="(",ni=n("(",!1),ii=")",oi=n(")",!1),si=/^[ \t\n\r]/,ai=i([" ","\t","\n","\r"],!1,!1),ui="`",li=n("`",!1),ci=/^[^`]/,fi=i(["`"],!0,!1),hi=function(e){return e.join("")},di=0,pi=[{line:1,column:1}],vi=0,yi=[],mi=0;if("startRule"in r){if(!(r.startRule in ge))throw new Error("Can't start parsing from rule \""+r.startRule+'".');xe=ge[r.startRule]}if((ye=xe())!==me&&di===t.length)return ye;throw ye!==me&&di<t.length&&a({type:"end"}),function(t,r,n){return new e(e.buildMessage(t,r),t,r,n)}(yi,vi<t.length?t.charAt(vi):null,vi<t.length?s(vi,vi+1):s(vi,vi))}}}.apply(null,[]))||(e.exports=n)},1802:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(38),r(518),r(93),r(1636)],void 0===(i=function(e,t,r,n,i,o){function s(e,t,i){var o,s,a,u=r.vec3f64.create(),l=e[3],c=Math.ceil(Math.log(l)*Math.LOG2E/h),d=Math.pow(2,c*h+f);if(i.isGeographic){var p=d/n.earthRadius*180/Math.PI;s=Math.round(e[1]/p);var v=Math.max(-90,Math.min(90,s*p)),y=p/Math.cos((Math.abs(v)-p/2)/180*Math.PI),m=(o=Math.round(e[0]/y))*y;u[0]=m,u[1]=v}else o=Math.round(e[0]/d),s=Math.round(e[1]/d),u[0]=o*d,u[1]=s*d;var g=e[2]+t;return a=Math.round(g/d),u[2]=a*d,{center:u,id:c+"_"+o+"_"+s+"_"+a}}Object.defineProperty(t,"__esModule",{value:!0});var a=1e3,u=new Float64Array(3*a),l=r.vec3f64.create(),c=r.mat4f64.create();t.computeGlobalTransformation=function(e,t,n,o){var a=s(e,t,n).center,u=r.mat4f64.create();return i.computeLinearTransformation(n,a,u,o),u},t.reprojectPoints=function(e,t,n,o,s,f,h){var d=e.data,p=e.offsetIdx,v=e.strideIdx;r.mat4.invert(c,n),r.vec3.copy(l,t),l[2]+=o;var y=[0,0,0],m=d.length/v;i.vectorToVector(l,s,y,f);for(var g=0;g<m;g+=a){for(var x=Math.min(a,m-g),b=0;b<x;b++){var _=p+v*(g+b);u[3*b]=d[_]+y[0],u[3*b+1]=d[_+1]+y[1],u[3*b+2]=d[_+2]+y[2]}for(i.bufferToBuffer(u,f,0,u,h,0,x),b=0;b<x;b++){var I=u[3*b],C=u[3*b+1],w=u[3*b+2],T=p+v*(g+b);d[T]=c[0]*I+c[4]*C+c[8]*w+c[12],d[T+1]=c[1]*I+c[5]*C+c[9]*w+c[13],d[T+2]=c[2]*I+c[6]*C+c[10]*w+c[14]}}},t.createOrigin=function(e,t,r,n){var a=s(e,t,r),u=a.center,l=a.id;return i.vectorToVector(u,r,u,n),o.fromVector(u,l)};var f=1,h=5-f}.apply(null,n))||(e.exports=i)},1826:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(514),r(19),r(1749),r(1745),r(1750),r(138)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l){Object.defineProperty(t,"__esModule",{value:!0});var c={added:[],removed:[]},f=new i.default,h=new l(0,0,0,0),d=function(e){function t(t){var r=e.call(this)||this;return r._tiles=new Map,r._index=s(9,o("csp-restrictions")?function(e){return{minX:e.bounds[0],minY:e.bounds[1],maxX:e.bounds[2],maxY:e.bounds[3]}}:[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),r.tiles=[],r.tileScheme=t,r}return r(t,e),t.prototype.destroy=function(){this._tiles.clear()},t.prototype.has=function(e){return this._tiles.has(e)},t.prototype.get=function(e){return this._tiles.get(e)},t.prototype.findByKey=function(e){return this._tiles.get(e.id)},t.prototype.intersections=function(e,t){var r="string"==typeof e?this.get(e):e;if(!r)return[];for(var n=t*r.resolution,i=r.bounds[0]-n,o=r.bounds[1]-n,s=r.bounds[2]+n,a=r.bounds[3]+n,u=[],l=0,c=this._index.search({minX:i,minY:o,maxX:s,maxY:a});l<c.length;l++){var f=c[l],h=f.bounds.slice();h[0]=Math.max(h[0],i),h[1]=Math.max(h[1],o),h[2]=Math.min(h[2],s),h[3]=Math.min(h[3],a),h[2]-h[0]>0&&h[3]-h[1]>0&&u.push({bounds:h,tile:f})}return u},t.prototype.boundsIntersections=function(e){return this._index.search({minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]})},t.prototype.setViewState=function(e){var t=this.tileScheme.getTileCoverage(e,0);if(t){var r=t.spans,n=t.lodInfo,i=n.level;if(r.length>0)for(var o=0,s=r;o<s.length;o++)for(var u=s[o],l=u.row,d=u.colFrom,p=u.colTo,v=d;v<=p;v++){var y=h.set(i,l,n.normalizeCol(v),n.getWorldForColumn(v)).id;if(f.add(y),!this.has(y)){var m=new a.default(this.tileScheme,y);this._tiles.set(y,m),this._index.insert(m),this.tiles.push(m),c.added.push(m)}}for(var g=this.tiles.length-1;g>=0;g--){m=this.tiles[g];f.has(m.id)||(this._tiles.delete(m.id),this.tiles.splice(g,1),this._index.remove(m),c.removed.push(m))}(c.added.length||c.removed.length)&&this.emit("update",c),f.clear(),c.added.length=0,c.removed.length=0}},t}(u.default);t.default=d}.apply(null,n))||(e.exports=i)},1827:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(6),r(11),r(5),r(1),r(1980),r(1981),r(1982)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c){var f=o.strict()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks",pointCloudRGBRenderer:"point-cloud-rgb",pointCloudStretchRenderer:"point-cloud-stretch",pointCloudUniqueValueRenderer:"point-cloud-unique-value"}),h=function(e){function t(t){var r=e.call(this)||this;return r.type=void 0,r.pointSizeAlgorithm=null,r.colorModulation=null,r.pointsPerInch=10,r}return r(t,e),t.prototype.clone=function(){return console.warn(".clone() is not implemented for "+this.declaredClass),null},t.prototype.cloneProperties=function(){return{pointSizeAlgorithm:s.clone(this.pointSizeAlgorithm),colorModulation:s.clone(this.colorModulation),pointsPerInch:s.clone(this.pointsPerInch)}},n([a.property({type:f.apiValues,readOnly:!0,nonNullable:!0,json:{type:f.jsonValues,read:!1,write:f.write}})],t.prototype,"type",void 0),n([a.property({types:c.pointSizeAlgorithmTypes,json:{read:l.read,write:!0}})],t.prototype,"pointSizeAlgorithm",void 0),n([a.property({type:u.default,json:{write:!0}})],t.prototype,"colorModulation",void 0),n([a.property({json:{write:!0},nonNullable:!0,type:Number})],t.prototype,"pointsPerInch",void 0),n([a.subclass("esri.renderers.PointCloudRenderer")],t)}(a.declared(i));return(h||(h={})).fieldTransformTypeKebabDict=o({none:"none",lowFourBit:"low-four-bit",highFourBit:"high-four-bit",absoluteValue:"absolute-value",moduloTen:"modulo-ten"}),h}.apply(null,n))||(e.exports=i)},1851:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1726)],void 0===(i=function(e,t,r){return function(){function e(e,t,r,n,i,o,s,a){this._glyphItems=e,this._maxWidth=t,this._lineHeight=r,this._letterSpacing=n,this._offset=i,this._hAnchor=o,this._vAnchor=s,this._justify=a}return e.prototype.getShaping=function(e,t){for(var r=this._letterSpacing,n=this._lineHeight,i=this._justify,o=this._maxWidth,s=[],a=0,u=0,l=0,c=0,f=-1,h=0,d=-1,p=e.length,v=0;v<p;v++){var y=e.charCodeAt(v);if(10!==y){for(var m=void 0,g=0,x=this._glyphItems;g<x.length&&!(m=x[g][y]);g++);if(m){if(s.push({codePoint:y,x:a,y:u,glyphMosaicItem:m}),a+=m.metrics.advance+r,0<o&&o<a&&0<=d){var b=d+1;I=s[b].x,h=Math.max(I,h);for(var _=b;_<s.length;_++)t?s[_].y-=n:s[_].y+=n,s[_].x-=I;i&&this._applyJustification(s,c,d),t?u-=n:u+=n,a-=I,++l,c=b,d=-1}++f,32===y&&(d=s.length-1)}}else{if(v===p-1)continue;if(c<=f){var I=(C=s[f]).x+C.glyphMosaicItem.metrics.advance;h=Math.max(I,h),i&&this._applyJustification(s,c,f),c=s.length}t?u-=n:u+=n,a=0,++l}}if(c<=f){var C,w=(C=s[f]).x+C.glyphMosaicItem.metrics.advance;h=Math.max(h,w),i&&this._applyJustification(s,c,f)}if(0<s.length){var T=(i-this._hAnchor)*h,P=(-this._vAnchor*(l+1)+.5)*n;t&&l&&(P+=l*n),T+=this._offset[0],P+=this._offset[1];for(var S=0,A=s;S<A.length;S++){var M=A[S];M.x+=T,M.y+=P}}return s},e.getBox=function(e){if(!e.length)return null;for(var t=1/0,r=1/0,n=0,i=0,o=0,s=e;o<s.length;o++){var a=s[o],u=a.glyphMosaicItem.metrics,l=u.height,c=u.left,f=u.top,h=u.width,d=a.x,p=a.y-(l-Math.abs(f)),v=d+h+c,y=p+l;t=Math.min(t,d),n=Math.max(n,v),r=Math.min(r,p),i=Math.max(i,y)}return{x:t,y:r,width:n-t,height:i-r}},e.addDecoration=function(e,t){var n=e.length;if(0!==n){for(var i=e[0].x+e[0].glyphMosaicItem.metrics.left,o=e[0].y,s=1;s<n;s++){var a=e[s];if(a.y!==o){var u=e[s-1].x+e[s-1].glyphMosaicItem.metrics.left+e[s-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:i,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:u-i,height:8,left:0,top:0,advance:0},page:0}}),o=a.y,i=a.x+a.glyphMosaicItem.metrics.left}}var l=e[n-1].x+e[n-1].glyphMosaicItem.metrics.left+e[n-1].glyphMosaicItem.metrics.width;e.push({codePoint:0,x:i,y:o+t-3,glyphMosaicItem:{rect:new r(4,0,4,8),metrics:{width:l-i,height:8,left:0,top:0,advance:0},page:0}})}},e.prototype._applyJustification=function(e,t,r){for(var n=e[r],i=n.glyphMosaicItem.metrics.advance,o=(n.x+i)*this._justify,s=t;s<=r;s++)e[s].x-=o},e}()}.apply(null,n))||(e.exports=i)},1852:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){var r,n,i,o;Object.defineProperty(t,"__esModule",{value:!0}),(n=r=t.VectorRole||(t.VectorRole={}))[n.ENTRY=1]="ENTRY",n[n.EXIT=2]="EXIT",n[n.CAP=3]="CAP",(o=i=t.CapPosition||(t.CapPosition={}))[o.START=1]="START",o[o.END=2]="END",t.SYSTEM_MAG_LIMIT=3.8,t.MITER_SAFE_RADS=2*Math.acos(1/t.SYSTEM_MAG_LIMIT);var s=t.SYSTEM_MAG_LIMIT*t.SYSTEM_MAG_LIMIT,a=-1,u=8/(2*Math.PI);function l(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push(void 0);return r}t.allocTriangles=function(e){var t,r={items:new Array,count:0};for(t=0;t<e;++t)r.items.push({v1:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v2:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]},v3:{vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]}});return r},t.allocExtrudeVectors=function(){var e=function(e){var t,r={items:new Array,count:0};for(t=0;t<30;++t)r.items.push({vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0]});return r}(),t={};return t[r.ENTRY]=l(20),t[r.EXIT]=l(20),t[r.CAP]=l(20),{vectors:e,lists:t}},t.copyExtrudeVectors=function(e,t){var n;for(n=0;n<t.vectors.count;++n)e.vectors.items[n].vector[0]=t.vectors.items[n].vector[0],e.vectors.items[n].vector[1]=t.vectors.items[n].vector[1],e.vectors.items[n].texCoords[0]=t.vectors.items[n].texCoords[0],e.vectors.items[n].texCoords[1]=t.vectors.items[n].texCoords[1],e.vectors.items[n].direction[0]=t.vectors.items[n].direction[0],e.vectors.items[n].direction[1]=t.vectors.items[n].direction[1],e.vectors.items[n].base=t.vectors.items[n].base;e.vectors.count=t.vectors.count;var i=t.lists[r.ENTRY],o=e.lists[r.ENTRY],s=t.lists[r.EXIT],a=e.lists[r.EXIT],u=t.lists[r.CAP],l=e.lists[r.CAP];for(n=0;n<i.count;++n)o.items[n]=i.items[n];for(o.count=i.count,n=0;n<s.count;++n)a.items[n]=s.items[n];for(a.count=s.count,n=0;n<u.count;++n)l.items[n]=u.items[n];l.count=u.count,e.capCenter=t.capCenter};var c={vector:[void 0,void 0],texCoords:[void 0,void 0],direction:[void 0,void 0],base:void 0};function f(e,t){c.vector[0]=e.vector[0],c.vector[1]=e.vector[1],c.texCoords[0]=e.texCoords[0],c.texCoords[1]=e.texCoords[1],c.direction[0]=e.direction[0],c.direction[1]=e.direction[1],c.base=e.base,e.vector[0]=t.vector[0],e.vector[1]=t.vector[1],e.texCoords[0]=t.texCoords[0],e.texCoords[1]=t.texCoords[1],e.direction[0]=t.direction[0],e.direction[1]=t.direction[1],e.base=t.base,t.vector[0]=c.vector[0],t.vector[1]=c.vector[1],t.texCoords[0]=c.texCoords[0],t.texCoords[1]=c.texCoords[1],t.direction[0]=c.direction[0],t.direction[1]=c.direction[1],t.base=c.base}t.swapExtrudeVectors=f;var h,d=[];for(h=0;h<32;++h)d.push([void 0,void 0]);var p=function(e){var t,r={items:new Array,count:0};for(t=0;t<8;++t)r.items.push([void 0,void 0]);return r}();function v(e,t){return e[0]*t[0]+e[1]*t[1]}function y(e){return Math.sqrt(v(e,e))}function m(e,t){var r=y(t);return e[0]=t[0]/r,e[1]=t[1]/r,e}function g(e,t){return e[0]=-t[1],e[1]=t[0],e}function x(e,t){return e[0]*t[1]-e[1]*t[0]}function b(e,t){return e[0]=-t[0],e[1]=-t[1],e}function _(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function I(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function C(e,t,r){return n=e,o=r,((i=t)[0]-n[0])*(o[1]-n[1])-(o[0]-n[0])*(i[1]-n[1])<0;var n,i,o}function w(e,t){var r=v(e,t);return.999<r?0:r<-.999?Math.PI:Math.acos(r)}function T(e,t,r,n,i){if(0!==n){var o,s=y(t),a=(i?-1:1)*w(_(d[0],t,1/s),_(d[1],r,1/s))/n,u=Math.cos(a),l=Math.sin(a),c=t[0],f=t[1];for(o=0;o<n-1;++o){var h=c;c=u*h-l*f,f=l*h+u*f,e.items[o][0]=c,e.items[o][1]=f}e.count=n-1}else e.count=0}function P(e){var t,r=e.count,n=Math.floor(r/2);for(t=0;t<n;++t){var i=e.items[t];e.items[t]=e.items[r-t-1],e.items[r-t-1]=i}}t.length=y,t.normalize=m,t.getNumberOfSlices=function(e){return Math.max(Math.round(e*u),1)},t.getRads=w,t.reverse=P;var S=[void 0,void 0],A=[void 0,void 0],M=[0,0],E=[0,0],B=[0,0],D=[0,0],N=Math.cos(Math.PI/4),V=Math.sin(Math.PI/4),F=Math.sqrt(2),O=function(){function e(e){this._distanceAlongCorrection=e.distanceAlongCorrection}return e.prototype.bridge=function(e,t,n){var i,o,s,a,u=t.vectors,l=t.lists[r.EXIT],c=n.vectors,h=n.lists[r.ENTRY];if(l.count===h.count+1)i=l.items,o=u.items,s=h.items,a=c.items;else if(h.count===l.count+1)i=h.items,o=c.items,s=l.items,a=u.items;else{if(l.count!==h.count)return console.error("Cannot bridge "+l.count+" to "+h.count+"."),void(e.count=0);i=h.items,o=c.items,s=l.items,a=u.items}var d,p=l.count+h.count-2;for(e.count=p,S[0]=i,S[1]=s,A[0]=o,A[1]=a,d=0;d<p;++d){var v=e.items[d],y=(d+0)%2,m=Math.floor((d+0)/2),g=A[y][S[y][m]];v.v1.vector[0]=g.vector[0],v.v1.vector[1]=g.vector[1],v.v1.texCoords[0]=g.texCoords[0],v.v1.texCoords[1]=g.texCoords[1],v.v1.direction[0]=g.direction[0],v.v1.direction[1]=g.direction[1],v.v1.base=g.base;var x=(d+1)%2,b=Math.floor((d+1)/2),_=A[x][S[x][b]];v.v2.vector[0]=_.vector[0],v.v2.vector[1]=_.vector[1],v.v2.texCoords[0]=_.texCoords[0],v.v2.texCoords[1]=_.texCoords[1],v.v2.direction[0]=_.direction[0],v.v2.direction[1]=_.direction[1],v.v2.base=_.base;var I=(d+2)%2,w=Math.floor((d+2)/2),T=A[I][S[I][w]];v.v3.vector[0]=T.vector[0],v.v3.vector[1]=T.vector[1],v.v3.texCoords[0]=T.texCoords[0],v.v3.texCoords[1]=T.texCoords[1],v.v3.direction[0]=T.direction[0],v.v3.direction[1]=T.direction[1],v.v3.base=T.base;var P=v.v1.base&&v.v1.base.point||M,N=v.v2.base&&v.v2.base.point||M,V=v.v3.base&&v.v3.base.point||M;E[0]=P[0]+v.v1.vector[0],E[1]=P[1]+v.v1.vector[1],B[0]=N[0]+v.v2.vector[0],B[1]=N[1]+v.v2.vector[1],D[0]=V[0]+v.v3.vector[0],D[1]=V[1]+v.v3.vector[1],C(E,B,D)||f(v.v2,v.v3)}},e.prototype.pie=function(e,t){if(0!==t.lists[r.CAP].count){if(1===t.lists[r.CAP].count)return console.error("A single vector is not enough to define a pie."),void(e.count=0);var n;for(e.count=t.lists[r.CAP].count-1,n=0;n<e.count;++n){var i=e.items[n],o=t.lists[r.CAP].items[n],s=t.vectors.items[o];i.v1.vector[0]=s.vector[0],i.v1.vector[1]=s.vector[1],i.v1.texCoords[0]=s.texCoords[0],i.v1.texCoords[1]=s.texCoords[1],i.v1.direction[0]=s.direction[0],i.v1.direction[1]=s.direction[1],i.v1.base=s.base;var a=t.lists[r.CAP].items[n+1],u=t.vectors.items[a];i.v2.vector[0]=u.vector[0],i.v2.vector[1]=u.vector[1],i.v2.texCoords[0]=u.texCoords[0],i.v2.texCoords[1]=u.texCoords[1],i.v2.direction[0]=u.direction[0],i.v2.direction[1]=u.direction[1],i.v2.base=u.base;var l=t.capCenter,c=t.vectors.items[l];i.v3.vector[0]=c.vector[0],i.v3.vector[1]=c.vector[1],i.v3.texCoords[0]=c.texCoords[0],i.v3.texCoords[1]=c.texCoords[1],i.v3.direction[0]=c.direction[0],i.v3.direction[1]=c.direction[1],i.v3.base=c.base;var h=i.v1.base&&i.v1.base.point||M,d=i.v2.base&&i.v2.base.point||M,p=i.v3.base&&i.v3.base.point||M;E[0]=h[0]+i.v1.vector[0],E[1]=h[1]+i.v1.vector[1],B[0]=d[0]+i.v2.vector[0],B[1]=d[1]+i.v2.vector[1],D[0]=p[0]+i.v3.vector[0],D[1]=p[1]+i.v3.vector[1],C(E,B,D)||f(i.v2,i.v3)}}else e.count=0},e.prototype.buttCap=function(e,t,r){this.fastMiterJoin(e,t,r)},e.prototype.roundCap=function(e,t,n,o,s,a){void 0===a&&(a=0),this.fastMiterJoin(e,t,n);var u=o===i.START?0:1,l=o===i.START?1:0;e.capCenter=e.vectors.count;var c=e.vectors.items[e.capCenter];c.vector[0]=0,c.vector[1]=0,c.texCoords[0]=0,c.texCoords[1]=0,c.direction[0]=0,c.direction[1]=0,++e.vectors.count,T(p,e.vectors.items[u].vector,e.vectors.items[l].vector,s,!1);var f=e.vectors.count,h=e.lists[r.CAP];h.items[0]=u;var d,v=e.vectors.items[u].texCoords[1],y=e.vectors.items[l].texCoords[1];for(d=0;d<p.count;++d){var m=a*(1-Math.abs(p.count/2-d)/(p.count/2)),g=v+d/(p.count-1)*(y-v),x=p.items[d],b=e.vectors.items[f+d];b.vector[0]=x[0],b.vector[1]=x[1],b.texCoords[0]=m,b.texCoords[1]=g,b.direction[0]=0,b.direction[1]=0,h.items[d+1]=f+d}h.items[p.count+1]=l,h.count=p.count+2,e.vectors.count=f+p.count},e.prototype.squareCap=function(e,t,r,n){this.fastMiterJoin(e,t,r);var o=n===i.START?0:1,s=n===i.START?1:0,a=d[0],u=d[1],l=d[2],c=d[3],f=d[4],h=e.vectors.items[o].vector;a[0]=N*h[0]-V*h[1],a[1]=V*h[0]+N*h[1],_(c,a,F),u[0]=N*a[0]-V*a[1],u[1]=V*a[0]+N*a[1],l[0]=N*u[0]-V*u[1],l[1]=V*u[0]+N*u[1],_(f,l,F);var p=e.vectors.items[o];p.vector[0]=c[0],p.vector[1]=c[1];var v=e.vectors.items[s];v.vector[0]=f[0],v.vector[1]=f[1]},e.prototype.squareCapForDashedLines=function(e,t,n,o){if(o===i.START){var s=g(d[0],n),a=b(d[4],s),u=d[1],l=d[2],c=d[3];u[0]=N*s[0]-V*s[1],u[1]=V*s[0]+N*s[1],l[0]=N*u[0]-V*u[1],l[1]=V*u[0]+N*u[1],c[0]=N*l[0]-V*l[1],c[1]=V*l[0]+N*l[1],(f=d[5])[0]=0,f[1]=0,e.capCenter=0,(h=e.vectors.items)[0].vector[0]=f[0],h[0].vector[1]=f[1],h[0].direction[0]=0,h[0].direction[1]=0,h[0].texCoords[0]=0,h[0].texCoords[1]=0,h[1].vector[0]=s[0],h[1].vector[1]=s[1],h[1].direction[0]=0,h[1].direction[1]=0,h[1].texCoords[0]=0,h[1].texCoords[1]=-1,h[2].vector[0]=u[0]*F,h[2].vector[1]=u[1]*F,h[2].direction[0]=0,h[2].direction[1]=0,h[2].texCoords[0]=-1,h[2].texCoords[1]=-1,h[3].vector[0]=c[0]*F,h[3].vector[1]=c[1]*F,h[3].direction[0]=0,h[3].direction[1]=0,h[3].texCoords[0]=-1,h[3].texCoords[1]=1,h[4].vector[0]=a[0],h[4].vector[1]=a[1],h[4].direction[0]=0,h[4].direction[1]=0,h[4].texCoords[0]=0,h[4].texCoords[1]=1,e.vectors.count=5,e.lists[r.CAP].count=4,e.lists[r.CAP].items[0]=1,e.lists[r.CAP].items[1]=2,e.lists[r.CAP].items[2]=3,e.lists[r.CAP].items[3]=4,e.lists[r.ENTRY].count=0,e.lists[r.EXIT].count=3,e.lists[r.EXIT].items[0]=1,e.lists[r.EXIT].items[1]=0,e.lists[r.EXIT].items[2]=4}else{var f,h;s=g(d[0],n),a=b(d[4],s),u=d[1],l=d[2],c=d[3],u[0]=N*a[0]-V*a[1],u[1]=V*a[0]+N*a[1],l[0]=N*u[0]-V*u[1],l[1]=V*u[0]+N*u[1],c[0]=N*l[0]-V*l[1],c[1]=V*l[0]+N*l[1],(f=d[5])[0]=0,f[1]=0,e.capCenter=0,(h=e.vectors.items)[0].vector[0]=f[0],h[0].vector[1]=f[1],h[0].direction[0]=0,h[0].direction[1]=0,h[0].texCoords[0]=0,h[0].texCoords[1]=0,h[1].vector[0]=a[0],h[1].vector[1]=a[1],h[1].direction[0]=0,h[1].direction[1]=0,h[1].texCoords[0]=0,h[1].texCoords[1]=1,h[2].vector[0]=u[0]*F,h[2].vector[1]=u[1]*F,h[2].direction[0]=0,h[2].direction[1]=0,h[2].texCoords[0]=1,h[2].texCoords[1]=1,h[3].vector[0]=c[0]*F,h[3].vector[1]=c[1]*F,h[3].direction[0]=0,h[3].direction[1]=0,h[3].texCoords[0]=1,h[3].texCoords[1]=-1,h[4].vector[0]=s[0],h[4].vector[1]=s[1],h[4].direction[0]=0,h[4].direction[1]=0,h[4].texCoords[0]=0,h[4].texCoords[1]=-1,e.vectors.count=5,e.lists[r.CAP].count=4,e.lists[r.CAP].items[0]=1,e.lists[r.CAP].items[1]=2,e.lists[r.CAP].items[2]=3,e.lists[r.CAP].items[3]=4,e.lists[r.ENTRY].count=3,e.lists[r.ENTRY].items[0]=4,e.lists[r.ENTRY].items[1]=0,e.lists[r.ENTRY].items[2]=1,e.lists[r.EXIT].count=0}},e.prototype.fastMiterJoin=function(e,t,n){var i=g(d[0],n),o=i,s=b(d[1],i),u=e.vectors.items[0];u.vector[0]=o[0],u.vector[1]=o[1],u.texCoords[0]=0,u.texCoords[1]=a,u.direction[0]=0,u.direction[1]=0;var l=e.vectors.items[1];l.vector[0]=s[0],l.vector[1]=s[1],l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0,e.vectors.count=2;var c=e.lists[r.ENTRY];c.items[0]=0,c.items[1]=1,c.count=2;var f=e.lists[r.EXIT];f.items[0]=0,f.items[1]=1,f.count=2,e.lists[r.CAP].count=0,e.capCenter=void 0},e.prototype.miterJoin=function(e,t,n){var i=g(d[0],t),o=g(d[1],n),s=d[2];s[0]=i[0]+o[0],s[1]=i[1]+o[1];var u=m(d[3],s),l=v(u,i);u=_(d[4],u,1/l);var c=b(d[5],u);if(this._distanceAlongCorrection){(p=e.vectors.items[0]).vector[0]=u[0],p.vector[1]=u[1],p.texCoords[0]=0,p.texCoords[1]=a,p.direction[0]=t[0],p.direction[1]=t[1],(y=e.vectors.items[1]).vector[0]=c[0],y.vector[1]=c[1],y.texCoords[0]=0,y.texCoords[1]=1,y.direction[0]=t[0],y.direction[1]=t[1];var f=e.vectors.items[2];f.vector[0]=u[0],f.vector[1]=u[1],f.texCoords[0]=0,f.texCoords[1]=a,f.direction[0]=n[0],f.direction[1]=n[1];var h=e.vectors.items[3];h.vector[0]=c[0],h.vector[1]=c[1],h.texCoords[0]=0,h.texCoords[1]=1,h.direction[0]=n[0],h.direction[1]=n[1],e.vectors.count=4,(x=e.lists[r.ENTRY]).items[0]=0,x.items[1]=1,x.count=2,(I=e.lists[r.EXIT]).items[0]=2,I.items[1]=3,I.count=2}else{var p,y,x,I;(p=e.vectors.items[0]).vector[0]=u[0],p.vector[1]=u[1],p.texCoords[0]=0,p.texCoords[1]=a,p.direction[0]=0,p.direction[1]=0,(y=e.vectors.items[1]).vector[0]=c[0],y.vector[1]=c[1],y.texCoords[0]=0,y.texCoords[1]=1,y.direction[0]=0,y.direction[1]=0,e.vectors.count=2,(x=e.lists[r.ENTRY]).items[0]=0,x.items[1]=1,x.count=2,(I=e.lists[r.EXIT]).items[0]=0,I.items[1]=1,I.count=2}e.lists[r.CAP].count=0,e.capCenter=void 0},e.prototype.bevelJoin=function(e,t,n,i){var o=i*i,u=x(t,n),l=0<u?[a,1]:[1,a],c=l[0],f=l[1],h=0<u?b(d[0],g(d[1],t)):g(d[2],t),p=0<u?b(d[3],g(d[4],n)):g(d[5],n),y=d[6];y[0]=h[0]+p[0],y[1]=h[1]+p[1];var C=m(d[7],y),w=b(d[8],C),T=v(C,h),S=x(C,h),A=Math.abs(S/T),M=1+A*A,E=M<s?[A,this._distanceAlongCorrection]:[Math.sqrt(s-1),!0],B=E[0],D=E[1],N=M<o?[A,this._distanceAlongCorrection]:[Math.sqrt(o-1),!0],V=N[0],F=N[1];if(F&&D){I((R=e.vectors.items[0]).vector,b(d[9],h),_(d[10],b(d[11],t),B)),R.texCoords[0]=0,R.texCoords[1]=c,R.direction[0]=this._distanceAlongCorrection?t[0]:0,R.direction[1]=this._distanceAlongCorrection?t[1]:0,I((k=e.vectors.items[1]).vector,b(d[12],p),_(d[13],n,B)),k.texCoords[0]=0,k.texCoords[1]=c,k.direction[0]=this._distanceAlongCorrection?n[0]:0,k.direction[1]=this._distanceAlongCorrection?n[1]:0,(z=e.vectors.items[2]).vector[0]=0,z.vector[1]=0,z.texCoords[0]=0,z.texCoords[1]=0,z.direction[0]=0,z.direction[1]=0,I((L=e.vectors.items[3]).vector,h,_(d[14],t,V)),L.texCoords[0]=0,L.texCoords[1]=f,L.direction[0]=this._distanceAlongCorrection?t[0]:0,L.direction[1]=this._distanceAlongCorrection?t[1]:0;var O=e.vectors.items[4];I(O.vector,p,_(d[15],b(d[16],n),V)),O.texCoords[0]=0,O.texCoords[1]=f,O.direction[0]=this._distanceAlongCorrection?n[0]:0,O.direction[1]=this._distanceAlongCorrection?n[1]:0,e.vectors.count=5,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=2,U.items[2]=3,U.count=3,(Y=e.lists[r.EXIT]).items[0]=1,Y.items[1]=2,Y.items[2]=4,Y.count=3,M<o?((j=e.lists[r.CAP]).count=0,e.capCenter=void 0):((j=e.lists[r.CAP]).items[0]=3,j.items[1]=4,j.count=2,e.capCenter=2)}else if(!F&&D)I((R=e.vectors.items[0]).vector,b(d[9],h),_(d[10],b(d[11],t),B)),R.texCoords[0]=0,R.texCoords[1]=c,R.direction[0]=this._distanceAlongCorrection?t[0]:0,R.direction[1]=this._distanceAlongCorrection?t[1]:0,I((k=e.vectors.items[1]).vector,b(d[12],p),_(d[13],n,B)),k.texCoords[0]=0,k.texCoords[1]=c,k.direction[0]=this._distanceAlongCorrection?n[0]:0,k.direction[1]=this._distanceAlongCorrection?n[1]:0,(z=e.vectors.items[2]).vector[0]=0,z.vector[1]=0,z.texCoords[0]=0,z.texCoords[1]=0,z.direction[0]=0,z.direction[1]=0,_((L=e.vectors.items[3]).vector,C,1/T),L.texCoords[0]=0,L.texCoords[1]=f,L.direction[0]=0,L.direction[1]=0,e.vectors.count=4,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=2,U.items[2]=3,U.count=3,(Y=e.lists[r.EXIT]).items[0]=1,Y.items[1]=2,Y.items[2]=3,Y.count=3,e.lists[r.CAP].count=0,e.capCenter=void 0;else if(F&&!D){var z,L,j;_((R=e.vectors.items[0]).vector,w,1/T),R.texCoords[0]=0,R.texCoords[1]=c,R.direction[0]=0,R.direction[1]=0,(k=e.vectors.items[1]).vector[0]=0,k.vector[1]=0,k.texCoords[0]=0,k.texCoords[1]=0,k.direction[0]=0,k.direction[1]=0,I((z=e.vectors.items[2]).vector,h,_(d[9],t,V)),z.texCoords[0]=0,z.texCoords[1]=f,z.direction[0]=this._distanceAlongCorrection?t[0]:0,z.direction[1]=this._distanceAlongCorrection?t[1]:0,I((L=e.vectors.items[3]).vector,p,_(d[10],b(d[11],n),V)),L.texCoords[0]=0,L.texCoords[1]=f,L.direction[0]=this._distanceAlongCorrection?n[0]:0,L.direction[1]=this._distanceAlongCorrection?n[1]:0,e.vectors.count=4,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=1,U.items[2]=2,U.count=3,(Y=e.lists[r.EXIT]).items[0]=0,Y.items[1]=1,Y.items[2]=3,Y.count=3,M<o?((j=e.lists[r.CAP]).count=0,e.capCenter=void 0):((j=e.lists[r.CAP]).items[0]=2,j.items[1]=3,j.count=2,e.capCenter=1)}else if(!F&&!D){var R,k,U,Y;_((R=e.vectors.items[0]).vector,w,1/T),R.texCoords[0]=0,R.texCoords[1]=c,R.direction[0]=0,R.direction[1]=0,_((k=e.vectors.items[1]).vector,C,1/T),k.texCoords[0]=0,k.texCoords[1]=f,k.direction[0]=0,k.direction[1]=0,e.vectors.count=2,(U=e.lists[r.ENTRY]).items[0]=0,U.items[1]=1,U.count=2,(Y=e.lists[r.EXIT]).items[0]=0,Y.items[1]=1,Y.count=2,e.lists[r.CAP].count=0,e.capCenter=void 0}u<0&&(P(e.lists[r.ENTRY]),P(e.lists[r.EXIT]))},e.prototype.roundJoin=function(e,t,n,i){var o=x(t,n),u=0<o?[a,1]:[1,a],l=u[0],c=u[1],f=0<o?b(d[0],g(d[1],t)):g(d[2],t),h=0<o?b(d[3],g(d[4],n)):g(d[5],n),y=d[6];y[0]=f[0]+h[0],y[1]=f[1]+h[1];var C=m(d[7],y),w=b(d[8],C),S=v(C,f),A=x(C,f),M=Math.abs(A/S),E=1+M*M<s?[M,this._distanceAlongCorrection]:[Math.sqrt(s-1),!0],B=E[0];if(E[1]){(N=e.vectors.items[0]).vector[0]=f[0],N.vector[1]=f[1],N.texCoords[0]=0,N.texCoords[1]=c,N.direction[0]=0,N.direction[1]=0,(V=e.vectors.items[1]).vector[0]=h[0],V.vector[1]=h[1],V.texCoords[0]=0,V.texCoords[1]=c,V.direction[0]=0,V.direction[1]=0,I((F=e.vectors.items[2]).vector,b(d[9],f),_(d[10],b(d[11],t),B)),F.texCoords[0]=0,F.texCoords[1]=l,F.direction[0]=this._distanceAlongCorrection?t[0]:0,F.direction[1]=this._distanceAlongCorrection?t[1]:0,I((O=e.vectors.items[3]).vector,b(d[12],h),_(d[13],n,B)),O.texCoords[0]=0,O.texCoords[1]=l,O.direction[0]=this._distanceAlongCorrection?n[0]:0,O.direction[1]=this._distanceAlongCorrection?n[1]:0;var D=e.vectors.items[4];D.vector[0]=0,D.vector[1]=0,D.texCoords[0]=0,D.texCoords[1]=0,D.direction[0]=0,D.direction[1]=0,e.vectors.count=5,(z=e.lists[r.ENTRY]).items[0]=2,z.items[1]=4,z.items[2]=0,z.count=3,(L=e.lists[r.EXIT]).items[0]=3,L.items[1]=4,L.items[2]=1,L.count=3,e.capCenter=4}else{var N,V,F,O,z,L;(N=e.vectors.items[0]).vector[0]=f[0],N.vector[1]=f[1],N.texCoords[0]=0,N.texCoords[1]=c,N.direction[0]=0,N.direction[1]=0,(V=e.vectors.items[1]).vector[0]=h[0],V.vector[1]=h[1],V.texCoords[0]=0,V.texCoords[1]=c,V.direction[0]=0,V.direction[1]=0,_((F=e.vectors.items[2]).vector,w,1/S),F.texCoords[0]=0,F.texCoords[1]=l,F.direction[0]=0,F.direction[1]=0,(O=e.vectors.items[3]).vector[0]=0,O.vector[1]=0,O.texCoords[0]=0,O.texCoords[1]=0,O.direction[0]=0,O.direction[1]=0,e.vectors.count=4,(z=e.lists[r.ENTRY]).items[0]=2,z.items[1]=3,z.items[2]=0,z.count=3,(L=e.lists[r.EXIT]).items[0]=2,L.items[1]=3,L.items[2]=1,L.count=3,e.capCenter=3}T(p,f,h,i,o<0);var j,R=e.vectors.count,k=e.lists[r.CAP];for(j=k.items[0]=0;j<p.count;++j){var U=p.items[j],Y=e.vectors.items[R+j];Y.vector[0]=U[0],Y.vector[1]=U[1],Y.texCoords[0]=0,Y.texCoords[1]=c,Y.direction[0]=0,Y.direction[1]=0,k.items[j+1]=R+j}k.items[p.count+1]=1,k.count=p.count+2,e.vectors.count=R+p.count,o<0&&(P(e.lists[r.ENTRY]),P(e.lists[r.EXIT]))},e.prototype.unitRoundJoin=function(e,t,n,i){var o=x(t,n),s=0<o?[a,1]:[1,a],u=s[0],l=s[1],c=0<o?b(d[0],g(d[1],t)):g(d[2],t),f=0<o?b(d[3],g(d[4],n)):g(d[5],n),h=e.vectors.items[0];h.vector[0]=c[0],h.vector[1]=c[1],h.texCoords[0]=0,h.texCoords[1]=l,h.direction[0]=0,h.direction[1]=0;var v=e.vectors.items[1];v.vector[0]=f[0],v.vector[1]=f[1],v.texCoords[0]=0,v.texCoords[1]=l,v.direction[0]=0,v.direction[1]=0;var y=e.vectors.items[2];b(y.vector,c),y.texCoords[0]=0,y.texCoords[1]=u,y.direction[0]=0,y.direction[1]=0;var m=e.vectors.items[3];b(m.vector,f),m.texCoords[0]=0,m.texCoords[1]=u,m.direction[0]=0,m.direction[1]=0;var _=e.vectors.items[4];_.vector[0]=0,_.vector[1]=0,_.texCoords[0]=0,_.texCoords[1]=0,_.direction[0]=0,_.direction[1]=0,e.vectors.count=5;var I=e.lists[r.ENTRY];I.items[0]=2,I.items[1]=0,I.count=2;var C=e.lists[r.EXIT];C.items[0]=3,C.items[1]=1,C.count=2,e.capCenter=4,T(p,c,f,i,o<0);var w,S=e.vectors.count,A=e.lists[r.CAP];for(w=A.items[0]=0;w<p.count;++w){var M=p.items[w],E=e.vectors.items[S+w];E.vector[0]=M[0],E.vector[1]=M[1],E.texCoords[0]=0,E.texCoords[1]=l,E.direction[0]=0,E.direction[1]=0,A.items[w+1]=S+w}A.items[p.count+1]=1,A.count=p.count+2,e.vectors.count=S+p.count,o<0&&(P(e.lists[r.ENTRY]),P(e.lists[r.EXIT]))},e.prototype.rectJoin=function(e,t,n){var i=g(d[0],t),o=g(d[1],n),s=e.vectors.items[0];s.vector[0]=i[0],s.vector[1]=i[1],s.texCoords[0]=0,s.texCoords[1]=a,s.direction[0]=0,s.direction[1]=0;var u=e.vectors.items[1];u.vector[0]=o[0],u.vector[1]=o[1],u.texCoords[0]=0,u.texCoords[1]=a,u.direction[0]=0,u.direction[1]=0;var l=e.vectors.items[2];b(l.vector,i),l.texCoords[0]=0,l.texCoords[1]=1,l.direction[0]=0,l.direction[1]=0;var c=e.vectors.items[3];b(c.vector,o),c.texCoords[0]=0,c.texCoords[1]=1,c.direction[0]=0,c.direction[1]=0,e.vectors.count=4;var f=e.lists[r.ENTRY];f.items[0]=0,f.items[1]=2,f.count=2;var h=e.lists[r.EXIT];h.items[0]=1,h.items[1]=3,h.count=2,e.capCenter=void 0},e}();t.Tessellator=O}.apply(null,n))||(e.exports=i)},1858:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(6),r(11),r(1)],void 0===(i=function(e,t,r,n,i,o,s){Object.defineProperty(t,"__esModule",{value:!0}),t.typeKebabDictionary=o({pointCloudFixedSizeAlgorithm:"fixed-size",pointCloudSplatAlgorithm:"splat"});var a=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return r(i,e),n([s.property({type:t.typeKebabDictionary.apiValues,readOnly:!0,nonNullable:!0,json:{type:t.typeKebabDictionary.jsonValues,read:!1,write:t.typeKebabDictionary.write}})],i.prototype,"type",void 0),n([s.subclass("esri.renderers.support.pointCloud.PointSizeAlgorithm")],i)}(s.declared(i));t.PointSizeAlgorithm=a,t.default=a}.apply(null,n))||(e.exports=i)},1859:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(38),r(1635),r(1828),r(1559)],void 0===(i=function(e,t,r,n,i,o){function s(e,t,r,n,i,o,s){switch(r){case 1:for(var a=0;a<s;a++)n[i]=e[t],t+=1,i+=o;break;case 2:for(a=0;a<s;a++)n[i]=e[t],n[i+1]=e[t+1],t+=2,i+=o;break;case 3:for(a=0;a<s;a++)n[i]=e[t],n[i+1]=e[t+1],n[i+2]=e[t+2],t+=3,i+=o;break;case 4:for(a=0;a<s;a++)n[i]=e[t],n[i+1]=e[t+1],n[i+2]=e[t+2],n[i+3]=e[t+3],t+=4,i+=o;break;default:throw h("Unhandled stride size "+r)}}function a(e,t,r,n,i,o){switch(t){case 1:for(var s=0;s<o;s++)r[n]=e,n+=i;break;case 2:for(s=0;s<o;s++)r[n]=e,r[n+1]=e,n+=i;break;case 3:for(s=0;s<o;s++)r[n]=e,r[n+1]=e,r[n+2]=e,n+=i;break;case 4:for(s=0;s<o;s++)r[n]=e,r[n+1]=e,r[n+2]=e,r[n+3]=e,n+=i;break;default:throw h("Unhandled stride size "+t)}}function u(e){switch(e){case 5120:return Int8Array;case 5126:return Float32Array;case 5124:return Int32Array;case 5122:return Int16Array;case 5121:return Uint8Array;case 5125:return Uint32Array;case 5123:return Uint16Array}throw new Error("Unhandled data type: "+e)}function l(e){switch(e){case 5120:return"Int8";case 5126:return"Float32";case 5124:return"Int32";case 5122:return"Int16";case 5121:return"UInt8";case 5125:return"UInt32";case 5123:return"UInt16"}throw new Error("Unhandled data type: "+e)}function c(e){return e%Uint32Array.BYTES_PER_ELEMENT==0}function f(e){return e>0&&e%Uint32Array.BYTES_PER_ELEMENT==0}function h(e){return new Error("I3SGeometryUtil processing failed: "+e)}function d(e){var t=e.normals,n=e.positions,i=e.normalInd,s=e.positionInd;o.assert(e.normalInd.length===e.positionInd.length);for(var a=r.vec3f32.create(),u=r.vec3f32.create(),l=r.vec2f32.create(),c=n.data,f=n.offsetIdx,h=n.strideIdx,d=t.data,p=t.offsetIdx,v=t.strideIdx,y=0;y<s.length;y+=3){var m=s[y],g=f+h*m,x=c[g],b=c[g+1],_=c[g+2];g=f+h*(m=s[y+1]),a[0]=c[g]-x,a[1]=c[g+1]-b,a[2]=c[g+2]-_,g=f+h*(m=s[y+2]),u[0]=c[g]-x,u[1]=c[g+1]-b,u[2]=c[g+2]-_,r.vec3.cross(a,a,u),o.encodeNormal(a,l);for(var I=0;I<3;I++){var C=p+v*i[y+I];d[C]=o.encodeInt16(l[0]),d[C+1]=o.encodeInt16(l[1])}}}function p(e,t,r){var n=e.length/3,i=t.data,s=t.offsetIdx,a=t.strideIdx;if(null!=r)for(var u=r,l=u[0],c=u[1],f=u[2],h=u[4],d=u[5],p=u[6],v=u[8],y=u[9],x=u[10],b=0;b<n;b++){var _=e[3*b],I=e[3*b+1],C=e[3*b+2];m[0]=l*_+c*I+f*C,m[1]=h*_+d*I+p*C,m[2]=v*_+y*I+x*C,o.encodeNormal(m,g),i[s+b*a]=o.encodeInt16(g[0]),i[s+b*a+1]=o.encodeInt16(g[1])}else for(b=0;b<n;b++)m[0]=e[3*b],m[1]=e[3*b+1],m[2]=e[3*b+2],o.encodeNormal(m,g),i[s+b*a]=o.encodeInt16(g[0]),i[s+b*a+1]=o.encodeInt16(g[1])}Object.defineProperty(t,"__esModule",{value:!0});var v=new Uint8Array(64);t.interleaveGeometryBuffer=function(e,t,r,n,i){void 0===n&&(n=[]),void 0===i&&(i=[]);var o=e.params.vertexAttributes,d=o.position.count;if(!f(r[0].stride))throw h("Layout stride must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");for(var p=r[0].stride/Uint32Array.BYTES_PER_ELEMENT,y=new Uint32Array(p*d),m=0,g=r=r.slice(0).sort(function(e,t){return e.offset-t.offset});m<g.length;m++)!function(e){if(-1!==i.indexOf(e.name))return"continue";var r=o[e.name],p=u(e.type),m=void 0,g=!1;if(null==r){var x=n.filter(function(t){return t.name===e.name})[0];if(!x)throw h("Geometry definition is missing attribute");r={valueType:l(e.type),byteOffset:0,count:d,valuesPerElement:e.count};for(var b=0;b<v.length;b++)v[b]=x.byteValue;m=v.buffer,g=!0}else m=t;if(l(e.type)!==r.valueType)throw h("Geometry definition type must match attribute type");if(!c(r.byteOffset)||!c(e.offset))throw h(e.name+" offset must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");if(!f(r.valuesPerElement*p.BYTES_PER_ELEMENT)||!f(e.count*p.BYTES_PER_ELEMENT))throw h(e.name+" data must use "+Uint32Array.BYTES_PER_ELEMENT+"-byte words");var _=new Uint32Array(m),I=r.byteOffset/Uint32Array.BYTES_PER_ELEMENT,C=r.valuesPerElement*p.BYTES_PER_ELEMENT/Uint32Array.BYTES_PER_ELEMENT,w=e.offset/Uint32Array.BYTES_PER_ELEMENT,T=e.stride/Uint32Array.BYTES_PER_ELEMENT;g?a(_[0],C,y,w,T,d):s(_,I,C,y,w,T,d)}(g[m]);return y.buffer},t.processAndInterleaveNormals=function(e,t,r,i,o){if("none"===e)d(o);else{var s=n.createTypedView(r,t.params.vertexAttributes.normal),a="earth-centered"===e?i:null;p(s,o.normals,a)}};var y=65536;t.extractPositionData=function(e,t,r){var n=t[0];if(null==n||"position"!==n.name||5126!==n.type)return null;for(var o=new Float32Array(e),s=n.stride/4,a=3*o.length/s,u=new Float32Array(a),l=0;l<a/3;l++)u[3*l]=o[l*s+n.offset],u[3*l+1]=o[l*s+n.offset+1],u[3*l+2]=o[l*s+n.offset+2];var c,f=i.deduplicate(u.buffer,3),h=f.uniqueCount<y;if(r)for(c=new(h?Uint16Array:Uint32Array)(r.length),l=0;l<r.length;l++)c[l]=f.indices[r[l]];else c=h?new Uint16Array(f.indices):f.indices;return{data:new Float32Array(f.buffer),indices:c}};var m=r.vec3f32.create(),g=r.vec2f32.create()}.apply(null,n))||(e.exports=i)},1861:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1628),r(8),r(19),r(9),r(1749),r(72),r(521)],void 0===(i=function(e,t,r,n,i,o,s,a,u){Object.defineProperty(t,"__esModule",{value:!0});var l=[],c=o.getLogger("esri.layers.graphics.data.FeatureStore"),f={minX:0,minY:0,maxX:0,maxY:0},h=function(){function e(e){this._featuresById=new r.default,this._boundsByFeature=new r.default,this._featuresByBounds=new r.default,this._index=s(9,i("csp-restrictions")?function(e){return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}}:["[0]","[1]","[2]","[3]"]),this._geometryInfo=e}return Object.defineProperty(e.prototype,"geometryType",{get:function(){return this._geometryInfo.geometryType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasM",{get:function(){return this._geometryInfo.hasM},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hasZ",{get:function(){return this._geometryInfo.hasZ},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"numFeatures",{get:function(){return this._featuresById.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fullBounds",{get:function(){if(!this.numFeatures)return null;var e=a.create(a.NEGATIVE_INFINITY);return this._boundsByFeature.forEach(function(t){t&&(e[0]=Math.min(t[0],e[0]),e[1]=Math.min(t[1],e[1]),e[2]=Math.max(t[2],e[2]),e[3]=Math.max(t[3],e[3]))}),e},enumerable:!0,configurable:!0}),e.prototype.setEngine=function(e){this._engine=e},e.prototype.add=function(e){this._add(e,l),this._index.load(l),this._clearCache(),l.length=0},e.prototype.addMany=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];this._add(n,l)}this._index.load(l),this._clearCache(),l.length=0},e.prototype.clear=function(){this._featuresById.clear(),this._boundsByFeature.clear(),this._featuresByBounds.clear(),this._index.clear(),this._clearCache()},e.prototype.removeManyById=function(e){for(var t=0,r=e;t<r.length;t++){var n=r[t],i=this._featuresById.get(n);if(i){var o=this._boundsByFeature.get(i);o&&(this._index.remove(o),this._featuresByBounds.delete(o)),this._boundsByFeature.delete(i)}this._featuresById.delete(n)}this._clearCache()},e.prototype.forEachBounds=function(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r],o=this._boundsByFeature.get(i);o&&t(o,i)}},e.prototype.getFeature=function(e){return this._featuresById.get(e)},e.prototype.hasFeature=function(e){return this._featuresById.has(e)},e.prototype.forEachFeature=function(e){this._featuresById.forEach(function(t){return e(t)})},e.prototype.forEachFeatureInBounds=function(e,t){for(var r=0,n=function(e,t){return f.minX=t[0],f.minY=t[1],f.maxX=t[2],f.maxY=t[3],e.search(f)}(this._index,e);r<n.length;r++){var i=n[r];t(this._featuresByBounds.get(i))}},e.prototype.transferIds=function(e,t){for(var r=[],n=0,i=t;n<i.length;n++){var o=i[n],s=this._featuresById.get(o);s&&(this._remove(s),r.push(s))}e.addMany(r),this._clearCache()},e.prototype.transferIdRange=function(e,t,r){for(var n=[],i=t;i<r;i++){var o=this._featuresById.get(i);o&&(this._remove(o),n.push(o))}e.addMany(n),this._clearCache()},e.prototype.transferIf=function(e,t){var r=this,n=[];this._featuresById.forEach(function(e,i){t(e)&&(r._remove(e),n.push(e))}),e.addMany(n),this._clearCache()},e.prototype.transferAll=function(e){var t=this,r=[];this._featuresById.forEach(function(e,n){t._remove(e),r.push(e)}),e.addMany(r),this._clearCache()},e.prototype._clearCache=function(){this._engine&&this._engine.clearCache()},e.prototype._add=function(e,t){if(e){var r=e.objectId;if(null==r)return void c.error(new n("featurestore:invalid-feature","feature id is missing",{feature:e}));var i,o=this._featuresById.get(r);if(o&&(i=this._boundsByFeature.get(o))&&(this._index.remove(i),this._boundsByFeature.delete(o),this._featuresByBounds.delete(i)),!e.geometry)return this._boundsByFeature.set(e,null),void this._featuresById.set(r,e);i=u.getBoundsOptimizedGeometry(i||a.create(),e.geometry,this._geometryInfo.hasZ,this._geometryInfo.hasM),this._boundsByFeature.set(e,i),this._featuresByBounds.set(i,e),this._featuresById.set(r,e),t.push(i)}},e.prototype._remove=function(e){var t;e&&((t=this._boundsByFeature.get(e))&&(this._index.remove(t),this._boundsByFeature.delete(e),this._featuresByBounds.delete(t)),this._featuresById.delete(e.objectId))},e}();t.default=h}.apply(null,n))||(e.exports=i)},1862:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(514),r(8),r(549),r(1752)],void 0===(i=function(e,t,r,n,i,o){function s(e){if(!e)return null;var r=t.invalidClauseCache.get(e);if(void 0!==r)return r;var n,i=t.whereClausesCache.get(e);return void 0!==i?i:(n=o.create(e),t.whereClausesCache.put(e,n),n)}function a(e,t,r,i){void 0===i&&(i=!0);for(var o=[],c=0,f=t;c<f.length;c++){var h=f[c];if("*"!==h&&!e.has(h))if(i){var d=u(h);try{var p=s(d);if(!p.isStandardized())throw new n(l,"expression is not standard",{clause:p});a(e,p.getFields(),"expression contains missing fields")}catch(e){var v=e&&e.details;if(v&&v.clause)throw e;v&&v.missingFields?Array.prototype.push.apply(o,v.missingFields):o.push(h)}}else o.push(h)}if(o.length)throw new n(l,r,{missingFields:o})}function u(e){return e.split(c)[0]}Object.defineProperty(t,"__esModule",{value:!0}),t.invalidClauseCache=new i(500),t.whereClausesCache=new i(50);var l="feature-store:unsupported-query",c=" as ",f=new r.default(["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong","esriFieldTypeDate"]);t.validateWhere=function(e,r){if(!r)return!0;var i;try{i=o.create(r),t.whereClausesCache.put(r,i)}catch(e){throw t.invalidClauseCache.put(r,null),new n(l,"invalid SQL expression",{where:r})}if(!i.isStandardized())throw new n(l,"where clause is not standard",{where:r});return a(e,i.getFields(),"where clause contains missing fields"),!0},t.validateHaving=function(e,r,i){if(!r)return!0;var s;try{s=o.create(r),t.whereClausesCache.put(r,s)}catch(e){throw t.invalidClauseCache.put(r,null),new n(l,"invalid SQL expression",{having:r})}if(!s.isAggregate())throw new n(l,"having does not contain a valid aggregate function",{having:r});var u=s.getFields();if(a(e,u,"having contains missing fields"),!s.getExpressions().every(function(t){var r=t.aggregateType,n=t.field,o=e.has(n)&&e.get(n).name;return i.some(function(t){var n=t.onStatisticField,i=t.statisticType,s=n.toLowerCase().trim();return(e.has(s)&&e.get(s).name)===o&&i.toLowerCase().trim()===r})}))throw new n(l,"expressions in having should also exist in outStatistics",{having:r});return!0},t.getWhereClause=s,t.validateFields=a,t.getExpressionFromFieldName=u,t.getAliasFromFieldName=function(e){return e.split(c)[1]},t.hasInvalidFieldType=function(e,t){var r=!1;if(-1!==s(e).getFields().indexOf(e)){var n=t.get(e);r=!f.has(n.type)}return r}}.apply(null,n))||(e.exports=i)},1884:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(1628),r(514),r(30),r(8),r(9),r(270),r(7),r(1894),r(72),r(142),r(67),r(66),r(1862),r(1747),r(556),r(1990),r(1992),r(1909),r(52)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c,f,h,d,p,v,y,m,g,x,b,_){function I(e){return e?JSON.parse(JSON.stringify(e,["latestWkid","wkid","wkt"])):e}function C(e,t,r,n,i,o,s,a){s&&!o?n.forEachFeatureInBounds(i,function(t){var n=b.getCentroid(r,t,a),i=t.attributes;n&&e.push(new T(i,null,n))}):o&&!s?n.forEachFeatureInBounds(i,function(n){var i=n.attributes,o=b.getGeometry(r,n,0,a);o&&(t.add(n.objectId),e.push(new T(i,o)))}):n.forEachFeatureInBounds(i,function(n){var i=n.attributes,o=b.getGeometry(r,n,0,a),s=b.getCentroid(r,n,a);o&&s&&(t.add(n.objectId),e.push(new T(i,o,s)))})}Object.defineProperty(t,"__esModule",{value:!0});var w=a.getLogger("esri.layers.graphics.data.QueryEngine"),T=function(){return function(e,t,r){this.attributes=e,this.geometry=t,this.centroid=r}}(),P={},S=new i.default,A=new u.Storage(2e6),M=0,E=function(){function e(e){var t=this;this.capabilities={query:m.queryCapabilities},this.fieldsMap=new n.default,this.geometryType=e.geometryType,this.hasM=e.hasM,this.hasZ=e.hasZ,this.objectIdField=e.objectIdField,this.spatialReference=e.spatialReference,this.definitionExpression=e.definitionExpression,this.cacheSpatialQueries=e.cacheSpatialQueries||!1,this.gdbVersion=e.gdbVersion,this.historicMoment=e.historicMoment,this.spatialIndex=e.spatialIndex,this.spatialIndex.setEngine(this),this.timeInfo=e.timeInfo,this.cacheSpatialQueries&&(this._geometryQueryCache=new u(M+++"$$",A)),e.fields.forEach(function(e){t.fieldsMap.set(e.name.trim(),e),t.fieldsMap.set(e.name.trim().toLowerCase(),e)})}return e.prototype.destroy=function(){this.clearCache(),this._geometryQueryCache&&this._geometryQueryCache.destroy(),this.fieldsMap.clear()},Object.defineProperty(e.prototype,"fullExtent",{get:function(){var e=this.spatialIndex.fullBounds;return e?{xmin:e[0],ymin:e[1],xmax:e[2],ymax:e[3],spatialReference:I(this.spatialReference)}:null},enumerable:!0,configurable:!0}),e.prototype.clearCache=function(){this._geometryQueryCache&&this._geometryQueryCache.clear(),this._allItems=null},e.prototype.executeQuery=function(e){var t=this;void 0===e&&(e=new _);var r=e.clone();return this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).catch(function(e){if(e===P)return new g.default([],t);throw e}).then(function(e){return e.createQueryResponse(r)})},e.prototype.executeQueryForCount=function(e){var t=this;void 0===e&&(e=new _);var r=e.clone();return r.returnGeometry=!1,r.returnCentroid=!1,r.outSpatialReference=null,this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).then(function(e){return e.size}).catch(function(e){if(e===P)return 0;throw e})},e.prototype.executeQueryForExtent=function(e){var t=this;void 0===e&&(e=new _);var r=e.clone(),n=r.outSpatialReference;return this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(){return r.returnGeometry=!0,r.returnCentroid=!1,r.outSpatialReference=null,r}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).then(function(e){var r=e.size;if(!r)return{count:r,extent:null};var i={xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:I(t.spatialReference)};t.spatialIndex.forEachBounds(e.items,function(e){i.xmin=Math.min(e[0],i.xmin),i.ymin=Math.min(e[1],i.ymin),i.xmax=Math.max(e[2],i.xmax),i.ymax=Math.max(e[3],i.ymax)});var o=y.project(i,e.spatialReference,n);if(o.spatialReference=I(n&&n.toJSON()||t.spatialReference),o.xmax-o.xmin==0){var s=d.getMetersPerUnitForSR(o.spatialReference);o.xmin-=s,o.xmax+=s}if(o.ymax-o.ymin==0){s=d.getMetersPerUnitForSR(o.spatialReference);o.ymin-=s,o.ymax+=s}return{count:r,extent:o}}).catch(function(e){if(e===P)return{count:0,extent:null};throw e})},e.prototype.executeQueryForIds=function(e){var t=this;void 0===e&&(e=new _);var r=e.clone();return r.returnGeometry=!1,r.returnCentroid=!1,r.outSpatialReference=null,this._normalizeQuery(r).then(function(e){return t._checkQuerySupport(e)}).then(function(e){return t._executeGeometryQuery(e)}).then(function(e){return e.executeObjectIdsQuery(r)}).then(function(e){return e.executeAttributesQuery(r)}).then(function(e){for(var t=e.items,r=[],n=0;n<t.length;n++)r[n]=t[n].objectId;return r}).catch(function(e){if(e===P)return[];throw e})},e.prototype.executeTileQuery=function(e,t){var r=this,n=t.returnGeometry,o=t.returnCentroid,s=t.pixelBuffer,a=new i.default,u=[],l=s*e.resolution,c=f.pad(e.bounds,l,f.create());if(C(u,a,this,this.spatialIndex,c,n,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[e.bounds[0],e.bounds[3]]}),"esriGeometryPoint"===this.geometryType||o){var h=p.getInfo(this.spatialReference);if(h){var d=h.valid,v=d[0],y=d[1];if(c[0]<v){var m=f.fromValues(y-l,c[1],y,c[3]);C(u,a,this,this.spatialIndex,m,n,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[y,e.bounds[3]]})}if(c[2]>y){var g=f.fromValues(v,c[1],v+l,c[3]);C(u,a,this,this.spatialIndex,g,n,o,{originPosition:"upperLeft",scale:[e.resolution,e.resolution],translate:[v-y+e.bounds[0],e.bounds[3]]})}}}return u.sort(function(e,t){return e.attributes[r.objectIdField]-t.attributes[r.objectIdField]}),{features:u,objectIds:a}},e.prototype.executeTileQueryForIds=function(e,t){var r=t.pixelBuffer*e.resolution,n=f.pad(e.bounds,r,f.create()),i=[];return this.spatialIndex.forEachFeatureInBounds(n,function(e){return i.push(e.objectId)}),i},e.prototype.executeQueryForLatestObservations=function(e){var t=this;return this.timeInfo?this.executeQuery(e).then(function(e){return t._filterLatest(e,t.timeInfo)}):void w.error(new s("invalid-query","Unable to make time-based query as the underlying service does include TimeInfo"))},e.prototype._filterLatest=function(e,t){for(var i=t.trackIdField,o=t.startTimeField,s=t.endTimeField||o,a=new n.default,u=[],l=0,c=e.features;l<c.length;l++){var f=c[l],h=f.attributes[i],d=f.attributes[s];(!a.has(h)||a.get(h).attributes[s]<d)&&a.set(h,f)}return a.forEach(function(e){return u.push(e)}),r({},e,{features:u})},e.prototype._getAll=function(){if(!this._allItems){var e=[];this.spatialIndex.forEachFeature(function(t){return e.push(t)}),this._allItems=new g.default(e,this)}return this._allItems},e.prototype._normalizeQuery=function(e){var t=this,r=this.definitionExpression,n=e.where,i=e.geometry,o=e.outFields,s=e.orderByFields,a=e.groupByFieldsForStatistics,u=e.outStatistics;if(e.where=n=n&&n.trim(),(!n||/^1 *= *1$/.test(n)||r&&r===n)&&(e.where=null),o)for(var c=0;c<o.length;c++)o[c]=o[c].trim();if(s)for(c=0;c<s.length;c++)s[c]=s[c].trim();if(a)for(c=0;c<a.length;c++)a[c]=a[c].trim();if(u)for(c=0;c<u.length;c++)u[c].onStatisticField&&(u[c].onStatisticField=u[c].onStatisticField.trim());return i?(e.outSpatialReference||(e.outSpatialReference=i.spatialReference),this._getInputGeometry(e).then(function(t){return e.geometry=t}).then(function(e){return y.checkProjectionSupport(e.spatialReference,t.spatialReference)}).then(function(){return h.normalizeCentralMeridian(e.geometry)}).then(function(e){return y.project(e[0].toJSON(),e[0].spatialReference,t.spatialReference)}).then(function(r){if(!r)throw P;return r.spatialReference=t.spatialReference,e.read({geometry:r})})):l.resolve(e)},e.prototype._executeGeometryQuery=function(e){var t=this,r=e.geometry,n=e.outSpatialReference,i=e.spatialRelationship,o=p.isValid(n)&&!p.equals(this.spatialReference,n),s=o?JSON.stringify({geometry:r,spatialRelationship:i,outSpatialReference:n}):JSON.stringify({geometry:r,spatialRelationship:i});if(this.cacheSpatialQueries){var a=this._geometryQueryCache.get(s);if(void 0!==a)return l.resolve(a)}var u=null;if(r){var c=this._searchSpatialIndex(this._getQueryBBoxes(r));if(!c.length){var f=new g.default([],this);return this.cacheSpatialQueries&&this._geometryQueryCache.put(s,f,f.size||1),l.resolve(f)}u="envelope-intersects"===e.spatialRelationship||"esriGeometryPoint"===this.geometryType&&x.canQueryWithRBush(r)?l.resolve(new g.default(c,this)):x.getSpatialQueryOperator(i,r,this.geometryType).then(function(e){if(e){var r=c.filter(function(r){return e(b.getGeometry(t,r))});return new g.default(r,t)}})}else u=l.resolve(this._getAll());return u.then(function(r){return o&&(e.returnGeometry||e.returnCentroid)?r.project(n).then(function(e){return t.cacheSpatialQueries&&t._geometryQueryCache.put(s,e,e.size||1),e}):(t.cacheSpatialQueries&&t._geometryQueryCache.put(s,r,r.size||1),r)})},e.prototype._getInputGeometry=function(e){var t=e.geometry,r=e.distance,n=e.units;if(null==r)return l.resolve(t);var i=t.spatialReference,s=n||d.getUnitString(i);return(i&&(i.isGeographic||i.isWebMercator)?l.resolve(t):y.checkProjectionSupport(i,o.SpatialReference.WGS84).then(function(){return c.project(t,o.SpatialReference.WGS84)})).then(function(e){return x.getGeodesicBufferOperator().then(function(t){return t(e,r,s)})})},e.prototype._getQueryBBoxes=function(e){if("point"===e.type)return[f.fromValues(e.x,e.y,e.x,e.y)];var t=x.canQueryWithRBush(e)?e:e.extent;switch(t.type){case"extent":return[f.fromExtent(t)];case"polygon":return t.rings.map(function(e){return f.fromValues(e[0][0],e[0][1],e[2][0],e[2][1])})}},e.prototype._searchSpatialIndex=function(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];this.spatialIndex.forEachFeatureInBounds(i,function(e){S.has(e)||(t.push(e),S.add(e))})}return S.clear(),t},e.prototype._checkQuerySupport=function(e){return e.distance<0||null!=e.geometryPrecision||e.multipatchOption||e.pixelSize||e.relationParameter||e.text||e.timeExtent?l.reject(new s("feature-store:unsupported-query","Unsupported query options",{query:e})):l.all([this._checkAttributesQuerySupport(e),this._checkStatisticsQuerySupport(e),x.checkSpatialQuerySupport(e,this.geometryType,this.spatialReference),y.checkProjectionSupport(this.spatialReference,e.outSpatialReference)]).then(function(){return e})},e.prototype._checkAttributesQuerySupport=function(e){var t=e.outFields,r=e.orderByFields,n=e.returnDistinctValues;if(r&&r.length>0){var i=r.map(function(e){return e.indexOf(" ASC")>-1?e.split(" ASC")[0]:e.indexOf(" DESC")>-1?e.split(" DESC")[0]:e});v.validateFields(this.fieldsMap,i,"orderByFields contains missing fields")}if(t&&t.length>0)v.validateFields(this.fieldsMap,t,"outFields contains missing fields");else if(n)throw new s("feature-store:unsupported-query","outFields should be specified for returnDistinctValues",{query:e});v.validateWhere(this.fieldsMap,e.where)},e.prototype._checkStatisticsQuerySupport=function(e){var t=e.outStatistics,r=e.groupByFieldsForStatistics,n=e.having,i=r&&r.length,o=t&&t.length;if(n){if(!i||!o)return l.reject(new s("feature-store:unsupported-query","outStatistics and groupByFieldsForStatistics should be specified with having",{query:e}));v.validateHaving(this.fieldsMap,n,t)}if(o){if(t.some(function(e){return"exceedslimit"===e.statisticType}))return;var a=t.map(function(e){return e.onStatisticField});v.validateFields(this.fieldsMap,a,"onStatisticFields contains missing fields"),i&&v.validateFields(this.fieldsMap,r,"groupByFieldsForStatistics contains missing fields");for(var u=0,c=t;u<c.length;u++){var f=c[u],h=f.onStatisticField,d=f.statisticType;if("exceedslimit"===d)return l.reject(new s("feature-store:unsupported-query","statistic type exceedslimit is not supported",{definition:f,query:e}));if((!i||"count"!==d)&&h&&v.hasInvalidFieldType(h,this.fieldsMap))return l.reject(new s("feature-store:unsupported-query","outStatistics contains non-numeric fields",{definition:f,query:e}))}}},e}();t.default=E}.apply(null,n))||(e.exports=i)},1903:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e,t){this.layerExtent=4096,this._features=[],this.layer=e,this.zoom=t,this._filter=e.getFeatureFilter()}return e.prototype.pushFeature=function(e){this._filter.filter(e)&&this._features.push(e)},e.prototype.hasFeatures=function(){return this._features.length>0},e.prototype.processFeatures=function(e,t){},e.prototype.assignBufferInfo=function(e){},e}()}.apply(null,n))||(e.exports=i)},1904:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(0),r(5),r(1),r(1827),r(192),r(1983)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-class-breaks",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.colorClassBreakInfos=null,r}var c;return n(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:this.field,fieldTransformType:this.fieldTransformType,colorClassBreakInfos:o.clone(this.colorClassBreakInfos),legendOptions:o.clone(this.legendOptions)}))},i([s.enumeration.serializable()({pointCloudClassBreaksRenderer:"point-cloud-class-breaks"})],t.prototype,"type",void 0),i([s.property({json:{write:!0},type:String})],t.prototype,"field",void 0),i([s.property({type:u.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),i([s.property({type:a.fieldTransformTypeKebabDict.apiValues,json:{type:a.fieldTransformTypeKebabDict.jsonValues,read:a.fieldTransformTypeKebabDict.read,write:a.fieldTransformTypeKebabDict.write}})],t.prototype,"fieldTransformType",void 0),i([s.property({type:[l.default],json:{write:!0}})],t.prototype,"colorClassBreakInfos",void 0),c=i([s.subclass("esri.renderers.PointCloudClassBreaksRenderer")],t)}(s.declared(a))}.apply(null,n))||(e.exports=i)},1905:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(1),r(1858)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="fixed-size",t.size=0,t.useRealWorldSymbolSizes=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({size:this.size,useRealWorldSymbolSizes:this.useRealWorldSymbolSizes})},n([i.enumeration.serializable()({pointCloudFixedSizeAlgorithm:"fixed-size"})],t.prototype,"type",void 0),n([i.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"size",void 0),n([i.property({type:Boolean,json:{write:!0}})],t.prototype,"useRealWorldSymbolSizes",void 0),o=n([i.subclass("esri.renderers.support.pointCloud.PointSizeFixedSizeAlgorithm")],t)}(i.declared(o.default));t.PointSizeFixedSizeAlgorithm=s,t.default=s}.apply(null,n))||(e.exports=i)},1906:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(1),r(1858)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="splat",t.scaleFactor=1,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({scaleFactor:this.scaleFactor})},n([i.enumeration.serializable()({pointCloudSplatAlgorithm:"splat"})],t.prototype,"type",void 0),n([i.property({type:Number,value:1,nonNullable:!0,json:{write:!0}})],t.prototype,"scaleFactor",void 0),o=n([i.subclass("esri.renderers.support.pointCloud.PointSizeSplatAlgorithm")],t)}(i.declared(o.default));t.PointSizeSplatAlgorithm=s,t.default=s}.apply(null,n))||(e.exports=i)},1907:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(0),r(5),r(1),r(1827),r(192),r(1984)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-stretch",r.field=null,r.legendOptions=null,r.fieldTransformType=null,r.stops=null,r}var c;return n(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),stops:o.clone(this.stops),legendOptions:o.clone(this.legendOptions)}))},i([s.enumeration.serializable()({pointCloudStretchRenderer:"point-cloud-stretch"})],t.prototype,"type",void 0),i([s.property({json:{write:!0},type:String})],t.prototype,"field",void 0),i([s.property({type:u.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),i([s.property({type:a.fieldTransformTypeKebabDict.apiValues,json:{type:a.fieldTransformTypeKebabDict.jsonValues,read:a.fieldTransformTypeKebabDict.read,write:a.fieldTransformTypeKebabDict.write}})],t.prototype,"fieldTransformType",void 0),i([s.property({type:[l.default],json:{write:!0}})],t.prototype,"stops",void 0),c=i([s.subclass("esri.renderers.PointCloudStretchRenderer")],t)}(s.declared(a))}.apply(null,n))||(e.exports=i)},1908:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(2),r(0),r(5),r(1),r(1827),r(192),r(1985)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l){return function(e){function t(t){var r=e.call(this)||this;return r.type="point-cloud-unique-value",r.field=null,r.fieldTransformType=null,r.colorUniqueValueInfos=null,r.legendOptions=null,r}var c;return n(t,e),c=t,t.prototype.clone=function(){return new c(r({},this.cloneProperties(),{field:o.clone(this.field),fieldTransformType:o.clone(this.fieldTransformType),colorUniqueValueInfos:o.clone(this.colorUniqueValueInfos),legendOptions:o.clone(this.legendOptions)}))},i([s.enumeration.serializable()({pointCloudUniqueValueRenderer:"point-cloud-unique-value"})],t.prototype,"type",void 0),i([s.property({json:{write:!0},type:String})],t.prototype,"field",void 0),i([s.property({type:a.fieldTransformTypeKebabDict.apiValues,json:{type:a.fieldTransformTypeKebabDict.jsonValues,read:a.fieldTransformTypeKebabDict.read,write:a.fieldTransformTypeKebabDict.write}})],t.prototype,"fieldTransformType",void 0),i([s.property({type:[l.default],json:{write:!0}})],t.prototype,"colorUniqueValueInfos",void 0),i([s.property({type:u.default,json:{write:!0}})],t.prototype,"legendOptions",void 0),c=i([s.subclass("esri.renderers.PointCloudUniqueValueRenderer")],t)}(s.declared(a))}.apply(null,n))||(e.exports=i)},1909:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(521),r(274)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=new n.default,o=new n.default,s={esriGeometryPoint:r.convertToPoint,esriGeometryPolyline:r.convertToPolyline,esriGeometryPolygon:r.convertToPolygon,esriGeometryMultipoint:r.convertToMultipoint};t.getCentroid=function(e,t,i){if("esriGeometryPolygon"!==e.geometryType)return null;if(!t.centroid&&!t.geometry)return null;if(t.centroid||(t.centroid=r.getCentroidOptimizedGeometry(new n.default,t.geometry,e.hasZ,e.hasM)),i){var s=r.quantizeOptimizedGeometry(o,t.centroid,e.hasZ,e.hasM,"esriGeometryPoint",i);return r.convertToPoint(s,e.hasZ,e.hasM)}return r.convertToPoint(t.centroid,e.hasZ,e.hasM)},t.getGeometry=function(e,t,n,a){if(!t.geometry)return null;if(n){var u=r.generalizeOptimizedGeometry(i,t.geometry,e.hasZ,e.hasM,e.geometryType,n);return a?(u=r.quantizeOptimizedGeometry(o,u,e.hasZ,e.hasM,e.geometryType,a),s[e.geometryType](u,e.hasZ,e.hasM)):s[e.geometryType](u,e.hasZ,e.hasM)}if(a)return u=r.quantizeOptimizedGeometry(o,t.geometry,e.hasZ,e.hasM,e.geometryType,a),s[e.geometryType](u,e.hasZ,e.hasM);return s[e.geometryType](t.geometry,e.hasZ,e.hasM)}}.apply(null,n))||(e.exports=i)},1949:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(e){this._array=[],e<=0&&console.error("strideInBytes must be positive!"),this._stride=e}return Object.defineProperty(e.prototype,"array",{get:function(){return this._array},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return 4*this._array.length/this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"itemSize",{get:function(){return this._stride},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sizeInBytes",{get:function(){return 4*this._array.length},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this.array.length=0},e.prototype.toBuffer=function(){return new Uint32Array(this._array).buffer},e.i1616to32=function(e,t){return 65535&e|t<<16},e.i8888to32=function(e,t,r,n){return 255&e|(255&t)<<8|(255&r)<<16|n<<24},e.i8816to32=function(e,t,r){return 255&e|(255&t)<<8|r<<16},e}()}.apply(null,n))||(e.exports=i)},1950:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(8),r(7)],void 0===(i=function(e,t,n,i,o){Object.defineProperty(t,"__esModule",{value:!0}),t.getControllerConfiguration=function(e){var t=e.source;return"stream"===e.type?o.resolve().then(function(){return{type:"stream",filter:function(e){if(!e)return null;var t={};return e.geometry&&(t.geometry=e.geometry.toJSON()),e.where&&(t.where=e.where),t}(e.filter),purgeOptions:e.purgeOptions}}):e.capabilities.operations.supportsQuery?function(e){return e&&"openPorts"in e}(t)?o.resolve().then(function(){return{type:"memory",processing:e.processing&&e.processing.toWorker()||null}}):o.resolve({type:"on-demand",gdbVersion:e.gdbVersion,historicMoment:e.historicMoment&&e.historicMoment.getTime(),processing:e.processing&&e.processing.toWorker()||null}):o.reject(new i("graphicscontroller:query-capability-required","Service requires query capabilities to be used as a feature layer",{layer:e}))},t.createController=function(e,t){return("memory"===e?o.create(function(e){return Promise.all([r.e(30),r.e(57)]).then(function(){var t=[r(2082)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"stream"===e?o.create(function(e){return Promise.all([r.e(4),r.e(7),r.e(10),r.e(58)]).then(function(){var t=[r(2084)];e.apply(null,t)}.bind(this)).catch(r.oe)}):o.create(function(e){return Promise.all([r.e(4),r.e(7),r.e(10),r.e(30),r.e(59)]).then(function(){var t=[r(2085)];e.apply(null,t)}.bind(this)).catch(r.oe)})).then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,i=t.remoteClient,o=t.tileStore;return new e(n({},r,{tileStore:o,remoteClient:i}))})}}.apply(null,n))||(e.exports=i)},1951:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1904),r(1907),r(1908),r(1635)],void 0===(i=function(e,t,r,n,i,o){function s(e){for(var t=0,r=0,n=e||[];r<n.length;r++)t|=1<<n[r];return t}function a(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.name===t&&null!=i.attributeValues&&"UInt8"===i.attributeValues.valueType&&3===i.attributeValues.valuesPerElement)return{storageInfo:i,useElevation:!1}}return null}function u(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.name===t){var o="embedded-elevation"===i.encoding;return{storageInfo:o?null:i,useElevation:o}}}return"elevation"===t.toLowerCase()?{storageInfo:null,useElevation:!0}:null}function l(e,t,r,n){if(e&&e.useElevation){for(var i=new Float64Array(n),s=0;s<n;s++)i[s]=r[3*s+2];return i}return e&&t?o.readBinaryAttribute(e.storageInfo,t,n):null}function c(e){return null==e||"none"===e?null:"low-four-bit"===e?function(e){return 15&e}:"high-four-bit"===e?function(e){return(240&e)>>4}:"absolute-value"===e?function(e){return Math.abs(e)}:"modulo-ten"===e?function(e){return e%10}:null}Object.defineProperty(t,"__esModule",{value:!0}),t.getRendererInfo=function(e){var t=e.renderer,r=t&&t.type,n=t&&e.renderer.toJSON()||null,i=null,o=!1;"point-cloud-unique-value"===r?i=u(e.attributeStorageInfo,t.field):"point-cloud-stretch"===r?i=u(e.attributeStorageInfo,t.field):"point-cloud-class-breaks"===r?i=u(e.attributeStorageInfo,t.field):o="point-cloud-rgb"===r?null!=(i=a(e.attributeStorageInfo,t.field)):null!=(i=a(e.attributeStorageInfo,"RGB"));var s=null;return t&&t.colorModulation&&(s=u(e.attributeStorageInfo,t.colorModulation.field)),{rendererJSON:n,isRGBRenderer:o,primaryAttribute:i,modulationAttribute:s}},t.getFilterInfo=function(e){var t=e.filters;return t?t.map(function(t){return{filterJSON:t.toJSON(),attributeInfo:u(e.attributeStorageInfo,t.field)}}):[]},t.evaluateRenderer=function(e,t,o,s,a){var u=e.rendererJSON,f=e.isRGBRenderer,h=e.primaryAttribute,d=e.modulationAttribute,p=l(h,t,s,a),v=l(d,o,s,a),y=null,m=null;if(p&&f)y=p;else if(p&&"pointCloudUniqueValueRenderer"===u.type){var g=(m=i.fromJSON(u)).colorUniqueValueInfos;y=new Uint8Array(3*a);for(var x=c(m.fieldTransformType),b=0;b<a;b++)for(var _=(w=x?x(p[b]):p[b])+"",I=0;I<g.length;I++)if(g[I].values.indexOf(_)>=0){y[3*b]=g[I].color.r,y[3*b+1]=g[I].color.g,y[3*b+2]=g[I].color.b;break}}else if(p&&"pointCloudStretchRenderer"===u.type){var C=(m=n.fromJSON(u)).stops;for(y=new Uint8Array(3*a),x=c(m.fieldTransformType),b=0;b<a;b++){var w=x?x(p[b]):p[b],T=C.length-1;if(w<C[0].value)y[3*b]=C[0].color.r,y[3*b+1]=C[0].color.g,y[3*b+2]=C[0].color.b;else if(w>=C[T].value)y[3*b]=C[T].color.r,y[3*b+1]=C[T].color.g,y[3*b+2]=C[T].color.b;else for(I=1;I<C.length;I++)if(w<C[I].value){var P=(w-C[I-1].value)/(C[I].value-C[I-1].value);y[3*b]=C[I].color.r*P+C[I-1].color.r*(1-P),y[3*b+1]=C[I].color.g*P+C[I-1].color.g*(1-P),y[3*b+2]=C[I].color.b*P+C[I-1].color.b*(1-P);break}}}else if(p&&"pointCloudClassBreaksRenderer"===u.type){var S=(m=r.fromJSON(u)).colorClassBreakInfos;for(y=new Uint8Array(3*a),x=c(m.fieldTransformType),b=0;b<a;b++)for(w=x?x(p[b]):p[b],I=0;I<S.length;I++)if(w>=S[I].minValue&&w<=S[I].maxValue){y[3*b]=S[I].color.r,y[3*b+1]=S[I].color.g,y[3*b+2]=S[I].color.b;break}}else for(y=new Uint8Array(3*a),b=0;b<y.length;b++)y[b]=255;if(v&&m&&m.colorModulation){var A=m.colorModulation.minValue,M=m.colorModulation.maxValue;for(b=0;b<a;b++){var E=(w=v[b])>=M?1:w<=A?.3:.3+.7*(w-A)/(M-A);y[3*b]=E*y[3*b],y[3*b+1]=E*y[3*b+1],y[3*b+2]=E*y[3*b+2]}}return y},t.filterInPlace=function(e,t,r,n){for(var i=e.length/3,o=n.map(function(t,n){return l(r[n].attributeInfo,t,e,i)}),a=0,u=0;u<i;u++){for(var c=!0,f=0;f<r.length&&c;f++){var h=r[f].filterJSON,d=o[f][u];switch(h.type){case"pointCloudValueFilter":var p="exclude"===h.mode;-1!==h.values.indexOf(d)===p&&(c=!1);break;case"pointCloudBitfieldFilter":var v=s(h.requiredSetBits),y=s(h.requiredClearBits);(d&v)===v&&0==(d&y)||(c=!1);break;case"pointCloudReturnFilter":for(var m=15&d,g=d>>>4&15,x=g>1,b=1===m,_=m===g,I=!1,C=0,w=h.includedReturns;C<w.length;C++){var T=w[C];if("last"===T&&_||"firstOfMany"===T&&b&&x||"lastOfMany"===T&&_&&x||"single"===T&&!x){I=!0;break}}I||(c=!1)}}c&&(e[3*a]=e[3*u],e[3*a+1]=e[3*u+1],e[3*a+2]=e[3*u+2],t[3*a]=t[3*u],t[3*a+1]=t[3*u+1],t[3*a+2]=t[3*u+2],a++)}return a},t.getSplatSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"splat"===t.type?t:null},t.getFixedSizeAlgorithm=function(e){var t=e&&e.pointSizeAlgorithm;return t&&"fixed-size"===t.type?t:null},t.rendererUsesFixedSizes=function(e){var t=e&&e.pointSizeAlgorithm;return!(!t||!t.type)&&"fixed-size"===t.type}}.apply(null,n))||(e.exports=i)},1979:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INITIALIZED=0]="INITIALIZED",e[e.NO_DATA=1]="NO_DATA",e[e.READY=2]="READY",e[e.MODIFIED=3]="MODIFIED",e[e.INVALID=4]="INVALID"}(t.TileStatus||(t.TileStatus={}))}.apply(null,n))||(e.exports=i)},1980:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(6),r(1)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.field=null,t.minValue=0,t.maxValue=255,t}var i;return r(t,e),i=t,t.prototype.clone=function(){return new i({field:this.field,minValue:this.minValue,maxValue:this.maxValue})},n([o.property({type:String,json:{write:!0}})],t.prototype,"field",void 0),n([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"minValue",void 0),n([o.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"maxValue",void 0),i=n([o.subclass("esri.renderers.support.pointCloud.ColorModulation")],t)}(o.declared(i));t.ColorModulation=s,t.default=s}.apply(null,n))||(e.exports=i)},1981:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(88),r(1905),r(1906)],void 0===(i=function(e,t,r,n,i){function o(e){return e&&s[e.type]||null}Object.defineProperty(t,"__esModule",{value:!0});var s={pointCloudFixedSizeAlgorithm:n.default,pointCloudSplatAlgorithm:i.default};t.read=function(e,t,n){var i=o(e);if(i){var s=new i;return s.read(e,n),s}return n&&n.messages&&e&&n.messages.push(new r("pointsizealgorithm:unsupported","Point size algorithms of type '"+(e.type||"unknown")+"' are not supported",{definition:e,context:n})),null},t.fromJSON=function(e){var t=o(e);return t?t.fromJSON(e):null}}.apply(null,n))||(e.exports=i)},1982:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1858),r(1905),r(1906)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.pointSizeAlgorithmTypes={key:"type",base:r.default,typeMap:{"fixed-size":n.default,splat:i.default}}}.apply(null,n))||(e.exports=i)},1983:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(25),r(6),r(5),r(1),r(24)],void 0===(i=function(e,t,r,n,i,o,s,a,u){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.minValue=0,t.maxValue=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,color:s.clone(this.color)})},n([a.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([a.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([a.property({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],t.prototype,"minValue",void 0),n([a.property({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],t.prototype,"maxValue",void 0),n([a.property({type:i,json:{type:[u.Integer],write:!0}})],t.prototype,"color",void 0),o=n([a.subclass("esri.renderers.support.pointCloud.ColorClassBreakInfo")],t)}(a.declared(o));t.ColorClassBreakInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},1984:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(25),r(6),r(5),r(1),r(24)],void 0===(i=function(e,t,r,n,i,o,s,a,u){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.label=null,t.value=0,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({label:this.label,value:this.value,color:s.clone(this.color)})},n([a.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([a.property({type:Number,nonNullable:!0,json:{write:!0}})],t.prototype,"value",void 0),n([a.property({type:i,json:{type:[u.Integer],write:!0}})],t.prototype,"color",void 0),o=n([a.subclass("esri.renderers.support.pointCloud.StopInfo")],t)}(a.declared(o));t.StopInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},1985:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2),r(0),r(25),r(6),r(5),r(1),r(24)],void 0===(i=function(e,t,r,n,i,o,s,a,u){Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.description=null,t.label=null,t.values=null,t.color=null,t}var o;return r(t,e),o=t,t.prototype.clone=function(){return new o({description:this.description,label:this.label,values:s.clone(this.values),color:s.clone(this.color)})},n([a.property({type:String,json:{write:!0}})],t.prototype,"description",void 0),n([a.property({type:String,json:{write:!0}})],t.prototype,"label",void 0),n([a.property({type:[String],json:{write:!0}})],t.prototype,"values",void 0),n([a.property({type:i,json:{type:[u.Integer],write:!0}})],t.prototype,"color",void 0),o=n([a.subclass("esri.renderers.support.pointCloud.ColorUniqueValueInfo")],t)}(a.declared(o));t.ColorUniqueValueInfo=l,t.default=l}.apply(null,n))||(e.exports=i)},1989:function(e,t,r){var n,i;n=[r(12),r(115)],void 0===(i=function(e,t){var r=/^\s*"([\S\s]*)"\s*$/,n=/""/g,i=/"/g;function o(e,t){var r,n={},i=e.length;for(r=0;r<i;r++)n[e[r]]=t[r];return n}return t(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(t){var i,s,a,u,l,c,f,h,d=[],p=t.split(this.newline),v=this.fieldNames,y=0,m=[],g="",x="";e:for(c=0,a=p.length;c<a;c++)if(e.trim(p[c])){for(f=0,u=(i=p[c].split(this.delimiter)).length;f<u;f++){for(h=-1,g+=x+(s=i[f]),x="";(h=s.indexOf('"',h+1))>=0;)y++;if(y%2==0){if(y>0){if(!(l=r.exec(g))){console.warn("Csv: discarding row with invalid value: "+g),m=[],g="",y=0;continue e}m.push(l[1].replace(n,'"'))}else m.push(this.trim||!v?e.trim(g):g);g="",y=0}else x=this.delimiter}0===y?(v?d.push(o(v,m)):v=this.fieldNames=m,m=[]):x=this.newline}return d},toCsv:function(e){return this.stringify(this.data,e)},stringify:function(e,t){var r,n,o,s,a=(t=t||{}).alwaysQuote,u=this.fieldNames,l=this.delimiter,c=this.newline,f="";for(r=-1;r<e.length;r++)for(r>-1&&(f+=c),n=0;n<u.length;n++)null!==(o=r<0?u[n]:e[r][u[n]])&&void 0!==o||(o=""),"string"!=typeof o&&(o=o.toString()),s=a||o.indexOf('"')>=0||o.indexOf(l)>=0,f+=(n>0?l:"")+(s?'"'+o.replace(i,'""')+'"':o);return t.trailingNewline&&(f+=c),f}})}.apply(null,n))||(e.exports=i)},1990:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(514),r(7),r(1620),r(66),r(521),r(1991),r(1862),r(1747),r(1909)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c){Object.defineProperty(t,"__esModule",{value:!0});var f=function(){function e(e,t){this.items=e,this.definitionExpression=t.definitionExpression,this.geometryType=t.geometryType,this.hasM=t.hasM,this.hasZ=t.hasZ,this.objectIdField=t.objectIdField,this.spatialReference=t.spatialReference,this.fieldsMap=t.fieldsMap}return Object.defineProperty(e.prototype,"size",{get:function(){return this.items.length},enumerable:!0,configurable:!0}),e.prototype.createQueryResponse=function(e){return e.outStatistics?e.outStatistics.some(function(e){return"exceedslimit"===e.statisticType})?this._createExceedsLimitQueryResponse(e):this._createStatisticsQueryResponse(e):this._createFeatureQueryResponse(e)},e.prototype.executeAttributesQuery=function(e){var t=u.getWhereClause(e.where);if(!t)return n.resolve(this);if(t.isStandardized()){for(var r=0,i=[],o=0,s=this.items;o<s.length;o++){var a=s[o];t.testFeature(a.attributes)&&(i[r++]=a)}var l=this._createNew(i);return l.definitionExpression=e.where,n.resolve(l)}return n.reject(new TypeError("Where clause is not standardized"))},e.prototype.executeObjectIdsQuery=function(e){if(!e.objectIds||!e.objectIds.length)return n.resolve(this);var t=new r.default(e.objectIds);return n.resolve(this._createNew(this.items.filter(function(e){return t.has(e.objectId)})))},e.prototype.project=function(t){var r=this;return!t||o.equals(this.spatialReference,t)?n.resolve(this):l.projectMany(this.items.map(function(e){return c.getGeometry(r,e)}),this.spatialReference,t).then(function(n){for(var i=[],o=0;o<r.items.length;o++)i[o]={attributes:r.items[o].attributes,geometry:n[o]};var a=[];return s.convertFromFeatures(a,i,r.geometryType,r.hasZ,r.hasM,r.objectIdField),new e(a,{definitionExpression:r.definitionExpression,geometryType:r.geometryType,hasM:r.hasM,hasZ:r.hasZ,objectIdField:r.objectIdField,spatialReference:t,fieldsMap:r.fieldsMap})})},e.prototype._createFeatureQueryResponse=function(e){var t=this,r=this.items,n=this,o=n.geometryType,s=n.hasM,a=n.hasZ,u=n.objectIdField,l=n.spatialReference,c=e.outFields,f=e.outSpatialReference,h=e.quantizationParameters,d=!1;if(null!=e.num&&null!=e.start){var p=e.start+e.num;d=r.length>p,r=r.slice(e.start,Math.min(r.length,p))}return{exceededTransferLimit:d,features:this._createFeatures(e,r),fields:c&&c.map(function(e){return t.fieldsMap.get(e)}),geometryType:o,hasM:s,hasZ:a,objectIdFieldName:u,spatialReference:function(e){return e?JSON.parse(JSON.stringify(e,["latestWkid","wkid","wkt"])):e}(f?f.toJSON():l),transform:h&&i.toTransform(h)}},e.prototype._createFeatures=function(e,t){var r=new a.default(e,this.fieldsMap),n=e.quantizationParameters,o=e.returnGeometry,s=e.returnCentroid,u=e.maxAllowableOffset,l=e.orderByFields,f=[],h=0;if(t.length&&l&&l.length){var d=l[0].split(" "),p=d[0],v="DESC"===d[1];t.sort(function(e,t){var n=r.getFieldValue(e,p),i=r.getFieldValue(t,p);if("number"==typeof n&&"number"==typeof i)return v?i-n:n-i;if("string"==typeof n&&"string"==typeof i){var o=n.toUpperCase(),s=i.toUpperCase();return(v?o>s:o<s)?-1:(v?o<s:o>s)?1:0}})}if(o||s){var y=i.toTransform(n);if(o&&!s)for(var m=0,g=t;m<g.length;m++){var x=g[m];f[h++]={attributes:r.getAttributes(x),geometry:c.getGeometry(this,x,u,y)}}else if(!o&&s)for(var b=0,_=t;b<_.length;b++){x=_[b];f[h++]={attributes:r.getAttributes(x),centroid:c.getCentroid(this,x,y)}}else for(var I=0,C=t;I<C.length;I++){x=C[I];f[h++]={attributes:r.getAttributes(x),centroid:c.getCentroid(this,x,y),geometry:c.getGeometry(this,x,u,y)}}}else for(var w=0,T=t;w<T.length;w++){x=T[w];var P=r.getAttributes(x);P&&(f[h++]={attributes:P})}return f},e.prototype._createNew=function(t){return new e(t,this)},e.prototype._createExceedsLimitQueryResponse=function(e){var t=!1,r=null;e.outStatistics.some(function(e){return r=e,"exceedslimit"===e.statisticType});var n=null!=r.maxPointCount?r.maxPointCount:Number.POSITIVE_INFINITY,i=null!=r.maxRecordCount?r.maxRecordCount:Number.POSITIVE_INFINITY,o=null!=r.maxVertexCount?r.maxVertexCount:Number.POSITIVE_INFINITY;if("esriGeometryPoint"===this.geometryType)t=this.items.length>n;else if(this.items.length>i)t=!0;else{var s=this.hasZ?this.hasM?4:3:this.hasM?3:2;t=this.items.reduce(function(e,t){return e+(t.geometry&&t.geometry.coords.length||0)},0)/s>o}return{fields:[{name:"exceedslimit",type:"esriFieldTypeInteger",alias:"exceedslimit",sqlType:"sqlTypeInteger",domain:null,defaultValue:null}],features:[{attributes:{exceedslimit:Number(t)}}]}},e.prototype._createStatisticsQueryResponse=function(e){for(var t=new a.default(e,this.fieldsMap),r=e.outStatistics,n=[],i=[],o=e.groupByFieldsForStatistics,s=e.having,u=o&&o.length,l=u&&o[0],c={},f={},h={},d={attributes:{}},p=0,v=r;p<v.length;p++){var y=v[p],m=y.onStatisticField,g=y.outStatisticFieldName,x=y.statisticType,b="1"===m;if(u&&(m===l||b)&&"count"===x){c[m]||(c[m]=this._calculateUniqueValues(t,b?l:m));var _=c[m];for(var I in _){var C=_[I],w=C.count,T=C.data,P=C.items,S=f[T]||{attributes:{}};s&&!t.validateItems(P,s)||(S.attributes[g]=w,S.attributes[b?"EXPR_1":m]=T,f[T]=S)}i.push({name:g,alias:g,type:"esriFieldTypeString"})}else{if(u){var A=this._calculateUniqueValues(t,l);for(var I in A){var M=A[I];T=M.data,P=M.items;if(!s||t.validateItems(P,s)){S=f[T]||{attributes:{}};var E=this._calculateStatistics(P,t,m),B="var"===x?"variance":x;S.attributes[g]=E[B],S.attributes[l]=T,f[T]=S}}}else{h[m]||(h[m]=this._calculateStatistics(this.items,t,m));E=h[m],B="var"===x?"variance":x;d.attributes[g]=E[B]}i.push({name:g,alias:g,type:"esriFieldTypeDouble"})}}if(u)for(var D in f)n.push(f[D]);else n.push(d);return{fields:i,features:n}},e.prototype._calculateStatistics=function(e,t,r){for(var n=e.length,i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=null,a=null,u=null,l=null,c=[],f=0;f<n;f++){var h=e[f],d=c[f]=t.getFieldValue(h,r);isNaN(d)||(s+=d,i=Math.min(i,d),o=Math.max(o,d))}if(n){a=s/n;for(var p=0,v=0,y=c;v<y.length;v++){d=y[v];p+=Math.pow(d-a,2)}l=n>1?p/(n-1):0,u=Math.sqrt(l)}else i=null,o=null;return{avg:a,count:n,max:o,min:i,stddev:u,sum:s,variance:l}},e.prototype._calculateUniqueValues=function(e,t){for(var r={},n=0,i=this.items;n<i.length;n++){var o=i[n],s=e.getFieldValue(o,t);(null==s||"string"==typeof s&&""===s.trim())&&(s=null),null==r[s]?r[s]={count:1,data:s,items:[o]}:(r[s].count++,r[s].items.push(o))}return r},e}();t.default=f}.apply(null,n))||(e.exports=i)},1991:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1628),r(1862)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){this._fieldDataCache=new r.default,this._returnDistinctMap=new r.default,this.returnDistinctValues=e.returnDistinctValues,this.fieldsMap=t;var i=e.outFields;if(i&&-1===i.indexOf("*")){this.outFields=i;for(var o=0,s=0,a=i;s<a.length;s++){var u=a[s],l=n.getExpressionFromFieldName(u),c=this.fieldsMap.has(l),f=c?null:n.getWhereClause(l),h=c?this.fieldsMap.get(u).name:n.getAliasFromFieldName(u)||"FIELD_EXP_"+o++;this._fieldDataCache.set(u,{alias:h,clause:f})}}}return e.prototype.getAttributes=function(e){var t=e.attributes;return t=this._processAttributesForOutFields(t),this._processAttributesForDistinctValues(t)},e.prototype.getFieldValue=function(e,t){var r=e.attributes,i=this.fieldsMap.has(t),o=i?this.fieldsMap.get(t).name:t,s=null;return this._fieldDataCache.has(o)?s=this._fieldDataCache.get(o).clause:i||(s=n.getWhereClause(t),this._fieldDataCache.set(o,{alias:o,clause:s})),i?r[o]:s.calculateValue(r)},e.prototype.validateItem=function(e,t){return this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t)}),this._fieldDataCache.get(t).clause.testFeature(e.attributes)},e.prototype.validateItems=function(e,t){var r=this;this._fieldDataCache.has(t)||this._fieldDataCache.set(t,{alias:t,clause:n.getWhereClause(t)});var i=e.map(function(e){return r.getAttributes(e)});return this._fieldDataCache.get(t).clause.testSet(i)},e.prototype._processAttributesForOutFields=function(e){var t=this.outFields;if(!e||!t||!t.length)return e;for(var r={},n=0,i=t;n<i.length;n++){var o=i[n],s=this._fieldDataCache.get(o),a=s.alias,u=s.clause;r[a]=u?u.calculateValue(e):e[a]}return r},e.prototype._processAttributesForDistinctValues=function(e){if(!e||!this.returnDistinctValues)return e;var t=this.outFields,r=[];if(t)for(var n=0,i=t;n<i.length;n++){var o=i[n],s=this._fieldDataCache.get(o).alias;r.push(e[s])}else for(var s in e)r.push(e[s]);var a=(t||["*"]).join(",")+"="+r.join(","),u=this._returnDistinctMap.get(a)||0;return this._returnDistinctMap.set(a,++u),u>1?null:e},e}();t.default=i}.apply(null,n))||(e.exports=i)},1992:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(8),r(7),r(99),r(284),r(66),r(1747)],void 0===(i=function(e,t,n,i,o,s,a,u){function l(){return i.create(function(e){return Promise.resolve().then(function(){var t=[r(279)];e.apply(null,t)}.bind(this)).catch(r.oe)})}Object.defineProperty(t,"__esModule",{value:!0});var c="feature-store:unsupported-query",f={spatialRelationship:{intersects:!0,contains:!0,within:!0,crosses:!0,touches:!0,overlaps:!0,"envelope-intersects":!0},queryGeometry:{point:!0,multipoint:!0,polyline:!0,polygon:!0,extent:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0}};t.importGeometryEngine=l,t.getGeodesicBufferOperator=function(){return l().then(function(e){return e.geodesicBuffer})},t.getSpatialQueryOperator=function(e,t,r){if("intersects"===e){if("polygon"===t.type&&"esriGeometryPoint"===r)return i.resolve(o.polygonContainsPoint.bind(null,t.toJSON()));if("extent"===t.type)return i.resolve(s.getExtentIntersector(r).bind(null,t))}return l().then(function(r){return r[e].bind(null,t.toJSON())})},t.checkSpatialQuerySupport=function(e,t,r){var o=e.spatialRelationship,s=e.geometry;return s?function(e){return!0===f.spatialRelationship[e]}(o)?a.isValid(s.spatialReference)&&a.isValid(r)?function(e){return!0===f.queryGeometry[e]}(s.type)?function(e){return!0===f.layerGeometry[e]}(t)?u.checkProjectionSupport(e.geometry&&e.geometry.spatialReference,e.outSpatialReference):i.reject(new n(c,"Unsupported layer geometry type",{query:e})):i.reject(new n(c,"Unsupported query geometry type",{query:e})):i.resolve():i.reject(new n(c,"Unsupported query spatial relationship",{query:e})):null},t.canQueryWithRBush=function(e){switch(e.type){case"extent":return!0;case"polygon":return e.rings.every(function(e){return 5===e.length&&e[0][0]===e[1][0]&&e[0][0]===e[4][0]&&e[2][0]===e[3][0]&&e[0][1]===e[3][1]&&e[0][1]===e[4][1]&&e[1][1]===e[2][1]});default:return!1}}}.apply(null,n))||(e.exports=i)},2028:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(122),r(516),r(1729),r(1903)],void 0===(i=function(e,t,r,n,i,o,s,a){return function(e){function t(t,r,n,i,o,s){var a=e.call(this,t,r)||this;if(t.hasDataDrivenFill!==n.isDataDriven())throw new Error("incompatible fill buffer");if(t.hasDataDrivenOutline!==o.isDataDriven())throw new Error("incompatible outline buffer");return a._fillVertexBuffer=n,a._fillIndexBuffer=i,a._outlineVertexBuffer=o,a._outlineIndexBuffer=s,a}return r(t,e),Object.defineProperty(t.prototype,"fillIndexStart",{get:function(){return this._fillIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fillIndexCount",{get:function(){return this._fillIndexCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexStart",{get:function(){return this._outlineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"outlineIndexCount",{get:function(){return this._outlineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._fillIndexStart=this._fillIndexStart,t._fillIndexCount=this._fillIndexCount,e.layer.getPaintProperty("fill-outline-color")?(t._outlineIndexStart=this._outlineIndexStart,t._outlineIndexCount=this._outlineIndexCount):(t._outlineIndexStart=0,t._outlineIndexCount=0)},t.prototype.processFeatures=function(e,t){this._fillIndexStart=this._fillIndexBuffer.index,this._fillIndexCount=0,this._outlineIndexStart=this._outlineIndexBuffer.index,this._outlineIndexCount=0;var r=this.layer,n=this.zoom,i=r.hasDataDrivenFill,o=r.hasDataDrivenOutline;e&&e.setExtent(this.layerExtent);var s=r.getPaintValue("fill-pattern",n),a=r.getPaintValue("fill-antialias",n)&&void 0===s,u=[1,1,1,1],l=[1,1,1,1],c=1;if(r.outlineUsesFillColor){if(a&&!r.hasDataDrivenOpacity){var f=r.getPaintValue("fill-opacity",n),h=r.getPaintValue("fill-opacity",n+1);f<1&&h<1&&(a=!1)}if(a&&!r.hasDataDrivenColor){var d=r.getPaintValue("fill-color",n),p=r.getPaintValue("fill-color",n+1);d[3]<1&&p[3]<1&&(a=!1)}}for(var v=0,y=this._features;v<y.length;v++){var m=y[v];!s&&r.hasDataDrivenColor&&(u=r.getPaintValue("fill-color",n,m)),r.hasDataDrivenOpacity&&(c=r.getPaintValue("fill-opacity",n,m)),!s&&r.hasDataDrivenOutlineColor&&(l=r.getPaintValue("fill-outline-color",n,m));var g=void 0;i&&(g={color:u,opacity:c});var x=void 0;o&&(x={color:r.outlineUsesFillColor?u:l,opacity:c});var b=m.getGeometry(e);this._processFeature(b,a,r.outlineUsesFillColor,g,x)}},t.prototype._processFeature=function(e,r,n,i,o){if(e){var s=e.length;if(r&&(!n||!o||o.color[3]*o.opacity==1))for(var a=0;a<s;a++)this._processOutline(e[a],o);var u;for(a=0;a<s;a++){var l=t._area(e[a]);l>128?(void 0!==u&&this._processFill(e,u,i),u=[a]):l<-128&&void 0!==u&&u.push(a)}void 0!==u&&this._processFill(e,u,i)}},t.prototype._processOutline=function(e,t){var r,n,i,o=this._outlineVertexBuffer,a=this._outlineIndexBuffer,u=a.index,l=new s.Point(0,0),c=new s.Point(0,0),f=new s.Point(0,0),h=-1,d=-1,p=-1,v=-1,y=-1,m=!1,g=e.length;if(!(g<2)){for(var x=e[0],b=e[g-1];g&&b.isEqual(x);)b=e[--g-1];if(!(g-0<2)){for(var _=0;_<g;++_){0===_?(r=e[g-1],n=e[0],i=e[1],l.assignSub(n,r),l.normalize(),l.rightPerpendicular()):(r=n,n=i,i=_!==g-1?e[_+1]:e[0],l.assign(c));var I=this._isClipEdge(r,n);-1===v&&(m=I),c.assignSub(i,n),c.normalize(),c.rightPerpendicular();var C=l.x*c.y-l.y*c.x;f.assignAdd(l,c),f.normalize();var w=-f.x*-l.x+-f.y*-l.y,T=Math.abs(0!==w?1/w:1);T>8&&(T=8),C>=0?(p=o.add(n.x,n.y,l.x,l.y,0,1,t),-1===v&&(v=p),h>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p),d=o.add(n.x,n.y,T*-f.x,T*-f.y,0,-1,t),-1===y&&(y=d),h>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p),h=d,d=p,p=o.add(n.x,n.y,f.x,f.y,0,1,t),h>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p),d=o.add(n.x,n.y,c.x,c.y,0,1,t),h>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p)):(p=o.add(n.x,n.y,T*f.x,T*f.y,0,1,t),-1===v&&(v=p),h>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p),d=o.add(n.x,n.y,-l.x,-l.y,0,-1,t),-1===y&&(y=d),h>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p),h=d,d=p,p=o.add(n.x,n.y,-f.x,-f.y,0,-1,t),h>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p),(h=o.add(n.x,n.y,-c.x,-c.y,0,-1,t))>=0&&d>=0&&p>=0&&!I&&a.add(h,d,p))}h>=0&&d>=0&&v>=0&&!m&&a.add(h,d,v),h>=0&&v>=0&&y>=0&&!m&&a.add(h,y,v),this._outlineIndexCount+=3*(a.index-u)}}},t.prototype._processFill=function(e,t,r){var n;t.length>1&&(n=[]);for(var s=0,a=0,u=t;a<u.length;a++){var l=u[a];0!==s&&n.push(s),s+=e[l].length}for(var c=2*s,f=i.acquire(),h=0,d=t;h<d.length;h++)for(var p=e[l=d[h]],v=p.length,y=0;y<v;++y)f.push(p[y].x),f.push(p[y].y);var m=o(f,n,2),g=m.length;if(g>0){for(var x=this._fillVertexBuffer.index,b=0;b<c;)this._fillVertexBuffer.add(f[b++],f[b++],r);for(var _=0;_<g;)this._fillIndexBuffer.add(x+m[_++],x+m[_++],x+m[_++]);this._fillIndexCount+=g}i.release(f)},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t._area=function(e){for(var t=0,r=e.length-1,n=0;n<r;n++)t+=(e[n].x-e[n+1].x)*(e[n].y+e[n+1].y);return.5*(t+(e[r].x-e[0].x)*(e[r].y+e[0].y))},t}(a)}.apply(null,n))||(e.exports=i)},2029:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(19),r(541),r(139),r(7)],void 0===(i=function(e,t,r,n,i,o){function s(){var e=0===u.length;if(!e){for(var t=i();!e&&i()-t<a;){var r=u[c];if(r){if(!0===r()){var o=l.get(r);u[c]=null,l.delete(r),o()}c=(c+1)%u.length}else u.splice(c,1),(e=0===u.length)?c=0:c%=u.length}e||n(s)}}var a=r("host-browser")?6:200,u=[],l=new Map,c=0;return function(e){return e?o.create(function(t){u.push(e),l.set(e,t),1===u.length&&n(s)},function(){u[u.indexOf(e)]=null,l.delete(e)}):o.reject(new TypeError("callback is not a function"))}}.apply(null,n))||(e.exports=i)},2030:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(1903)],void 0===(i=function(e,t,r,n,i){return function(e){function t(t,r){return e.call(this,t,r)||this}return r(t,e),t}(i)}.apply(null,n))||(e.exports=i)},2031:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(1903)],void 0===(i=function(e,t,r,n,i){return function(e){function t(t,r,n,i){var o=e.call(this,t,r)||this;return o._circleVertexBuffer=n,o._circleIndexBuffer=i,o}return r(t,e),Object.defineProperty(t.prototype,"circleIndexStart",{get:function(){return this._circleIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"circleIndexCount",{get:function(){return this._circleIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._circleIndexStart=this._circleIndexStart,t._circleIndexCount=this._circleIndexCount},t.prototype.processFeatures=function(e,t){var r=this._circleVertexBuffer,n=this._circleIndexBuffer;this._circleIndexStart=n.index,this._circleIndexCount=0;var i=this.layer,o=this.zoom;e&&e.setExtent(this.layerExtent);for(var s=1,a=[1,1,1,1],u=1,l=0,c=1,f=[1,1,1,1],h=1,d=0,p=this._features;d<p.length;d++){var v=p[d],y=v.getGeometry(e);if(y){i.hasDataDrivenRadius&&(s=i.getPaintValue("circle-radius",o,v)),i.hasDataDrivenColor&&(a=i.getPaintValue("circle-color",o,v)),i.hasDataDrivenOpacity&&(u=i.getPaintValue("circle-opacity",o,v)),i.hasDataDrivenStrokeWidth&&(c=i.getPaintValue("circle-stroke-width",o,v)),i.hasDataDrivenStrokeColor&&(f=i.getPaintValue("circle-stroke-color",o,v)),i.hasDataDrivenStrokeOpacity&&(h=i.getPaintValue("circle-stroke-opacity",o,v)),i.hasDataDrivenBlur&&(l=i.getPaintValue("circle-blur",o,v));for(var m=0,g=y;m<g.length;m++){var x=g[m];if(x)for(var b=0,_=x;b<_.length;b++){var I=_[b],C=r.index;r.add(I.x,I.y,0,0,s,a,u,l,c,f,h),r.add(I.x,I.y,0,1,s,a,u,l,c,f,h),r.add(I.x,I.y,1,0,s,a,u,l,c,f,h),r.add(I.x,I.y,1,1,s,a,u,l,c,f,h),n.add(C+0,C+1,C+2),n.add(C+1,C+2,C+3),this._circleIndexCount+=6}}}}},t}(i)}.apply(null,n))||(e.exports=i)},2032:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(1852),r(1903),r(559)],void 0===(i=function(e,t,r,n,i,o,s){var a=20,u=new i.Tessellator({distanceAlongCorrection:!0});return function(e){function t(t,r,n,o){var s=e.call(this,t,r)||this;if(s.extrudeVectorsDoubleBuffer=[i.allocExtrudeVectors(),i.allocExtrudeVectors()],s.firstExtrudeVectors=i.allocExtrudeVectors(),s.recycledTriangleBridge=i.allocTriangles(a),s.recycledTrianglePie=i.allocTriangles(a),t.hasDataDrivenLine!==n.isDataDriven())throw new Error("incompatible line buffer");return s._lineVertexBuffer=n,s._lineIndexBuffer=o,s}return r(t,e),Object.defineProperty(t.prototype,"lineIndexStart",{get:function(){return this._lineIndexStart},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"lineIndexCount",{get:function(){return this._lineIndexCount},enumerable:!0,configurable:!0}),t.prototype.assignBufferInfo=function(e){var t=e;t._lineIndexStart=this._lineIndexStart,t._lineIndexCount=this._lineIndexCount},t.prototype.processFeatures=function(e,t){this._lineIndexStart=this._lineIndexBuffer.index,this._lineIndexCount=0;var r=this.layer,n=this.zoom,i=r.hasDataDrivenLine;e&&e.setExtent(this.layerExtent);for(var o=r.getPaintValue("line-pattern",n),a=[1,1,1,1],u=1,l=1,c=0,f=this._features;c<f.length;c++){var h=f[c],d=new s.LineLayout(r,n,h);!o&&r.hasDataDrivenColor&&(a=r.getPaintValue("line-color",n,h)),r.hasDataDrivenOpacity&&(u=r.getPaintValue("line-opacity",n,h)),r.hasDataDrivenWidth&&(l=r.getPaintValue("line-width",n,h));var p=void 0;if(!(i&&(p={color:a,opacity:u,size:Math.max(Math.min(l,256),0)},p.size<=0||p.opacity<=0||p.color[3]<=0))){var v=h.getGeometry(e);this._processFeature(d,v,p)}}},t.prototype._processFeature=function(e,t,r){if(t)for(var n=t.length,i=0;i<n;i++)this._processGeometry(t[i],e,r)},t.prototype._processGeometry=function(e,t,r){if(!(e.length<2)){for(var n=e[0],o=e[e.length-1],s=o.x-n.x,a=o.y-n.y,u=s*s+a*a<1e-6,l=e[0],c=1;c<e.length;)(s=e[c].x-l.x)*s+(a=e[c].y-l.y)*a<1e-6?e.splice(c,1):(l=e[c],++c);if(!(e.length<2)){this.vertices=e,this.verticesLen=e.length,this.isClosed=u,this.cap=t.cap,this.join=t.join,this.almostParallelRads=.05,this.veryShallowRads=.1,this.miterSafeRads=i.MITER_SAFE_RADS,this.miterLimitMag=Math.min(t.miterLimit,i.SYSTEM_MAG_LIMIT),this.roundLimitRads=Math.min(t.roundLimit,.5),this.newRoundJoinsSafeRads=2.3;for(var f=this._lineIndexBuffer.index,h=0,d=void 0,p=this.verticesLen,v=0;v<p;++v){var y=e[v],m=e[(v+p-1)%p],g=u&&this._isClipEdge(m,y),x=d===this.extrudeVectorsDoubleBuffer[v%2]?this.extrudeVectorsDoubleBuffer[(v+1)%2]:this.extrudeVectorsDoubleBuffer[v%2];if(v<p-1||!u||this.hasPattern?(this._computeExtrudeVectors(x,v),this._writeGPUVertices(y.x,y.y,h,x,r),!x.capCenter||u&&v===p-1||this._writeGPUPieElements(x,g),u&&0===v&&!this.hasPattern&&i.copyExtrudeVectors(this.firstExtrudeVectors,x)):i.copyExtrudeVectors(x,this.firstExtrudeVectors),d&&this._writeGPUBridgeElements(d,x,g),v<p-1){var b=e[v+1];h+=i.length([b.x-y.x,b.y-y.y])}d=x}this._lineIndexCount+=3*(this._lineIndexBuffer.index-f)}}},t.prototype._computeExtrudeVectors=function(e,t){var r=this.vertices,n=this.verticesLen,o=this.isClosed,s=r[t],a=[void 0,void 0],u=[void 0,void 0];if(t>0&&t<n-1){var l=r[(t+n-1)%n],c=r[(t+1)%n];i.normalize(a,[s.x-l.x,s.y-l.y]),i.normalize(u,[c.x-s.x,c.y-s.y])}else if(0===t){c=r[(t+1)%n];if(i.normalize(u,[c.x-s.x,c.y-s.y]),o){var f=r[n-2];i.normalize(a,[s.x-f.x,s.y-f.y])}else a=u}else{if(t!==n-1)return void console.error("Vertex index 'i' out of range.");l=r[(t+n-1)%n];if(i.normalize(a,[s.x-l.x,s.y-l.y]),o){var h=r[1];i.normalize(u,[h.x-s.x,h.y-s.y])}else u=a}o||0!==t?o||t!==n-1?this._computeJoinExtrudeVectors(e,a,u):this._computeCapExtrudeVectors(e,a,u,i.CapPosition.END):this._computeCapExtrudeVectors(e,a,u,i.CapPosition.START)},t.prototype._computeCapExtrudeVectors=function(e,t,r,n){0===this.cap?u.buttCap(e,t,r):1===this.cap?u.roundCap(e,t,r,n,i.getNumberOfSlices(Math.PI),n===i.CapPosition.START?-1:1):2===this.cap?u.squareCap(e,t,r,n):u.buttCap(e,t,r)},t.prototype._computeJoinExtrudeVectors=function(e,t,r){var n=i.getRads(t,r);if(n>Math.PI-this.almostParallelRads)u.rectJoin(e,t,r);else if(0===this.join&&n>=this.veryShallowRads)u.bevelJoin(e,t,r,1);else if(1===this.join&&n>=this.veryShallowRads){var o=i.getNumberOfSlices(n);n<this.newRoundJoinsSafeRads?o<2||n<this.roundLimitRads?u.bevelJoin(e,t,r,1):u.roundJoin(e,t,r,o):u.unitRoundJoin(e,t,r,o)}else n<this.almostParallelRads?u.fastMiterJoin(e,t,r):n<this.miterSafeRads?u.miterJoin(e,t,r):u.bevelJoin(e,t,r,this.miterLimitMag)},t.prototype._writeGPUVertices=function(e,t,r,n,i){for(var o=0;o<n.vectors.count;++o){var s=n.vectors.items[o].vector[0],a=n.vectors.items[o].vector[1],u=n.vectors.items[o].texCoords[0],l=n.vectors.items[o].texCoords[1];n.vectors.items[o].base=this._lineVertexBuffer.index,this._lineVertexBuffer.add(e,t,s,a,u,l,r,i)}},t.prototype._writeGPUBridgeElements=function(e,t,r){if(u.bridge(this.recycledTriangleBridge,e,t),!r)for(var n=0;n<this.recycledTriangleBridge.count;++n){var i=this.recycledTriangleBridge.items[n];this._lineIndexBuffer.add(i.v1.base,i.v2.base,i.v3.base)}},t.prototype._writeGPUPieElements=function(e,t){if(u.pie(this.recycledTrianglePie,e),!t)for(var r=0;r<this.recycledTrianglePie.count;++r){var n=this.recycledTrianglePie.items[r];this._lineIndexBuffer.add(n.v1.base,n.v2.base,n.v3.base)}},t.prototype._isClipEdge=function(e,t){return e.x===t.x?e.x<=-64||e.x>=4160:e.y===t.y&&(e.y<=-64||e.y>=4160)},t}(o)}.apply(null,n))||(e.exports=i)},2033:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1729),r(2144),r(515)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t,r,n,i){void 0===r&&(r=0),void 0===n&&(n=-1),void 0===i&&(i=l),this.x=e,this.y=t,this.angle=r,this.segment=n,this.minzoom=i}}();t.Anchor=o;var s=function(){return function(e,t,r,n,o,s,a){void 0===o&&(o=!1),void 0===s&&(s=l),void 0===a&&(a=i.C_INFINITY),this.anchor=e,this.labelAngle=t,this.glyphAngle=r,this.page=n,this.upsideDown=o,this.minzoom=s,this.maxzoom=a}}(),a=function(){return function(e,t,r,n,i,o,s,a,u,l){this.tl=e,this.tr=t,this.bl=r,this.br=n,this.mosaicRect=i,this.labelAngle=o,this.anchor=s,this.minzoom=a,this.maxzoom=u,this.page=l}}();t.PlacedSymbol=a;var u=function(){return function(e,t){this.footprint=e,this.shapes=t}}();t.Placement=u;var l=.5,c=function(){function e(){this.mapAngle=0,this._conflictEngine=new n.ConflictEngine}return e.prototype.reset=function(){this._conflictEngine.reset()},e.prototype.setAngle=function(e){this.mapAngle=e,this._conflictEngine.setAngle(e)},e.prototype.getIconPlacement=function(e,t,o,s,c,f,h){var d=o.width/o.pixelRatio,p=o.height/o.pixelRatio,v=f.offset[0]-d/2,y=f.offset[1]-p/2,m=v+d,g=y+p,x=o.rect,b=o.sdf?17:2,_=v-b,I=y-b,C=_+x.width/o.pixelRatio,w=I+x.height/o.pixelRatio,T=new r.Point(_,I),P=new r.Point(C,w),S=new r.Point(_,w),A=new r.Point(C,I),M=f.rotate*i.C_DEG_TO_RAD,E=1===f.rotationAlignment;if(e.segment>=0&&!E&&(M+=e.angle),0!==M){var B=Math.cos(M),D=Math.sin(M);T.rotate(B,D),P.rotate(B,D),S.rotate(B,D),A.rotate(B,D)}var N=8*f.padding,V=new r.Point(e.x,e.y),F=new n.Footprint(this.mapAngle,N,E);F.addBox(V,new n.Box(v,y,m,g),s,M,t,l,i.C_INFINITY);var O=new a(T,A,S,P,x,0,V,l,i.C_INFINITY,0),z=new u(F,[O]),L=l;return f.allowOverlap||(L=this._conflictEngine.getMinZoom(z.footprint,L,h,E)),F.minzoom=L,z},e.prototype.getTextPlacement=function(e,t,o,c,f,h,d,p){for(var v,y=new r.Point(e.x,e.y),m=d.rotate*i.C_DEG_TO_RAD,g=0===d.rotationAlignment,x=d.keepUpright,b=l,_=!g,I=_?0:e.angle,C=e.segment>=0&&g,w=8*d.padding,T=new n.Footprint(this.mapAngle,w,_),P=[],S=!C,A=Number.POSITIVE_INFINITY,M=Number.NEGATIVE_INFINITY,E=A,B=M,D=C?x:g&&x,N=0,V=c;N<V.length;N++){var F=V[N],O=F.glyphMosaicItem;if(O&&!O.rect.isEmpty){var z=O.rect,L=O.metrics,j=O.page;S&&(v&&v!==F.y&&(T.addBox(y,new n.Box(A,E,M,B),f,m,t,l,i.C_INFINITY),E=A=Number.POSITIVE_INFINITY,B=M=Number.NEGATIVE_INFINITY),v=F.y);var R=[];if(C){var k=.5*O.metrics.width,U=(o.x+F.x+L.left-4+k)*f;if(b=this._placeGlyph(e,b,U,h,e.segment,1,j,R),x&&(b=this._placeGlyph(e,b,U,h,e.segment,-1,j,R)),b>=2)break}else R.push(new s(y,I,I,j)),g&&x&&R.push(new s(y,I+i.C_PI,I+i.C_PI,j,!0));for(var Y=F.x+o.x+L.left,G=F.y+o.y-L.top,q=Y+L.width,Q=G+L.height,Z=new r.Point(Y-4,G-4),X=new r.Point(Z.x+z.width,Z.y+z.height),J=new r.Point(Z.x,X.y),H=new r.Point(X.x,Z.y),W=0,K=R;W<K.length;W++){var $=K[W],ee=Z.clone(),te=J.clone(),re=H.clone(),ne=X.clone(),ie=G,oe=Q,se=$.glyphAngle+m;if(0!==se){var ae=Math.cos(se),ue=Math.sin(se);ee.rotate(ae,ue),ne.rotate(ae,ue),te.rotate(ae,ue),re.rotate(ae,ue)}P.push(new a(ee,re,te,ne,z,$.labelAngle,$.anchor,$.minzoom,$.maxzoom,$.page)),D&&!this._legible($.labelAngle)||(S?(Y<A&&(A=Y),ie<E&&(E=ie),q>M&&(M=q),oe>B&&(B=oe)):$.minzoom<2&&T.addBox($.anchor,new n.Box(Y,ie,q,oe),f,se,t,$.minzoom,$.maxzoom))}}}if(b>=2)return null;S&&T.addBox(y,new n.Box(A,E,M,B),f,m,t,l,i.C_INFINITY);var le=new u(T,P);return d.allowOverlap||(b=this._conflictEngine.getMinZoom(le.footprint,b,p,_)),T.minzoom=b,le},e.prototype.add=function(e){this._conflictEngine.add(e.footprint)},e.prototype._legible=function(e){var t=i.radToByte(e);return t<65||t>=193},e.prototype._placeGlyph=function(e,t,n,o,a,u,l,c){var f=u,h=f<0?i.positiveMod(e.angle+i.C_PI,i.C_2PI):e.angle,d=this._legible(h),p=0;n<0&&(f*=-1,n*=-1,p=i.C_PI),f>0&&++a;var v=new r.Point(e.x,e.y),y=o[a],m=i.C_INFINITY;if(o.length<=a)return m;for(;;){var g=y.x-v.x,x=y.y-v.y,b=Math.sqrt(g*g+x*x),_=Math.max(n/b,t),I=g/b,C=x/b,w=i.positiveMod(Math.atan2(C,I)+p,i.C_2PI);if(c.push(new s(v,h,w,l,d,_,m)),_<=t)return _;v=y.clone();do{if(a+=f,o.length<=a||a<0)return _;y=o[a]}while(v.isEqual(y));var T=y.x-v.x,P=y.y-v.y,S=Math.sqrt(T*T+P*P);T*=b/S,P*=b/S,v.x-=T,v.y-=P,m=_}},e}();t.PlacementEngine=c}.apply(null,n))||(e.exports=i)},2034:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(1900),r(1729),r(1851),r(1903),r(515),r(2033),r(559)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c){function f(e,t){return e.iconMosaicItem&&t.iconMosaicItem?e.iconMosaicItem.page===t.iconMosaicItem.page?0:e.iconMosaicItem.page<t.iconMosaicItem.page?-1:1:e.iconMosaicItem&&!t.iconMosaicItem?1:!e.iconMosaicItem&&t.iconMosaicItem?-1:0}return function(e){function t(t,r,n,i,o,s,a,u){var l=e.call(this,t,r)||this;if(l._markerMap=new Map,l._glyphMap=new Map,l._glyphBufferDataStorage=new Map,l._sdfMarkers=!1,t.hasDataDrivenIcon!==n.isDataDriven())throw new Error("incompatible icon buffer");if(t.hasDataDrivenText!==o.isDataDriven())throw new Error("incompatible text buffer");return l._iconVertexBuffer=n,l._iconIndexBuffer=i,l._textVertexBuffer=o,l._textIndexBuffer=s,l._placementEngine=a,l._workerTileHandler=u,l}return r(t,e),Object.defineProperty(t.prototype,"markerPageMap",{get:function(){return this._markerMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"glyphsPageMap",{get:function(){return this._glyphMap},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sdfMarker",{get:function(){return this._sdfMarkers},enumerable:!0,configurable:!0}),t.prototype.copy=function(e,r,n,i,o){var s=new t(this.layer,this.zoom,e,r,n,i,o,this._workerTileHandler);return s.layerIndex=this.layerIndex,s.layerExtent=this.layerExtent,s._iconIndexStart=r.index,s._textIndexStart=i.index,s._iconIndexCount=0,s._textIndexCount=0,s._symbolInstances=this._symbolInstances,s._workerTileHandler=this._workerTileHandler,s._fontArray=this._fontArray,s._textLayout=this._textLayout,s._iconLayout=this._iconLayout,s._isLinePlacement=this._isLinePlacement,s._avoidEdges=this._avoidEdges,s},t.prototype.getResources=function(e,r,n){var i=this.layer,o=this.zoom,s=i.hasDataDrivenIcon,a=i.hasDataDrivenText;e&&e.setExtent(this.layerExtent);for(var u=i.getLayoutProperty("icon-image"),l=i.getLayoutProperty("text-field"),c=i.getLayoutValue("text-font",o),f=i.getLayoutValue("text-transform",o),h=[],d=[1,1,1,1],p=1,v=1,y=[1,1,1,1],m=1,g=1,x=0,b=this._features;x<b.length;x++){var _=b[x],I=_.getGeometry(e);if(I&&0!==I.length){var C=void 0;u&&(C=i.getLayoutValue("icon-image",o,_),u.isDataDriven||(C=this._replaceKeys(C,_.values)),C&&r.add(C));var w=void 0,T=!1;if(l&&(w=i.getLayoutValue("text-field",o,_),l.isDataDriven||(w=this._replaceKeys(w,_.values)),w=w.replace(/\\n/g,"\n"))){switch(f){case 2:w=w.toLowerCase();break;case 1:w=w.toUpperCase()}if(t._bidiEngine.hasBidiChar(w)){var P;P="rtl"===t._bidiEngine.checkContextual(w)?"IDNNN":"ICNNN",w=t._bidiEngine.bidiTransform(w,P,"VLYSN"),T=!0}var S=w.length;if(S>0)for(var A=0,M=c;A<M.length;A++){var E=M[A],B=n[E];B||(B=n[E]=new Set);for(var D=0;D<S;D++){var N=w.charCodeAt(D);B.add(N)}}}if(C||w){var V=i.getLayoutValue("icon-size",o,_),F=i.getLayoutValue("text-size",o,_);i.hasDataDrivenIconColor&&(d=i.getPaintValue("icon-color",o,_)),i.hasDataDrivenIconOpacity&&(p=i.getPaintValue("icon-opacity",o,_)),i.hasDataDrivenIconSize&&(v=V),i.hasDataDrivenTextColor&&(y=i.getPaintValue("text-color",o,_)),i.hasDataDrivenTextOpacity&&(m=i.getPaintValue("text-opacity",o,_)),i.hasDataDrivenTextSize&&(g=F);var O={sprite:C,label:w,rtl:T,type:_.type,geometry:I,iconSize:V,iconRotate:i.getLayoutValue("icon-rotate",o,_),ddIconValues:s?{color:d,opacity:p,size:v}:null,textSize:F,textRotate:i.getLayoutValue("text-rotate",o,_),ddTextValues:a?{color:y,opacity:m,size:g}:null};h.push(O)}}}this._symbolFeatures=h},t.prototype.processFeatures=function(e,r){e&&e.setExtent(this.layerExtent);var n,i,o,a,h,d=this.layer,p=this.zoom,v=this._isLinePlacement=1===d.getLayoutValue("symbol-placement",p),y=this._avoidEdges=d.getLayoutValue("symbol-avoid-edges",p)&&!v,m=8*d.getLayoutValue("symbol-spacing",p),g=d.getLayoutProperty("icon-image"),x=d.getLayoutProperty("text-field"),b=this._workerTileHandler;if(g&&(this._iconLayout=new c.IconLayout(d,p,v),n=b.getSpriteItems(),i=this._getTranslate(!0)),x){var _=this._textLayout=new c.TextLayout(d,p,v);this._fontArray=_.fontArray;var I=.5;switch(_.anchor){case 5:case 1:case 7:I=0;break;case 6:case 2:case 8:I=1}var C=.5;switch(_.anchor){case 5:case 3:case 6:C=0;break;case 7:case 4:case 8:C=1}var w=.5;switch(_.justify){case 0:w=0;break;case 2:w=1}var T=24*_.letterSpacing,P=v?0:24*_.maxWidth,S=24*_.lineHeight,A=[24*_.offset[0],24*_.offset[1]];o=this._fontArray.map(function(e){return b.getGlyphItems(e)}),a=new s(o,P,S,T,A,I,C,w),h=this._getTranslate(!1)}this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var M=[];this._symbolInstances=M;var E=this._textLayout,B=1;E&&E.size&&(B=E.size/24);for(var D=E?E.maxAngle*u.C_DEG_TO_RAD:0,N=E?8*E.size:0,V=0,F=this._symbolFeatures;V<F.length;V++){var O=F[V],z=void 0;O.sprite&&(z=n[O.sprite])&&z.sdf&&(this._sdfMarkers=!0);var L=void 0,j=O.label,R=0;if(j&&(L=a.getShaping(j,O.rtl))&&L.length>0){for(var k=1e30,U=-1e30,Y=0,G=L;Y<G.length;Y++){var q=G[Y];k=Math.min(k,q.x),U=Math.max(U,q.x)}R=(U-k+48)*B*8}for(var Q=0,Z=O.geometry;Q<Z.length;Q++){var X=Z[Q],J=void 0;if(v){if(L&&L.length>0&&E&&E.size){var H=8*E.size*(2+Math.min(2,4*Math.abs(E.offset[1])));t._smoothVertices(X,H)}J=t._findAnchors(X,m,R)}else J=3===O.type?t._findCentroid(X):[new l.Anchor(X[0].x,X[0].y)];for(var W=0,K=J;W<K.length;W++){var $=K[W];$.x<0||$.x>4096||$.y<0||$.y>4096||v&&R>0&&0===E.rotationAlignment&&!t._honorsTextMaxAngle(X,$,R,D,N)||M.push({shaping:L,line:X,iconMosaicItem:z,anchor:$,iconSize:O.iconSize,iconRotate:O.iconRotate,ddIconValues:O.ddIconValues,textSize:O.textSize,textRotate:O.textRotate,ddTextValues:O.ddTextValues})}}}M.sort(f);for(var ee=0,te=M;ee<te.length;ee++){var re=te[ee];this._processFeature(re,i,h,y)}this._addPlacedGlyphs()},t.prototype.updateSymbols=function(){this._iconIndexStart=this._iconIndexBuffer.index,this._textIndexStart=this._textIndexBuffer.index,this._iconIndexCount=0,this._textIndexCount=0,this._markerMap.clear(),this._glyphMap.clear();var e,t,r=this._avoidEdges,n=this.layer;n.getLayoutProperty("icon-image")&&(e=this._getTranslate(!0)),n.getLayoutProperty("text-field")&&(t=this._getTranslate(!1));for(var i=0,o=this._symbolInstances;i<o.length;i++){var s=o[i];this._processFeature(s,e,t,r)}this._addPlacedGlyphs()},t.prototype._getTranslate=function(e){var t=this.layer.getPaintValue(e?"icon-translate":"text-translate",this.zoom);if(0!==t[0]||0!==t[1]){var r=this._placementEngine.mapAngle;if(0!==r&&0===this.layer.getPaintValue(e?"icon-translate-anchor":"text-translate-anchor",this.zoom)){var n=Math.sin(r),i=Math.cos(r);return[8*(t[0]*i-t[1]*n),8*(t[0]*n+t[1]*i)]}return[8*t[0],8*t[1]]}},t.prototype._replaceKeys=function(e,t){return e.replace(/{([^{}]+)}/g,function(e,r){return r in t?t[r]:""})},t.prototype._processFeature=function(e,t,r,n){var i=e.line,s=e.iconMosaicItem,a=e.shaping,l=e.anchor,c=this._iconLayout,f=c&&!!s,h=!0,d=1;f&&(c.size=e.iconSize,c.rotate=e.iconRotate,d=8*c.size,h=c.optional||!s);var p=this._textLayout,v=p&&a&&a.length>0,y=1,m=y,g=!0;v&&(p.size=e.textSize,p.rotate=e.textRotate,m=8*(y=p.size/24),g=p.optional||!a||0===a.length);var x,b,_=new o.Point(0,-17);if((f&&(x=this._placementEngine.getIconPlacement(l,t,s,d,i,c,n),l.minzoom>x.footprint.minzoom&&(x.footprint.minzoom=l.minzoom),x.footprint.minzoom===u.C_INFINITY&&(x=null)),x||h)&&(v&&(b=this._placementEngine.getTextPlacement(l,r,_,a,m,i,p,n))&&(l.minzoom>b.footprint.minzoom&&(b.footprint.minzoom=l.minzoom),b.footprint.minzoom===u.C_INFINITY&&(b=null)),b||g)){if(x&&b||(g||h?g||b?h||x||(b=null):x=null:(x=null,b=null)),x&&b&&!g&&!h){var I=Math.max(x.footprint.minzoom,b.footprint.minzoom);x.footprint.minzoom=I,b.footprint.minzoom=I}b&&(p.ignorePlacement||this._placementEngine.add(b),this._storePlacedGlyphs(b.shapes,b.footprint.minzoom,this.zoom,e.ddTextValues)),x&&(c.ignorePlacement||this._placementEngine.add(x),this._addPlacedIcons(x.shapes,x.footprint.minzoom,this.zoom,s.page,e.ddIconValues))}},t.prototype._addPlacedIcons=function(e,t,r,n,i){for(var o=Math.max(r+u.log2(t),0),s=this._iconVertexBuffer,a=this._iconIndexBuffer,l=0,c=e;l<c.length;l++){var f=c[l],h=Math.max(r+u.log2(f.minzoom),o),d=Math.min(r+u.log2(f.maxzoom),25);if(!(d<=h)){var p=f.tl,v=f.tr,y=f.bl,m=f.br,g=f.mosaicRect,x=f.labelAngle,b=f.anchor,_=s.index,I=g.x,C=g.y,w=I+g.width,T=C+g.height;s.add(b.x,b.y,p.x,p.y,I,C,x,h,d,o,i),s.add(b.x,b.y,v.x,v.y,w,C,x,h,d,o,i),s.add(b.x,b.y,y.x,y.y,I,T,x,h,d,o,i),s.add(b.x,b.y,m.x,m.y,w,T,x,h,d,o,i),a.add(_+0,_+1,_+2),a.add(_+1,_+2,_+3),this._markerMap.has(n)?this._markerMap.get(n)[1]+=6:this._markerMap.set(n,[this._iconIndexStart+this._iconIndexCount,6]),this._iconIndexCount+=2}}},t.prototype._addPlacedGlyphs=function(){var e=this,t=this._textVertexBuffer,r=this._textIndexBuffer;this._glyphBufferDataStorage.forEach(function(n,i){for(var o=0,s=n;o<s.length;o++){var a=s[o],u=t.index;t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tl[0],a.tl[1],a.xmin,a.ymin,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.tr[0],a.tr[1],a.xmax,a.ymin,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.bl[0],a.bl[1],a.xmin,a.ymax,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),t.add(a.glyphAnchor[0],a.glyphAnchor[1],a.br[0],a.br[1],a.xmax,a.ymax,a.labelAngle,a.minLod,a.maxLod,a.placementLod,a.ddValues),r.add(u+0,u+1,u+2),r.add(u+1,u+2,u+3),e._glyphMap.has(i)?e._glyphMap.get(i)[1]+=6:e._glyphMap.set(i,[e._textIndexStart+e._textIndexCount,6]),e._textIndexCount+=2}}),this._glyphBufferDataStorage.clear()},t.prototype._storePlacedGlyphs=function(e,t,r,n){for(var i=Math.max(r+u.log2(t),0),o=0,s=e;o<s.length;o++){var a=s[o],l=Math.max(r+u.log2(a.minzoom),i),c=Math.min(r+u.log2(a.maxzoom),25);if(!(c<=l)){var f=a.tl,h=a.tr,d=a.bl,p=a.br,v=a.labelAngle,y=a.anchor,m=a.mosaicRect;this._glyphBufferDataStorage.has(a.page)||this._glyphBufferDataStorage.set(a.page,[]),this._glyphBufferDataStorage.get(a.page).push({glyphAnchor:[y.x,y.y],tl:[f.x,f.y],tr:[h.x,h.y],bl:[d.x,d.y],br:[p.x,p.y],xmin:m.x,ymin:m.y,xmax:m.x+m.width,ymax:m.y+m.height,labelAngle:v,minLod:l,maxLod:c,placementLod:i,ddValues:n})}}},t._findAnchors=function(e,t,r){t+=r;for(var n=0,i=e.length-1,s=0;s<i;s++)n+=o.Point.distance(e[s],e[s+1]);var a=r||t;if(n<=(a*=.5))return[];var c=a/n,f=0,h=-(t=n/Math.max(Math.round(n/t),1))/2,d=[],p=e.length-1;for(s=0;s<p;s++){for(var v=e[s],y=e[s+1],m=y.x-v.x,g=y.y-v.y,x=Math.sqrt(m*m+g*g),b=void 0;h+t<f+x;){var _=((h+=t)-f)/x,I=u.interpolate(v.x,y.x,_),C=u.interpolate(v.y,y.y,_);void 0===b&&(b=Math.atan2(g,m)),d.push(new l.Anchor(I,C,b,s,c))}f+=x}return d},t._deviation=function(e,t,r){var n=(t.x-e.x)*(r.x-t.x)+(t.y-e.y)*(r.y-t.y),i=(t.x-e.x)*(r.y-t.y)-(t.y-e.y)*(r.x-t.x);return Math.atan2(i,n)},t._honorsTextMaxAngle=function(e,t,r,n,i){for(var s=0,a=r/2,u=new o.Point(t.x,t.y),l=t.segment+1;s>-a;){if(--l<0)return!1;s-=o.Point.distance(e[l],u),u=e[l]}s+=o.Point.distance(e[l],e[l+1]);for(var c=[],f=0,h=e.length;s<a;){var d=e[l],p=l,v=void 0;do{if(++p===h)return!1;v=e[p]}while(v.isEqual(d));var y=p,m=void 0;do{if(++y===h)return!1;m=e[y]}while(m.isEqual(v));var g=this._deviation(d,v,m);for(c.push({deviation:g,distToAnchor:s}),f+=g;s-c[0].distToAnchor>i;)f-=c.shift().deviation;if(Math.abs(f)>n)return!1;s+=o.Point.distance(v,m),l=p}return!0},t._smoothVertices=function(e,t){if(!(t<=0)){var r=e.length;if(!(r<3)){var n=[],i=0;n.push(0);for(var s=1;s<r;s++)i+=o.Point.distance(e[s],e[s-1]),n.push(i);t=Math.min(t,.2*i);var a=[];a.push(e[0].x),a.push(e[0].y);var u=e[r-1].x,l=e[r-1].y,c=o.Point.sub(e[0],e[1]);c.normalize(),e[0].x+=t*c.x,e[0].y+=t*c.y,c.assignSub(e[r-1],e[r-2]),c.normalize(),e[r-1].x+=t*c.x,e[r-1].y+=t*c.y;for(s=1;s<r;s++)n[s]+=t;n[r-1]+=t;var f=.5*t;for(s=1;s<r-1;s++){for(var h=0,d=0,p=0,v=s-1;v>=0&&!(n[v+1]<n[s]-f);v--){var y=f+n[v+1]-n[s],m=n[v+1]-n[v],g=n[s]-n[v]<f?1:y/m;if(Math.abs(g)<1e-6)break;var x=g*y-.5*(w=g*g)*m,b=g*m/t,_=e[v+1],I=e[v].x-_.x,C=e[v].y-_.y;h+=b/x*(_.x*g*y+.5*w*(y*I-m*_.x)-w*g*m*I/3),d+=b/x*(_.y*g*y+.5*w*(y*C-m*_.y)-w*g*m*C/3),p+=b}for(v=s+1;v<r&&!(n[v-1]>n[s]+f);v++){y=f-n[v-1]+n[s],m=n[v]-n[v-1],g=n[v]-n[s]<f?1:y/m;if(Math.abs(g)<1e-6)break;var w;x=g*y-.5*(w=g*g)*m,b=g*m/t,_=e[v-1],I=e[v].x-_.x,C=e[v].y-_.y;h+=b/x*(_.x*g*y+.5*w*(y*I-m*_.x)-w*g*m*I/3),d+=b/x*(_.y*g*y+.5*w*(y*C-m*_.y)-w*g*m*C/3),p+=b}a.push(h/p),a.push(d/p)}a.push(u),a.push(l);for(s=0,v=0;s<r;s++)e[s].x=a[v++],e[s].y=a[v++]}}},t._findCentroid=function(e){var t=e.length-1,r=0,n=0,i=0,o=e[0].x,s=e[0].y;o>4096&&(o=4096),o<0&&(o=0),s>4096&&(s=4096),s<0&&(s=0);for(var a=1;a<t;a++){var u=e[a].x,c=e[a].y,f=e[a+1].x,h=e[a+1].y;u>4096&&(u=4096),u<0&&(u=0),c>4096&&(c=4096),c<0&&(c=0),f>4096&&(f=4096),f<0&&(f=0),h>4096&&(h=4096),h<0&&(h=0);var d=(u-o)*(h-s)-(f-o)*(c-s);r+=d*(o+u+f),n+=d*(s+c+h),i+=d}return r/=3*i,n/=3*i,isNaN(r)||isNaN(n)?[]:[new l.Anchor(r,n)]},t._bidiEngine=new i,t}(a)}.apply(null,n))||(e.exports=i)},2142:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2029),r(84),r(7),r(1979),r(2030),r(2031),r(2028),r(515),r(2143),r(2032),r(2033),r(2034),r(2145),r(2148)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c,f,h,d,p,v){return function(){function e(){this.rotation=0,this.status=o.TileStatus.INITIALIZED,this._symbolBuckets=[],this.placementEngine=new h.PlacementEngine,this.fillVertexBuffer=new v.FillVertexBuffer(!1),this.fillDDVertexBuffer=new v.FillVertexBuffer(!0),this.fillIndexBuffer=new c.TriangleIndexBuffer,this.outlineVertexBuffer=new v.OutlineVertexBuffer(!1),this.outlineDDVertexBuffer=new v.OutlineVertexBuffer(!0),this.outlineIndexBuffer=new c.TriangleIndexBuffer,this.lineVertexBuffer=new v.LineVertexBuffer(!1),this.lineDDVertexBuffer=new v.LineVertexBuffer(!0),this.lineIndexBuffer=new c.TriangleIndexBuffer,this.iconVertexBuffer=new v.SymbolVertexBuffer(!1),this.iconDDVertexBuffer=new v.SymbolVertexBuffer(!0),this.iconIndexBuffer=new c.TriangleIndexBuffer,this.textVertexBuffer=new v.SymbolVertexBuffer(!1),this.textDDVertexBuffer=new v.SymbolVertexBuffer(!0),this.textIndexBuffer=new c.TriangleIndexBuffer,this.circleVertexBuffer=new v.CircleVertexBuffer,this.circleIndexBuffer=new c.TriangleIndexBuffer}return e.prototype.initialize=function(e,t,r,n){void 0===n&&(n=0),this.tileKey=e,this.refKey=t,this._workerTileHandler=r,this.rotation=n,this.placementEngine.setAngle(l.C_DEG_TO_RAD*n)},e.prototype.release=function(){this.tileKey=this.refKey="",this.status=o.TileStatus.INITIALIZED,this.rotation=0,this.resetData(),this._workerTileHandler=null},e.prototype.resetData=function(){this.fillVertexBuffer.reset(),this.fillDDVertexBuffer.reset(),this.fillIndexBuffer.reset(),this.outlineVertexBuffer.reset(),this.outlineDDVertexBuffer.reset(),this.outlineIndexBuffer.reset(),this.lineVertexBuffer.reset(),this.lineDDVertexBuffer.reset(),this.lineIndexBuffer.reset(),this.iconVertexBuffer.reset(),this.iconDDVertexBuffer.reset(),this.iconIndexBuffer.reset(),this.textVertexBuffer.reset(),this.textDDVertexBuffer.reset(),this.textIndexBuffer.reset(),this.circleVertexBuffer.reset(),this.circleIndexBuffer.reset(),this.placementEngine.reset(),this._symbolBuckets.length=0},e.prototype.reparse=function(e){return this.resetData(),this.setDataAndParse(this._protobuffArray,e)},e.prototype.setDataAndParse=function(e,t){var r=this,n=t&&t.signal;if(this._protobuffArray=e,n){var i=function(){n.removeEventListener("abort",i),r.status=o.TileStatus.INVALID};n.addEventListener("abort",i)}return this._parse(e,t).then(function(e){r.status=o.TileStatus.READY;for(var t=[1,r.fillVertexBuffer.sizeInBytes,2,r.fillDDVertexBuffer.sizeInBytes,3,r.fillIndexBuffer.sizeInBytes,4,r.outlineVertexBuffer.sizeInBytes,5,r.outlineDDVertexBuffer.sizeInBytes,6,r.outlineIndexBuffer.sizeInBytes,7,r.lineVertexBuffer.sizeInBytes,8,r.lineDDVertexBuffer.sizeInBytes,9,r.lineIndexBuffer.sizeInBytes,10,r.iconVertexBuffer.sizeInBytes,11,r.iconDDVertexBuffer.sizeInBytes,12,r.iconIndexBuffer.sizeInBytes,13,r.textVertexBuffer.sizeInBytes,14,r.textDDVertexBuffer.sizeInBytes,15,r.textIndexBuffer.sizeInBytes,16,r.circleVertexBuffer.sizeInBytes,17,r.circleIndexBuffer.sizeInBytes],n=new Uint32Array(t),i=[],l=e.length,c=0;c<l;c++){var h=e[c];if(h instanceof u)i.push(h.layerIndex),i.push(1),i.push(h.fillIndexStart),i.push(h.fillIndexCount),i.push(h.outlineIndexStart),i.push(h.outlineIndexCount);else if(h instanceof f)i.push(h.layerIndex),i.push(2),i.push(h.lineIndexStart),i.push(h.lineIndexCount);else if(h instanceof d){i.push(h.layerIndex),i.push(3),i.push(h.sdfMarker?1:0);var p=h.markerPageMap;i.push(p.size),p.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])});var v=h.glyphsPageMap;i.push(v.size),v.forEach(function(e,t){i.push(t),i.push(e[0]),i.push(e[1])})}else h instanceof a?(i.push(h.layerIndex),i.push(4),i.push(h.circleIndexStart),i.push(h.circleIndexCount)):h instanceof s&&(i.push(h.layerIndex),i.push(0))}var y=new Uint32Array(i),m=r.fillVertexBuffer.toBuffer(),g=r.fillDDVertexBuffer.toBuffer(),x=r.fillIndexBuffer.toBuffer(),b=r.outlineVertexBuffer.toBuffer(),_=r.outlineDDVertexBuffer.toBuffer(),I=r.outlineIndexBuffer.toBuffer(),C=r.lineVertexBuffer.toBuffer(),w=r.lineDDVertexBuffer.toBuffer(),T=r.lineIndexBuffer.toBuffer(),P=r.iconVertexBuffer.toBuffer(),S=r.iconDDVertexBuffer.toBuffer(),A=r.iconIndexBuffer.toBuffer(),M=r.textVertexBuffer.toBuffer(),E=r.textDDVertexBuffer.toBuffer(),B=r.textIndexBuffer.toBuffer(),D=r.circleVertexBuffer.toBuffer(),N=r.circleIndexBuffer.toBuffer();return{result:{bufferDataInfo:n.buffer,bucketDataInfo:y.buffer,bufferData:[m,g,x,b,_,I,C,w,T,P,S,A,M,E,B,D,N]},transferList:[m,g,x,b,_,I,C,w,T,P,S,A,M,E,B,D,N,n.buffer,y.buffer]}})},e.prototype.addBucket=function(e){this._symbolBuckets.push(e)},e.prototype.updateSymbols=function(e){var t=this,n=this._symbolBuckets;if(!n||0===n.length)return i.resolve();this.rotation=e;var s=this.placementEngine;s.reset(),s.setAngle(e/256*360*l.C_DEG_TO_RAD);var a=this.iconVertexBuffer;a.reset();var u=this.iconDDVertexBuffer;u.reset();var c=this.iconIndexBuffer;c.reset();var f=this.textVertexBuffer;f.reset();var h=this.textDDVertexBuffer;h.reset();var d=this.textIndexBuffer;d.reset();var p=[],v=n.length,y=0;return r(function(){if(t.status===o.TileStatus.INVALID||t.status===o.TileStatus.INITIALIZED)return!0;if(y<v){var e=n[y++],r=e.layer,i=e.copy(r.hasDataDrivenIcon?u:a,c,r.hasDataDrivenText?h:f,d,s);i&&(p.push(i),i.updateSymbols())}return y>=v}).then(function(){if(t.status===o.TileStatus.INVALID||t.status===o.TileStatus.INITIALIZED||0===a.sizeInBytes&&0===u.sizeInBytes&&0===c.sizeInBytes&&0===f.sizeInBytes&&0===h.sizeInBytes&&0===d.sizeInBytes)return{result:null,transferList:null};var e=[10,a.sizeInBytes,11,u.sizeInBytes,12,c.sizeInBytes,13,f.sizeInBytes,14,h.sizeInBytes,15,d.sizeInBytes],r=new Uint32Array(e),n=[];v=p.length;for(var i=0;i<v;i++){var s=p[i];n.push(s.layerIndex),n.push(3),n.push(s.sdfMarker?1:0);var l=s.markerPageMap;n.push(l.size),l.forEach(function(e,t){n.push(t),n.push(e[0]),n.push(e[1])});var y=s.glyphsPageMap;n.push(y.size),y.forEach(function(e,t){n.push(t),n.push(e[0]),n.push(e[1])})}var m=new Uint32Array(n),g=a.toBuffer(),x=u.toBuffer(),b=c.toBuffer(),_=f.toBuffer(),I=h.toBuffer(),C=d.toBuffer();return{result:{bufferDataInfo:r.buffer,bucketDataInfo:m.buffer,bufferData:[g,x,b,_,I,C]},transferList:[g,x,b,_,I,C,r.buffer,m.buffer]}}).catch(function(){return null})},e.prototype.setObsolete=function(){this.status=o.TileStatus.INVALID},e.prototype.getLayers=function(){return this._workerTileHandler.getLayers()},e.prototype.getWorkerTileHandler=function(){return this._workerTileHandler},e.prototype._parse=function(e,t){if(!e||0===e.byteLength)return i.resolve([]);this.status=o.TileStatus.MODIFIED;var r=t.client;return new p(e,this,r).parse()},e.pool=new n(e),e}()}.apply(null,n))||(e.exports=i)},2143:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(1949)],void 0===(i=function(e,t,r,n,i){Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(){return e.call(this,12)||this}return r(t,e),t.prototype.add=function(e,t,r){var n=this.array;n.push(e),n.push(t),n.push(r)},t}(i);t.TriangleIndexBuffer=o;var s=function(e){function t(){return e.call(this,4)||this}return r(t,e),t.prototype.add=function(e){this.array.push(e)},t}(i);t.PointElementMemoryBuffer=s}.apply(null,n))||(e.exports=i)},2144:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1729),r(515)],void 0===(i=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t,r,n){this.left=e,this.top=t,this.right=r,this.bottom=n}return e.prototype.clone=function(){return new e(this.left,this.top,this.right,this.bottom)},e.prototype.move=function(e,t){this.left+=e,this.top+=t,this.right+=e,this.bottom+=t},e.prototype.rotate=function(e,t){var r=this.left,n=this.right,i=this.top,o=this.bottom,s=r*e-i*t,a=r*t+i*e,u=n*e-i*t,l=n*t+i*e,c=r*e-o*t,f=r*t+o*e,h=n*e-o*t,d=n*t+o*e;this.left=Math.min(s,u,c,h),this.top=Math.min(a,l,f,d),this.right=Math.max(s,u,c,h),this.bottom=Math.max(a,l,f,d)},e.overlaps=function(e,t){return e.right>t.left&&e.left<t.right&&e.bottom>t.top&&e.top<t.bottom},e}();t.Box=i;var o=function(){function e(e,t,r,n){this.anchor=e,this.corners=t,this.minzoom=r,this.maxzoom=n}return e.prototype.left=function(){return this.corners[0].x},e.prototype.right=function(){return this.corners[2].x},e.prototype.top=function(){return this.corners[1].y},e.prototype.bottom=function(){return this.corners[3].y},e}();t.Obstacle=o;var s=function(){function e(e,t,r){this.obstacles=[],this.mapAngle=e,this.padding=t,this.isScreenAligned=r,this.minzoom=a}return e.prototype.addBox=function(e,t,n,i,s,a,u){var l=t.left*n-this.padding,c=t.top*n-this.padding,f=t.right*n+this.padding,h=t.bottom*n+this.padding,d=[new r.Point(l,c),new r.Point(f,c),new r.Point(f,h),new r.Point(l,h)];if(0!==this.mapAngle){var p=Math.cos(this.mapAngle),v=Math.sin(this.mapAngle);(e=e.clone()).rotate(p,v)}if(this.isScreenAligned||(i+=this.mapAngle),0!==i){p=Math.cos(i),v=Math.sin(i);d[0].rotate(p,v),d[1].rotate(p,v),d[2].rotate(p,v),d[3].rotate(p,v);for(var y=0,m=1;m<4;m++)d[m].x<d[y].x?y=m:d[m].x===d[y].x&&d[m].y<d[y].y&&(y=m);if(y){var g=[];for(m=0;m<4;m++)g.push(d[(m+y)%4]);d=g}}if(s)for(var x=0,b=d;x<b.length;x++){b[x].move(s[0],s[1])}this.obstacles.push(new o(e,d,a,u))},e}();t.Footprint=s;var a=.5,u=function(){function e(){this._grid=[]}return e.prototype.setAngle=function(e){},e.prototype.reset=function(){this._grid=[]},e.prototype.add=function(t){for(var r=this._grid,n=0,i=t.obstacles;n<i.length;n++)for(var o=i[n],s=o.anchor,a=e._gridClamp(Math.min(o.left()+s.x,s.x)),u=e._gridClamp(Math.max(o.right()+s.x,s.x)),l=e._gridClamp(Math.min(o.top()+s.y,s.y)),c=e._gridClamp(Math.max(o.bottom()+s.y,s.y)),f=l;f<=c;f++)for(var h=a;h<=u;h++){var d=r[16*f+h];d||(d=r[16*f+h]=[]),d.push(o)}},e.prototype.getMinZoom=function(t,r,i,o){if(0===t.obstacles.length)return n.C_INFINITY;for(var s=r,a=this._grid,u=0,l=t.obstacles;u<l.length;u++)for(var c=l[u],f=c.anchor,h=e._gridClamp(Math.min(c.left()+f.x,f.x)),d=e._gridClamp(Math.max(c.right()+f.x,f.x)),p=e._gridClamp(Math.min(c.top()+f.y,f.y)),v=e._gridClamp(Math.max(c.bottom()+f.y,f.y)),y=p;y<=v;y++)for(var m=h;m<=d;m++){var g=a[16*y+m];if(g)for(var x=0,b=g;x<b.length;x++){var _=b[x];if(!(c.minzoom>=_.maxzoom||_.minzoom>=c.maxzoom)&&(s=e._calcPlacementZoom(c,_,s))>=2)return n.C_INFINITY}}return s<2?s:n.C_INFINITY},e._gridClamp=function(e){return n.clamp(e>>9,-7,8)},e._calcPlacementZoom=function(t,r,i){var o=r.anchor.x-t.anchor.x;if(0===o&&(t.right()<r.left()||r.right()<t.left()))return i;var s=r.anchor.y-t.anchor.y;if(0===s&&(t.bottom()<r.top()||r.bottom()<t.top()))return i;var a=n.C_INFINITY;if(0!==o){var u=(o>0?t.right()-r.left():t.left()-r.right())/o;u<a&&(a=u);var l=o>0?e._calcExtZoomX(t,r,u):e._calcExtZoomX(r,t,u);l<a&&(a=l)}if(0!==s){var c=(s>0?t.bottom()-r.top():t.top()-r.bottom())/s;c<a&&(a=c);var f=s>0?e._calcExtZoomY(t,r,c):e._calcExtZoomY(r,t,c);f<a&&(a=f)}return a<t.minzoom||a<r.minzoom?i:((a=Math.min(a,t.maxzoom,r.maxzoom))<i&&(a=i),a)},e._calcExtZoomX=function(e,t,r){var n,i,o,s;if(e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[0].y/r){var a=e.corners[2].x-e.corners[3].x,u=e.corners[2].y-e.corners[3].y,l=t.corners[1].x-t.corners[0].x;a*(t.corners[1].y-t.corners[0].y)-u*l>=0?e.anchor.y+e.corners[3].y/r<t.anchor.y+t.corners[0].y/r?(n=e.corners[3],i=t.corners[0],o=t.corners[1],s=1):(n=t.corners[0],i=e.corners[3],o=e.corners[2],s=-1):e.anchor.y+e.corners[2].y/r>t.anchor.y+t.corners[1].y/r?(n=e.corners[2],i=t.corners[0],o=t.corners[1],s=1):(n=t.corners[1],i=e.corners[3],o=e.corners[2],s=-1)}else{a=e.corners[2].x-e.corners[1].x,u=e.corners[2].y-e.corners[1].y,l=t.corners[3].x-t.corners[0].x;a*(t.corners[3].y-t.corners[0].y)-u*l<0?e.anchor.y+e.corners[1].y/r>t.anchor.y+t.corners[0].y/r?(n=e.corners[1],i=t.corners[0],o=t.corners[3],s=1):(n=t.corners[0],i=e.corners[1],o=e.corners[2],s=-1):e.anchor.y+e.corners[2].y/r<t.anchor.y+t.corners[3].y/r?(n=e.corners[2],i=t.corners[0],o=t.corners[3],s=1):(n=t.corners[3],i=e.corners[1],o=e.corners[2],s=-1)}var c=o.x-i.x,f=o.y-i.y;return s*((n.y-i.y)*c-(n.x-i.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*c)},e._calcExtZoomY=function(e,t,r){var n,i,o,s;if(e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[1].x/r){var a=e.corners[3].x-e.corners[2].x,u=e.corners[3].y-e.corners[2].y,l=t.corners[0].x-t.corners[1].x;a*(t.corners[0].y-t.corners[1].y)-u*l<0?e.anchor.x+e.corners[2].x/r<t.anchor.x+t.corners[1].x/r?(n=e.corners[2],i=t.corners[1],o=t.corners[0],s=1):(n=t.corners[1],i=e.corners[2],o=e.corners[3],s=-1):e.anchor.x+e.corners[3].x/r>t.anchor.x+t.corners[0].x/r?(n=e.corners[3],i=t.corners[1],o=t.corners[0],s=1):(n=t.corners[0],i=e.corners[2],o=e.corners[3],s=-1)}else{a=e.corners[3].x-e.corners[0].x,u=e.corners[3].y-e.corners[0].y,l=t.corners[2].x-t.corners[1].x;a*(t.corners[2].y-t.corners[1].y)-u*l>0?e.anchor.x+e.corners[0].x/r>t.anchor.x+t.corners[1].x/r?(n=e.corners[0],i=t.corners[1],o=t.corners[2],s=1):(n=t.corners[1],i=e.corners[0],o=e.corners[3],s=-1):e.anchor.x+e.corners[3].x/r<t.anchor.x+t.corners[2].x/r?(n=e.corners[3],i=t.corners[1],o=t.corners[2],s=1):(n=t.corners[2],i=e.corners[0],o=e.corners[3],s=-1)}var c=o.x-i.x,f=o.y-i.y;return s*((n.y-i.y)*c-(n.x-i.x)*f)/((e.anchor.x-t.anchor.x)*f-(e.anchor.y-t.anchor.y)*c)},e}();t.ConflictEngine=u}.apply(null,n))||(e.exports=i)},2145:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(2029),r(548),r(7),r(1748),r(1979),r(2030),r(2031),r(2146),r(2028),r(2032),r(2147),r(2034)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c,f,h,d){return function(){function e(e,t,r){this._pbfTile=new n(new Uint8Array(e),new DataView(e)),this._tile=t,this._connection=r,this._layers=t.getLayers();var i=t.tileKey.split("/").map(parseFloat),s=i[0],a=i[1],u=i[2];if(this._level=s,t.refKey){var l=s-t.refKey.split("/").map(parseFloat)[0];if(l>0){var c=(1<<l)-1,f=a&c,h=u&c;this._tileClipper=new o.TileClipper(l,f,h)}}this._tileClipper||(this._tileClipper=new o.SimpleBuilder)}return e.prototype.parse=function(){for(var e,t=this,n=this._parseTileData(this._pbfTile),o=this._layers,a=o.length,u=this._level,c=[],f={},h=new Set,d=a-1;d>=0;d--)if(!((e=o[d]).minzoom&&u<e.minzoom||e.maxzoom&&u>=e.maxzoom||e.layout&&"none"===e.layout.visibility))if(0!==e.type){var p=e.sourceLayer,v=n[p];if(v)if(h.add(p),m=this._createBucket(e)){m.layerIndex=d,m.layerExtent=v.extent;var y=f[p];y||(y=f[p]=[]),y.push(m)}}else{var m;(m=this._createBucket(e)).layerIndex=d,c.push(m)}var g=10*this._level,x=10*(this._level+1),b=[],_=[],I=[],C=[],w=this._tileClipper,T=new Set,P={},S=[];h.forEach(function(e){return S.push(e)});var A=0,M=0,E=S.length;return r(function(){if(t._tile.status===s.TileStatus.INVALID)return!0;switch(A){case 0:if(M<E){var e=S[M++],r=n[e];if(!(v=f[e])||0===v.length)break;for(var i=r.getData();i.next(2);){var o=new l(i.getMessage(),r),a=o.values;if(a){var u=a._minzoom;if(u&&u>=x)continue;var c=a._maxzoom;if(c&&c<=g)continue}for(var h=0,d=v;h<d.length;h++){(B=d[h]).pushFeature(o)}}}else{var p=t._tile;for(var e in f)for(var v,y=0,m=v=f[e];y<m.length;y++){var B;(B=m[y]).hasFeatures()&&(3===B.layer.type?(b.push(B),p.addBucket(B)):B.layer.refLayerId?I.push(B):(_.push(B),C[B.layer.id]=B))}A=1,M=0,E=b.length}break;case 1:M<E?b[M++].getResources(w,T,P):A=2}return 2===A}).then(function(){if(t._tile.status===s.TileStatus.INVALID)return[];var e,n,o=[],a=t._tile.getWorkerTileHandler();for(var u in T.size>0&&(e=a.fetchSprites(T,t._connection),o.push(e)),P){var l=P[u];l.size>0&&(n=a.fetchGlyphs(t._tile.tileKey,u,l,t._connection),o.push(n))}return i.all(o).then(function(e){if(t._tile.status===s.TileStatus.INVALID)return[];var n=0,i=0,o=_.length;return r(function(){if(t._tile.status===s.TileStatus.INVALID)return!0;switch(n){case 0:if(i<o)(a=_[i++]).processFeatures(w,t._tile),c.push(a);else n=1,i=0,o=I.length;break;case 1:for(var e=0,r=I;e<r.length;e++){var a=r[e],u=C[a.layer.refLayerId];u&&(u.assignBufferInfo(a),c.push(a))}n=2,i=0,o=b.length;break;case 2:if(i<o)(a=b[i++]).processFeatures(w,t._tile),c.push(a);else n=3}return 3===n}).then(function(){return c.sort(function(e,t){return e.layerIndex-t.layerIndex}),c})}).catch(function(e){return i.reject(new Error(e))})}).catch(function(e){return i.reject(new Error(e))})},e.prototype._parseTileData=function(e){for(var t={};e.next();)switch(e.tag()){case 3:var r=new h(e.getMessage());t[r.name]=r;break;default:e.skip()}return t},e.prototype._createBucket=function(e){switch(e.type){case 0:return this._createBackgroundBucket(e);case 1:return this._createFillBucket(e);case 2:return this._createLineBucket(e);case 4:return this._createCircleBucket(e);case 3:return this._createSymbolBucket(e)}},e.prototype._createBackgroundBucket=function(e){return new a(e,this._level)},e.prototype._createFillBucket=function(e){var t=this._tile;return new c(e,this._level,e.hasDataDrivenFill?t.fillDDVertexBuffer:t.fillVertexBuffer,t.fillIndexBuffer,e.hasDataDrivenOutline?t.outlineDDVertexBuffer:t.outlineVertexBuffer,t.outlineIndexBuffer)},e.prototype._createLineBucket=function(e){var t=this._tile;return new f(e,this._level,e.hasDataDrivenLine?t.lineDDVertexBuffer:t.lineVertexBuffer,t.lineIndexBuffer)},e.prototype._createCircleBucket=function(e){var t=this._tile;return new u(e,this._level,t.circleVertexBuffer,t.circleIndexBuffer)},e.prototype._createSymbolBucket=function(e){var t=this._tile;return new d(e,this._level,e.hasDataDrivenIcon?t.iconDDVertexBuffer:t.iconVertexBuffer,t.iconIndexBuffer,e.hasDataDrivenText?t.textDDVertexBuffer:t.textVertexBuffer,t.textIndexBuffer,t.placementEngine,t.getWorkerTileHandler())},e}()}.apply(null,n))||(e.exports=i)},2146:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(1729)],void 0===(i=function(e,t,r){return function(){function e(e,t){this.values={};for(var r=t.keys,n=t.values;e.next();)switch(e.tag()){case 1:this.id=e.getUInt64();break;case 2:for(var i=e.getMessage(),o=this.values;!i.empty();){var s=i.getUInt32(),a=i.getUInt32();o[r[s]]=n[a]}break;case 3:this.type=e.getUInt32();break;case 4:this._pbfGeometry=e.getMessage();break;default:e.skip()}}return e.prototype.getGeometry=function(e){if(void 0!==this._geometry)return this._geometry;var t,n,i,o=this._pbfGeometry;e?e.reset(this.type):t=[];for(var s=1,a=0,u=0,l=0;!o.empty();){if(0===a){var c=o.getUInt32();s=7&c,a=c>>3}switch(a--,s){case 1:u+=o.getSInt32(),l+=o.getSInt32(),e?e.moveTo(u,l):(n&&t.push(n),(n=[]).push(new r.Point(u,l)));break;case 2:u+=o.getSInt32(),l+=o.getSInt32(),e?e.lineTo(u,l):n.push(new r.Point(u,l));break;case 7:e?e.close():n&&!n[0].equals(u,l)&&n.push(n[0].clone());break;default:throw new Error("Invalid path operation")}}return e?i=e.result():(n&&t.push(n),i=t),this._geometry=i,i},e}()}.apply(null,n))||(e.exports=i)},2147:function(e,t,r){var n,i;n=[r.dj.c(e.i),t],void 0===(i=function(e,t){return function(){function e(t){for(this.extent=4096,this.keys=[],this.values=[],this._pbfLayer=t.clone();t.next();)switch(t.tag()){case 1:this.name=t.getString();break;case 3:this.keys.push(t.getString());break;case 4:this.values.push(e._parseValue(t.getMessage()));break;case 5:this.extent=t.getUInt32();break;default:t.skip()}}return e.prototype.getData=function(){return this._pbfLayer},e._parseValue=function(e){for(;e.next();)switch(e.tag()){case 1:return e.getString();case 2:return e.getFloat();case 3:return e.getDouble();case 4:return e.getInt64();case 5:return e.getUInt64();case 6:return e.getSInt64();case 7:return e.getBool();default:e.skip()}return null},e}()}.apply(null,n))||(e.exports=i)},2148:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(26),r(0),r(515),r(1949)],void 0===(i=function(e,t,r,n,i,o){Object.defineProperty(t,"__esModule",{value:!0});var s=new Float32Array(1),a=new Uint32Array(s.buffer),u=function(e){function t(t){var r=e.call(this,t?20:12)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,n,i,u,l,c){var f=this.array,h=o.i1616to32(e,t);if(f.push(h),h=o.i8888to32(Math.round(31*r),Math.round(31*n),Math.round(31*i),Math.round(31*u)),f.push(h),h=o.i1616to32(l,0),f.push(h),this._isDataDriven){if(!c)throw new Error("Expecting data driven values.");var d=c.color,p=d[3]*c.opacity*255;f.push(o.i8888to32(d[0]*p,d[1]*p,d[2]*p,p)),s[0]=c.size,f.push(a[0])}},t}(o);t.LineVertexBuffer=u;var l=function(e){function t(t){var r=e.call(this,t?8:4)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r){var n=this.array;if(n.push(o.i1616to32(e,t)),this._isDataDriven){if(!r)throw new Error("Expecting data driven values.");var i=r.color,s=i[3]*r.opacity*255;n.push(o.i8888to32(i[0]*s,i[1]*s,i[2]*s,s))}},t}(o);t.FillVertexBuffer=l;var c=function(e){function t(t){var r=e.call(this,t?12:8)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,n,i,s,a){var u=this.array,l=this.index,c=o.i1616to32(e,t);if(u.push(c),c=o.i8888to32(Math.round(15*r),Math.round(15*n),i,s),u.push(c),this._isDataDriven){if(!a)throw new Error("Expecting data driven values.");var f=a.color,h=f[3]*a.opacity*255;u.push(o.i8888to32(f[0]*h,f[1]*h,f[2]*h,h))}return l},t}(o);t.OutlineVertexBuffer=c;var f=function(e){function t(t){var r=e.call(this,t?24:16)||this;return r._isDataDriven=t,r}return r(t,e),t.prototype.isDataDriven=function(){return this._isDataDriven},t.prototype.add=function(e,t,r,n,u,l,c,f,h,d,p){var v=this.array,y=o.i1616to32(e,t);if(v.push(y),y=o.i1616to32(Math.round(8*r),Math.round(8*n)),v.push(y),y=o.i8888to32(u/4,l/4,0,0),v.push(y),y=o.i8888to32(Math.ceil(10*d),i.radToByte(c),10*f,Math.min(10*h,255)),v.push(y),this._isDataDriven){if(!p)throw new Error("Expecting data driven values.");var m=p.color,g=m[3]*p.opacity*255;v.push(o.i8888to32(m[0]*g,m[1]*g,m[2]*g,g)),s[0]=p.size,v.push(a[0])}},t}(o);t.SymbolVertexBuffer=f;var h=function(e){function t(){return e.call(this,16)||this}return r(t,e),t.prototype.add=function(e,t,r,n,i,s,a,u,l,c,f){var h=this.array,d=o.i1616to32(2*e+r,2*t+n);h.push(d);var p=s[3]*a*255;d=o.i8888to32(s[0]*p,s[1]*p,s[2]*p,p),h.push(d);var v=c[3]*f*255;d=o.i8888to32(c[0]*v,c[1]*v,c[2]*v,v),h.push(d),d=o.i8888to32(Math.min(32*u,255),Math.min(4*l,255),Math.min(i,255),0),h.push(d)},t}(o);t.CircleVertexBuffer=h}.apply(null,n))||(e.exports=i)},2149:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(10),r(7)],void 0===(i=function(e,t,n,i){Object.defineProperty(t,"__esModule",{value:!0}),t.createProcessor=function(e,t){var o;return"heatmap"===e?o=i.create(function(e){return r.e(60).then(function(){var t=[r(2485)];e.apply(null,t)}.bind(this)).catch(r.oe)}):"symbol"===e&&(o=i.create(function(e){return Promise.all([r.e(5),r.e(9),r.e(61)]).then(function(){var t=[r(2486)];e.apply(null,t)}.bind(this)).catch(r.oe)})),o.then(function(e){return e.default}).then(function(e){var r=t.serviceAndViewInfo,i=t.remoteClient,o=t.tileStore;return new e(n({},r,{tileStore:o,remoteClient:i}))})}}.apply(null,n))||(e.exports=i)},560:function(e,t,r){var n,i;n=[r.dj.c(e.i),t,r(83),r(514),r(108),r(1989),r(30),r(21),r(8),r(19),r(5),r(7),r(17),r(1894),r(66),r(31),r(286),r(274),r(1861),r(1884),r(52)],void 0===(i=function(e,t,r,n,i,o,s,a,u,l,c,f,h,d,p,v,y,m,g,x,b){Object.defineProperty(t,"__esModule",{value:!0});var _=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"];t.csvLatitudeFieldNames=["lat","latitude","y","ycenter","latitude83","latdecdeg","point-y"],t.csvLongitudeFieldNames=["lon","lng","long","longitude","x","xcenter","longitude83","longdecdeg","point-x"],t.csvDetectedDelimiters=[","," ",";","|","\t"];var I=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,C=[0,0],w=function(){return function(e,t){this.x=e,this.y=t}}(),T=function(){var e=i._parseInfo(),t=new RegExp("^"+e.regexp+"$"),r=new RegExp("["+e.group+"\\s\\xa0]","g"),n=e.factor;return function(i){var o=t.exec(i);if(e.factor=n,!o)return NaN;var s=o[1];if(!o[1]){if(!o[2])return NaN;s=o[2],e.factor*=-1}return+(s=s.replace(r,"").replace(e.decimal,"."))*e.factor}}(),P=function(){function e(){this._queryEngine=null}return e.prototype.load=function(e){var t=this;return f.all([this._fetch(e.url),this._checkProjection(e)]).then(function(r){var n=r[0],i=t._parse(n,e.parsing);return t._queryEngine=t._createQueryEngine(n,i),i.layerDefinition.extent=t._queryEngine.fullExtent,i})},e.prototype.applyEdits=function(e){return f.reject(new u("csv-source:editing-not-supported","applyEdits() is not supported on CSVLayer"))},e.prototype.queryFeatures=function(e){return void 0===e&&(e={}),this._queryEngine.executeQuery(b.fromJSON(e))},e.prototype.queryFeatureCount=function(e){return void 0===e&&(e={}),this._queryEngine.executeQueryForCount(b.fromJSON(e))},e.prototype.queryObjectIds=function(e){return void 0===e&&(e={}),this._queryEngine.executeQueryForIds(b.fromJSON(e))},e.prototype.queryExtent=function(e){return void 0===e&&(e={}),this._queryEngine.executeQueryForExtent(b.fromJSON(e))},e.prototype._fetch=function(e){if(!e)return f.reject(new u("csv-source:invalid-source","url not defined"));var t=h.urlToObject(e);return a(t.path,{query:t.query,responseType:"text"}).then(function(e){return e.data})},e.prototype._parse=function(e,t){void 0===t&&(t={});for(var r={columnDelimiter:t.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}};e&&"\n"===e[0];)e=e.slice(1);"\n"!==e[e.length-1]&&(e+="\n");var n=this._readFirstLine(e);if(!n)throw new u("csv","CSV is empty",{csv:e});if(!t.columnDelimiter){var i=this._inferDelimiter(n);if(!i)throw new u("csv-source:invalid-delimiter","Unable to detect the delimiter from CSV");r.columnDelimiter=i}var o=n.split(r.columnDelimiter),s=r.layerDefinition={name:"csv",geometryType:"esriGeometryPoint",objectIdField:null,fields:[],extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:102100}}};if(!t.latitudeField||!t.longitudeField){var a=this._inferLocationInfo(o);if(!t.longitudeField&&!a.longitudeFieldName||!t.latitudeField&&!a.latitudeFieldName)throw new u("csv","Unable to identify latitudeField and/or longitudeField from CSV");r.locationInfo={longitudeFieldName:t.longitudeField||a.longitudeFieldName,latitudeFieldName:t.latitudeField||a.latitudeFieldName}}var l=this._inferFields(e,r.columnDelimiter,o,r.locationInfo);if(t.fields&&t.fields.length){for(var f=new Map,h=0,d=t.fields;h<d.length;h++){var p=d[h];f.set(p.name.toLowerCase(),p)}for(var v=0,y=l;v<y.length;v++){p=y[v];var m=f.get(p.name.toLowerCase());if(m){var g=p.name;c.mixin(p,m),p.name=g}}}return s.fields=l,s.fields.some(function(e){return"esriFieldTypeOID"===e.type&&(s.objectIdField=e.name,!0)})||(s.objectIdField="__OBJECTID",s.fields.unshift({name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1})),r},e.prototype._inferLocationInfo=function(e){var r=null,n=null;return e.forEach(function(e){var i=e.toLowerCase();-1===t.csvLatitudeFieldNames.indexOf(i)||n||(n=e),-1===t.csvLongitudeFieldNames.indexOf(i)||r||(r=e)}),{longitudeFieldName:r,latitudeFieldName:n}},e.prototype._inferFields=function(e,t,r,n){for(var i=[],o=this._sampleLines(e).map(function(e){return e.split(t).map(function(e){return e.trim()})}),s=this,a=0;a<r.length;a++)!function(e){var t=r[e];if(t===n.longitudeFieldName||t===n.latitudeFieldName)i.push({name:t,type:"esriFieldTypeDouble",alias:t});else{var a=o.map(function(t){return t[e]}),u=s._inferFieldType(a),l={name:t.replace(/[\s\'’‘\.\-\/\(\)]+/g,"_"),type:null,alias:t};switch(u){case"integer":l.type="esriFieldTypeInteger";break;case"double":l.type="esriFieldTypeDouble";break;case"date":l.type="esriFieldTypeDate",l.length=36;break;default:l.type="esriFieldTypeString",l.length=255}i.push(l)}}(a);return i},e.prototype._inferFieldType=function(e){var t=this;if(!e.length)return"string";var r=/[^+-.,0-9]/;return e.map(function(e){var n=!1;if(""===e||r.test(e))n=!0;else{var i=T(e);if(!isNaN(i))return/[.,]/.test(e)?"double":i>214783647||i<-214783648?"double":"integer";if(-1===e.indexOf("E"))n=!0;else{if(i=Number(e),!isNaN(i))return"double";if(-1===e.indexOf(","))n=!0;else{if(e=e.replace(",","."),i=Number(e),!isNaN(i))return"double";n=!0}}}if(n){if(/^[-]?\d*[.,]?\d*$/.test(e))return"string";var o=new Date(e);return t._isValidDate(o,e)?"date":"string"}return"string"}).reduce(function(e,t){return e===t?t:"string"===e||"string"===t?"string":"double"===e||"double"===t?"double":void 0})},e.prototype._isValidDate=function(e,t){if(!e||"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;var r=!0;if(l("chrome")&&/\d+\W*$/.test(t)){var n=t.match(/[a-zA-Z]{2,}/);if(n){for(var i=!1,o=0;!i&&o<=n.length;)i=!I.test(n[o]),o++;r=!i}}return r},e.prototype._readFirstLine=function(e){return e.substring(0,e.indexOf("\n")).trim()},e.prototype._sampleLines=function(e,t){void 0===t&&(t=10);for(var r=!1,n=[],i=e.indexOf("\n")+1;!r&&n.length<t;){var o=e.indexOf("\n",i);if(-1!==o){var s;(s=-1===o&&i<e.length-1?e.substring(i).trim():e.substring(i,o).trim())&&n.push(s),i=o+1}else r=!0}return n},e.prototype._inferDelimiter=function(e){var r=0,n="";return t.csvDetectedDelimiters.forEach(function(t){var i=e.split(t).length;i>r&&(r=i,n=t)}),""===n?null:n},e.prototype._createQueryEngine=function(e,t){for(var r,i=t.locationInfo,a=i.latitudeFieldName,u=i.longitudeFieldName,l=t.layerDefinition,c=l.objectIdField,f=l.fields,h=l.extent,b=[],I=[],P=new n.Set,S=new n.Set,A=[],M=0,E=f;M<E.length;M++){var B=E[M],D=B.name,N=B.type;"esriFieldTypeDate"===N?P.add(D):_.indexOf(N)>-1&&S.add(D),D!==c&&A.push(D)}var V=new o;V.delimiter=t.columnDelimiter,V.fieldNames=A,V.newline="\n";var F=V.parse(e),O=0;F.shift();for(var z=0,L=F;z<L.length;z++){var j=L[z],R=this._parseCoordinateValue(j[a]),k=this._parseCoordinateValue(j[u]);if(null!=k&&null!=R&&!isNaN(R)&&!isNaN(k)){for(var U in j[a]=R,j[u]=k,j)if(U!==a&&U!==u)if(P.has(U)){var Y=new Date(j[U]);j[U]=this._isValidDate(Y,j[U])?Y.getTime():null}else if(S.has(U)){var G=T(j[U]);isNaN(G)?j[U]=null:j[U]=G}j[c]=O,O++,b.push(new w(k,R)),I.push(j)}}if(!p.equals({wkid:4326},h.spatialReference))if(p.isWebMercator(h.spatialReference))for(var q=0,Q=b;q<Q.length;q++){var Z=Q[q];r=v.lngLatToXY(Z.x,Z.y,C),Z.x=r[0],Z.y=r[1]}else b=d.projectMany(b,s.SpatialReference.WGS84,h.spatialReference,null,!0);for(var X=new g.default({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1}),J=new x.default({fields:t.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,objectIdField:c,spatialReference:h.spatialReference||{wkid:4326},cacheSpatialQueries:!0,spatialIndex:X}),H=[],W=0;W<b.length;W++){var K=b[W],$=K.x,ee=K.y,te=I[W];te[c]=W+1,H.push(new y.default(new m.default([],[$,ee]),te,null,te[c]))}return X.addMany(H),J},e.prototype._parseCoordinateValue=function(e){if(null==e||""===e)return null;var t=T(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t},e.prototype._checkProjection=function(e){if(!e||!e.parsing||!e.parsing.spatialReference)return f.resolve();var t=e.parsing&&e.parsing.spatialReference;return!t||v.canProject(s.SpatialReference.WGS84,t)?f.resolve():d.isSupported()?d.load():f.reject(new u("csv-layer","Projection not supported"))},e}();t.default=P}.apply(null,n))||(e.exports=i)}}]);